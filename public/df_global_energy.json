{"tables":[{"id":"global-energy-20-small.csv","displayId":"energy-co2","names":["Year","Entity","Value_co2_emissions_kt_by_country","Electricity from fossil fuels (TWh)","Electricity from nuclear (TWh)","Electricity from renewables (TWh)"],"metadata":{"Year":{"type":"number","semanticType":"Year"},"Entity":{"type":"string","semanticType":"Location"},"Value_co2_emissions_kt_by_country":{"type":"number","semanticType":"Number"},"Electricity from fossil fuels (TWh)":{"type":"number","semanticType":"Number"},"Electricity from nuclear (TWh)":{"type":"number","semanticType":"Number"},"Electricity from renewables (TWh)":{"type":"number","semanticType":"Number"}},"rows":[{"Year":2000,"Entity":"Australia","Value_co2_emissions_kt_by_country":339450,"Electricity from fossil fuels (TWh)":181.05,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":17.11},{"Year":2001,"Entity":"Australia","Value_co2_emissions_kt_by_country":345640,"Electricity from fossil fuels (TWh)":194.33,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":17.4},{"Year":2002,"Entity":"Australia","Value_co2_emissions_kt_by_country":353369.9951,"Electricity from fossil fuels (TWh)":197.29,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":17.35},{"Year":2003,"Entity":"Australia","Value_co2_emissions_kt_by_country":352579.9866,"Electricity from fossil fuels (TWh)":195.13,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":18.5},{"Year":2004,"Entity":"Australia","Value_co2_emissions_kt_by_country":365809.9976,"Electricity from fossil fuels (TWh)":203.66,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":19.41},{"Year":2005,"Entity":"Australia","Value_co2_emissions_kt_by_country":370089.9963,"Electricity from fossil fuels (TWh)":195.95,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":19.75},{"Year":2006,"Entity":"Australia","Value_co2_emissions_kt_by_country":375489.9902,"Electricity from fossil fuels (TWh)":198.72,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":21.19},{"Year":2007,"Entity":"Australia","Value_co2_emissions_kt_by_country":385750,"Electricity from fossil fuels (TWh)":208.59,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":20.93},{"Year":2008,"Entity":"Australia","Value_co2_emissions_kt_by_country":388940.0024,"Electricity from fossil fuels (TWh)":211.06,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":18.49},{"Year":2009,"Entity":"Australia","Value_co2_emissions_kt_by_country":395290.0085,"Electricity from fossil fuels (TWh)":216.42,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":18.32},{"Year":2010,"Entity":"Australia","Value_co2_emissions_kt_by_country":387540.0085,"Electricity from fossil fuels (TWh)":212.5,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":21.13},{"Year":2011,"Entity":"Australia","Value_co2_emissions_kt_by_country":386380.0049,"Electricity from fossil fuels (TWh)":213.56,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":27.33},{"Year":2012,"Entity":"Australia","Value_co2_emissions_kt_by_country":386970.0012,"Electricity from fossil fuels (TWh)":206.75,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":26.63},{"Year":2013,"Entity":"Australia","Value_co2_emissions_kt_by_country":380279.9988,"Electricity from fossil fuels (TWh)":195.78,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":34.2},{"Year":2014,"Entity":"Australia","Value_co2_emissions_kt_by_country":371630.0049,"Electricity from fossil fuels (TWh)":205.46,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":36.15},{"Year":2015,"Entity":"Australia","Value_co2_emissions_kt_by_country":377799.9878,"Electricity from fossil fuels (TWh)":197.72,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":33.12},{"Year":2016,"Entity":"Australia","Value_co2_emissions_kt_by_country":384989.9902,"Electricity from fossil fuels (TWh)":207.66,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":38.41},{"Year":2017,"Entity":"Australia","Value_co2_emissions_kt_by_country":389160.0037,"Electricity from fossil fuels (TWh)":209.14,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":40.77},{"Year":2018,"Entity":"Australia","Value_co2_emissions_kt_by_country":387070.0073,"Electricity from fossil fuels (TWh)":207.45,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":42.93},{"Year":2019,"Entity":"Australia","Value_co2_emissions_kt_by_country":386529.9988,"Electricity from fossil fuels (TWh)":196.45,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":53.41},{"Year":2020,"Entity":"Australia","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":186.92,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":63.99},{"Year":2000,"Entity":"Brazil","Value_co2_emissions_kt_by_country":313670,"Electricity from fossil fuels (TWh)":28.87,"Electricity from nuclear (TWh)":4.94,"Electricity from renewables (TWh)":308.77},{"Year":2001,"Entity":"Brazil","Value_co2_emissions_kt_by_country":319380,"Electricity from fossil fuels (TWh)":35.19,"Electricity from nuclear (TWh)":14.27,"Electricity from renewables (TWh)":273.71},{"Year":2002,"Entity":"Brazil","Value_co2_emissions_kt_by_country":317760.0098,"Electricity from fossil fuels (TWh)":33.5,"Electricity from nuclear (TWh)":13.84,"Electricity from renewables (TWh)":292.95},{"Year":2003,"Entity":"Brazil","Value_co2_emissions_kt_by_country":310809.9976,"Electricity from fossil fuels (TWh)":31.62,"Electricity from nuclear (TWh)":13.4,"Electricity from renewables (TWh)":313.88},{"Year":2004,"Entity":"Brazil","Value_co2_emissions_kt_by_country":328519.989,"Electricity from fossil fuels (TWh)":40.14,"Electricity from nuclear (TWh)":11.6,"Electricity from renewables (TWh)":329.43},{"Year":2005,"Entity":"Brazil","Value_co2_emissions_kt_by_country":331690.0024,"Electricity from fossil fuels (TWh)":39.56,"Electricity from nuclear (TWh)":9.2,"Electricity from renewables (TWh)":346.96},{"Year":2006,"Entity":"Brazil","Value_co2_emissions_kt_by_country":335619.9951,"Electricity from fossil fuels (TWh)":39.4,"Electricity from nuclear (TWh)":12.98,"Electricity from renewables (TWh)":359.55},{"Year":2007,"Entity":"Brazil","Value_co2_emissions_kt_by_country":352559.9976,"Electricity from fossil fuels (TWh)":37.64,"Electricity from nuclear (TWh)":11.65,"Electricity from renewables (TWh)":387.88},{"Year":2008,"Entity":"Brazil","Value_co2_emissions_kt_by_country":373630.0049,"Electricity from fossil fuels (TWh)":55.87,"Electricity from nuclear (TWh)":13.21,"Electricity from renewables (TWh)":385.61},{"Year":2009,"Entity":"Brazil","Value_co2_emissions_kt_by_country":350000,"Electricity from fossil fuels (TWh)":36.32,"Electricity from nuclear (TWh)":12.22,"Electricity from renewables (TWh)":410.13},{"Year":2010,"Entity":"Brazil","Value_co2_emissions_kt_by_country":397929.9927,"Electricity from fossil fuels (TWh)":61.02,"Electricity from nuclear (TWh)":13.77,"Electricity from renewables (TWh)":435.99},{"Year":2011,"Entity":"Brazil","Value_co2_emissions_kt_by_country":418309.9976,"Electricity from fossil fuels (TWh)":50.27,"Electricity from nuclear (TWh)":14.8,"Electricity from renewables (TWh)":462.32},{"Year":2012,"Entity":"Brazil","Value_co2_emissions_kt_by_country":454230.011,"Electricity from fossil fuels (TWh)":77.21,"Electricity from nuclear (TWh)":15.17,"Electricity from renewables (TWh)":454.78},{"Year":2013,"Entity":"Brazil","Value_co2_emissions_kt_by_country":486839.9963,"Electricity from fossil fuels (TWh)":112,"Electricity from nuclear (TWh)":14.65,"Electricity from renewables (TWh)":436.84},{"Year":2014,"Entity":"Brazil","Value_co2_emissions_kt_by_country":511619.9951,"Electricity from fossil fuels (TWh)":136.58,"Electricity from nuclear (TWh)":14.46,"Electricity from renewables (TWh)":430.82},{"Year":2015,"Entity":"Brazil","Value_co2_emissions_kt_by_country":485339.9963,"Electricity from fossil fuels (TWh)":128.85,"Electricity from nuclear (TWh)":13.91,"Electricity from renewables (TWh)":428.81},{"Year":2016,"Entity":"Brazil","Value_co2_emissions_kt_by_country":447079.9866,"Electricity from fossil fuels (TWh)":93.06,"Electricity from nuclear (TWh)":14.97,"Electricity from renewables (TWh)":463.37},{"Year":2017,"Entity":"Brazil","Value_co2_emissions_kt_by_country":456489.9902,"Electricity from fossil fuels (TWh)":101.9,"Electricity from nuclear (TWh)":14.86,"Electricity from renewables (TWh)":464.4},{"Year":2018,"Entity":"Brazil","Value_co2_emissions_kt_by_country":433989.9902,"Electricity from fossil fuels (TWh)":86.69,"Electricity from nuclear (TWh)":14.79,"Electricity from renewables (TWh)":492.66},{"Year":2019,"Entity":"Brazil","Value_co2_emissions_kt_by_country":434299.9878,"Electricity from fossil fuels (TWh)":90.91,"Electricity from nuclear (TWh)":15.16,"Electricity from renewables (TWh)":512.59},{"Year":2020,"Entity":"Brazil","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":81.15,"Electricity from nuclear (TWh)":13.21,"Electricity from renewables (TWh)":520.01},{"Year":2000,"Entity":"Canada","Value_co2_emissions_kt_by_country":514220,"Electricity from fossil fuels (TWh)":155.56,"Electricity from nuclear (TWh)":69.16,"Electricity from renewables (TWh)":363.7},{"Year":2001,"Entity":"Canada","Value_co2_emissions_kt_by_country":506620,"Electricity from fossil fuels (TWh)":159.93,"Electricity from nuclear (TWh)":72.86,"Electricity from renewables (TWh)":339.58},{"Year":2002,"Entity":"Canada","Value_co2_emissions_kt_by_country":524349.9756,"Electricity from fossil fuels (TWh)":155.12,"Electricity from nuclear (TWh)":71.75,"Electricity from renewables (TWh)":357.06},{"Year":2003,"Entity":"Canada","Value_co2_emissions_kt_by_country":544539.978,"Electricity from fossil fuels (TWh)":157.35,"Electricity from nuclear (TWh)":71.15,"Electricity from renewables (TWh)":343.88},{"Year":2004,"Entity":"Canada","Value_co2_emissions_kt_by_country":536419.9829,"Electricity from fossil fuels (TWh)":148.86,"Electricity from nuclear (TWh)":85.87,"Electricity from renewables (TWh)":347.68},{"Year":2005,"Entity":"Canada","Value_co2_emissions_kt_by_country":549030.0293,"Electricity from fossil fuels (TWh)":150.78,"Electricity from nuclear (TWh)":86.83,"Electricity from renewables (TWh)":368.86},{"Year":2006,"Entity":"Canada","Value_co2_emissions_kt_by_country":540530.0293,"Electricity from fossil fuels (TWh)":139.71,"Electricity from nuclear (TWh)":92.44,"Electricity from renewables (TWh)":360.48},{"Year":2007,"Entity":"Canada","Value_co2_emissions_kt_by_country":571630.0049,"Electricity from fossil fuels (TWh)":149.36,"Electricity from nuclear (TWh)":88.19,"Electricity from renewables (TWh)":375.42},{"Year":2008,"Entity":"Canada","Value_co2_emissions_kt_by_country":550469.9707,"Electricity from fossil fuels (TWh)":141.33,"Electricity from nuclear (TWh)":88.3,"Electricity from renewables (TWh)":385.21},{"Year":2009,"Entity":"Canada","Value_co2_emissions_kt_by_country":521320.0073,"Electricity from fossil fuels (TWh)":129.76,"Electricity from nuclear (TWh)":85.13,"Electricity from renewables (TWh)":380.24},{"Year":2010,"Entity":"Canada","Value_co2_emissions_kt_by_country":537010.0098,"Electricity from fossil fuels (TWh)":130.08,"Electricity from nuclear (TWh)":85.53,"Electricity from renewables (TWh)":366.21},{"Year":2011,"Entity":"Canada","Value_co2_emissions_kt_by_country":549289.978,"Electricity from fossil fuels (TWh)":131.3,"Electricity from nuclear (TWh)":88.29,"Electricity from renewables (TWh)":391.95},{"Year":2012,"Entity":"Canada","Value_co2_emissions_kt_by_country":546210.022,"Electricity from fossil fuels (TWh)":124.2,"Electricity from nuclear (TWh)":89.49,"Electricity from renewables (TWh)":398.58},{"Year":2013,"Entity":"Canada","Value_co2_emissions_kt_by_country":555659.9731,"Electricity from fossil fuels (TWh)":122.87,"Electricity from nuclear (TWh)":97.58,"Electricity from renewables (TWh)":417.28},{"Year":2014,"Entity":"Canada","Value_co2_emissions_kt_by_country":561679.9927,"Electricity from fossil fuels (TWh)":122.75,"Electricity from nuclear (TWh)":101.21,"Electricity from renewables (TWh)":412.13},{"Year":2015,"Entity":"Canada","Value_co2_emissions_kt_by_country":558700.0122,"Electricity from fossil fuels (TWh)":125.7,"Electricity from nuclear (TWh)":96.05,"Electricity from renewables (TWh)":417.2},{"Year":2016,"Entity":"Canada","Value_co2_emissions_kt_by_country":556830.0171,"Electricity from fossil fuels (TWh)":122.35,"Electricity from nuclear (TWh)":95.69,"Electricity from renewables (TWh)":426.84},{"Year":2017,"Entity":"Canada","Value_co2_emissions_kt_by_country":568080.0171,"Electricity from fossil fuels (TWh)":113.7,"Electricity from nuclear (TWh)":95.57,"Electricity from renewables (TWh)":435.43},{"Year":2018,"Entity":"Canada","Value_co2_emissions_kt_by_country":580090.0269,"Electricity from fossil fuels (TWh)":112.47,"Electricity from nuclear (TWh)":95.03,"Electricity from renewables (TWh)":428.39},{"Year":2019,"Entity":"Canada","Value_co2_emissions_kt_by_country":580210.022,"Electricity from fossil fuels (TWh)":110.65,"Electricity from nuclear (TWh)":95.47,"Electricity from renewables (TWh)":421.8},{"Year":2020,"Entity":"Canada","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":102.19,"Electricity from nuclear (TWh)":92.65,"Electricity from renewables (TWh)":429.24},{"Year":2000,"Entity":"China","Value_co2_emissions_kt_by_country":3346530,"Electricity from fossil fuels (TWh)":1113.3,"Electricity from nuclear (TWh)":16.74,"Electricity from renewables (TWh)":225.56},{"Year":2001,"Entity":"China","Value_co2_emissions_kt_by_country":3529080,"Electricity from fossil fuels (TWh)":1182.59,"Electricity from nuclear (TWh)":17.47,"Electricity from renewables (TWh)":280.73},{"Year":2002,"Entity":"China","Value_co2_emissions_kt_by_country":3810060.059,"Electricity from fossil fuels (TWh)":1337.46,"Electricity from nuclear (TWh)":25.13,"Electricity from renewables (TWh)":291.41},{"Year":2003,"Entity":"China","Value_co2_emissions_kt_by_country":4415910.156,"Electricity from fossil fuels (TWh)":1579.96,"Electricity from nuclear (TWh)":43.34,"Electricity from renewables (TWh)":287.28},{"Year":2004,"Entity":"China","Value_co2_emissions_kt_by_country":5124819.824,"Electricity from fossil fuels (TWh)":1795.41,"Electricity from nuclear (TWh)":50.47,"Electricity from renewables (TWh)":357.43},{"Year":2005,"Entity":"China","Value_co2_emissions_kt_by_country":5824629.883,"Electricity from fossil fuels (TWh)":2042.8,"Electricity from nuclear (TWh)":53.09,"Electricity from renewables (TWh)":404.37},{"Year":2006,"Entity":"China","Value_co2_emissions_kt_by_country":6437470.215,"Electricity from fossil fuels (TWh)":2364.16,"Electricity from nuclear (TWh)":54.84,"Electricity from renewables (TWh)":446.72},{"Year":2007,"Entity":"China","Value_co2_emissions_kt_by_country":6993180.176,"Electricity from fossil fuels (TWh)":2718.7,"Electricity from nuclear (TWh)":62.13,"Electricity from renewables (TWh)":500.71},{"Year":2008,"Entity":"China","Value_co2_emissions_kt_by_country":7199600.098,"Electricity from fossil fuels (TWh)":2762.29,"Electricity from nuclear (TWh)":68.39,"Electricity from renewables (TWh)":665.08},{"Year":2009,"Entity":"China","Value_co2_emissions_kt_by_country":7719069.824,"Electricity from fossil fuels (TWh)":2980.2,"Electricity from nuclear (TWh)":70.05,"Electricity from renewables (TWh)":664.39},{"Year":2010,"Entity":"China","Value_co2_emissions_kt_by_country":8474919.922,"Electricity from fossil fuels (TWh)":3326.19,"Electricity from nuclear (TWh)":74.74,"Electricity from renewables (TWh)":786.38},{"Year":2011,"Entity":"China","Value_co2_emissions_kt_by_country":9282549.805,"Electricity from fossil fuels (TWh)":3811.77,"Electricity from nuclear (TWh)":87.2,"Electricity from renewables (TWh)":792.38},{"Year":2012,"Entity":"China","Value_co2_emissions_kt_by_country":9541870.117,"Electricity from fossil fuels (TWh)":3869.38,"Electricity from nuclear (TWh)":98.32,"Electricity from renewables (TWh)":999.56},{"Year":2013,"Entity":"China","Value_co2_emissions_kt_by_country":9984570.313,"Electricity from fossil fuels (TWh)":4203.77,"Electricity from nuclear (TWh)":111.5,"Electricity from renewables (TWh)":1093.37},{"Year":2014,"Entity":"China","Value_co2_emissions_kt_by_country":10006669.92,"Electricity from fossil fuels (TWh)":4345.86,"Electricity from nuclear (TWh)":133.22,"Electricity from renewables (TWh)":1289.23},{"Year":2015,"Entity":"China","Value_co2_emissions_kt_by_country":9861099.609,"Electricity from fossil fuels (TWh)":4222.76,"Electricity from nuclear (TWh)":171.38,"Electricity from renewables (TWh)":1393.66},{"Year":2016,"Entity":"China","Value_co2_emissions_kt_by_country":9874660.156,"Electricity from fossil fuels (TWh)":4355,"Electricity from nuclear (TWh)":213.18,"Electricity from renewables (TWh)":1522.79},{"Year":2017,"Entity":"China","Value_co2_emissions_kt_by_country":10096009.77,"Electricity from fossil fuels (TWh)":4643.1,"Electricity from nuclear (TWh)":248.1,"Electricity from renewables (TWh)":1667.06},{"Year":2018,"Entity":"China","Value_co2_emissions_kt_by_country":10502929.69,"Electricity from fossil fuels (TWh)":4990.28,"Electricity from nuclear (TWh)":295,"Electricity from renewables (TWh)":1835.32},{"Year":2019,"Entity":"China","Value_co2_emissions_kt_by_country":10707219.73,"Electricity from fossil fuels (TWh)":5098.22,"Electricity from nuclear (TWh)":348.7,"Electricity from renewables (TWh)":2014.57},{"Year":2020,"Entity":"China","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":5184.13,"Electricity from nuclear (TWh)":366.2,"Electricity from renewables (TWh)":2184.94},{"Year":2000,"Entity":"France","Value_co2_emissions_kt_by_country":373120,"Electricity from fossil fuels (TWh)":50.61,"Electricity from nuclear (TWh)":415.16,"Electricity from renewables (TWh)":67.83},{"Year":2001,"Entity":"France","Value_co2_emissions_kt_by_country":376730,"Electricity from fossil fuels (TWh)":46.48,"Electricity from nuclear (TWh)":421.08,"Electricity from renewables (TWh)":76.09},{"Year":2002,"Entity":"France","Value_co2_emissions_kt_by_country":371019.989,"Electricity from fossil fuels (TWh)":52.67,"Electricity from nuclear (TWh)":436.76,"Electricity from renewables (TWh)":62.69},{"Year":2003,"Entity":"France","Value_co2_emissions_kt_by_country":376709.9915,"Electricity from fossil fuels (TWh)":57.38,"Electricity from nuclear (TWh)":441.07,"Electricity from renewables (TWh)":61.47},{"Year":2004,"Entity":"France","Value_co2_emissions_kt_by_country":377790.0085,"Electricity from fossil fuels (TWh)":56.53,"Electricity from nuclear (TWh)":448.24,"Electricity from renewables (TWh)":62.42},{"Year":2005,"Entity":"France","Value_co2_emissions_kt_by_country":380660.0037,"Electricity from fossil fuels (TWh)":63.35,"Electricity from nuclear (TWh)":451.53,"Electricity from renewables (TWh)":54.98},{"Year":2006,"Entity":"France","Value_co2_emissions_kt_by_country":371549.9878,"Electricity from fossil fuels (TWh)":56.9,"Electricity from nuclear (TWh)":450.19,"Electricity from renewables (TWh)":60.91},{"Year":2007,"Entity":"France","Value_co2_emissions_kt_by_country":362829.9866,"Electricity from fossil fuels (TWh)":58.18,"Electricity from nuclear (TWh)":439.73,"Electricity from renewables (TWh)":64.3},{"Year":2008,"Entity":"France","Value_co2_emissions_kt_by_country":357989.9902,"Electricity from fossil fuels (TWh)":55.57,"Electricity from nuclear (TWh)":439.45,"Electricity from renewables (TWh)":72.33},{"Year":2009,"Entity":"France","Value_co2_emissions_kt_by_country":343730.011,"Electricity from fossil fuels (TWh)":51.32,"Electricity from nuclear (TWh)":409.74,"Electricity from renewables (TWh)":68.15},{"Year":2010,"Entity":"France","Value_co2_emissions_kt_by_country":347779.9988,"Electricity from fossil fuels (TWh)":57.63,"Electricity from nuclear (TWh)":428.52,"Electricity from renewables (TWh)":76.68},{"Year":2011,"Entity":"France","Value_co2_emissions_kt_by_country":335140.0146,"Electricity from fossil fuels (TWh)":58.99,"Electricity from nuclear (TWh)":442.39,"Electricity from renewables (TWh)":66.02},{"Year":2012,"Entity":"France","Value_co2_emissions_kt_by_country":338420.0134,"Electricity from fossil fuels (TWh)":56.42,"Electricity from nuclear (TWh)":425.41,"Electricity from renewables (TWh)":85.25},{"Year":2013,"Entity":"France","Value_co2_emissions_kt_by_country":338559.9976,"Electricity from fossil fuels (TWh)":53.35,"Electricity from nuclear (TWh)":423.68,"Electricity from renewables (TWh)":99.42},{"Year":2014,"Entity":"France","Value_co2_emissions_kt_by_country":306100.0061,"Electricity from fossil fuels (TWh)":35.68,"Electricity from nuclear (TWh)":436.48,"Electricity from renewables (TWh)":94.03},{"Year":2015,"Entity":"France","Value_co2_emissions_kt_by_country":311299.9878,"Electricity from fossil fuels (TWh)":44.65,"Electricity from nuclear (TWh)":437.43,"Electricity from renewables (TWh)":91.84},{"Year":2016,"Entity":"France","Value_co2_emissions_kt_by_country":313920.0134,"Electricity from fossil fuels (TWh)":56.45,"Electricity from nuclear (TWh)":403.2,"Electricity from renewables (TWh)":99},{"Year":2017,"Entity":"France","Value_co2_emissions_kt_by_country":317829.9866,"Electricity from fossil fuels (TWh)":65.09,"Electricity from nuclear (TWh)":398.36,"Electricity from renewables (TWh)":92.63},{"Year":2018,"Entity":"France","Value_co2_emissions_kt_by_country":307049.9878,"Electricity from fossil fuels (TWh)":49.27,"Electricity from nuclear (TWh)":412.94,"Electricity from renewables (TWh)":113.62},{"Year":2019,"Entity":"France","Value_co2_emissions_kt_by_country":300519.989,"Electricity from fossil fuels (TWh)":53.5,"Electricity from nuclear (TWh)":399.01,"Electricity from renewables (TWh)":113.21},{"Year":2020,"Entity":"France","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":48.14,"Electricity from nuclear (TWh)":353.83,"Electricity from renewables (TWh)":125.28},{"Year":2000,"Entity":"Germany","Value_co2_emissions_kt_by_country":830280,"Electricity from fossil fuels (TWh)":367.22,"Electricity from nuclear (TWh)":169.61,"Electricity from renewables (TWh)":35.47},{"Year":2001,"Entity":"Germany","Value_co2_emissions_kt_by_country":847680,"Electricity from fossil fuels (TWh)":372.69,"Electricity from nuclear (TWh)":171.3,"Electricity from renewables (TWh)":37.9},{"Year":2002,"Entity":"Germany","Value_co2_emissions_kt_by_country":833380.0049,"Electricity from fossil fuels (TWh)":372.64,"Electricity from nuclear (TWh)":164.84,"Electricity from renewables (TWh)":44.48},{"Year":2003,"Entity":"Germany","Value_co2_emissions_kt_by_country":836789.978,"Electricity from fossil fuels (TWh)":390.81,"Electricity from nuclear (TWh)":165.06,"Electricity from renewables (TWh)":46.67},{"Year":2004,"Entity":"Germany","Value_co2_emissions_kt_by_country":821070.0073,"Electricity from fossil fuels (TWh)":385.24,"Electricity from nuclear (TWh)":167.07,"Electricity from renewables (TWh)":57.97},{"Year":2005,"Entity":"Germany","Value_co2_emissions_kt_by_country":802380.0049,"Electricity from fossil fuels (TWh)":386.96,"Electricity from nuclear (TWh)":163.05,"Electricity from renewables (TWh)":63.4},{"Year":2006,"Entity":"Germany","Value_co2_emissions_kt_by_country":814409.9731,"Electricity from fossil fuels (TWh)":390.03,"Electricity from nuclear (TWh)":167.27,"Electricity from renewables (TWh)":72.51},{"Year":2007,"Entity":"Germany","Value_co2_emissions_kt_by_country":783799.9878,"Electricity from fossil fuels (TWh)":402.4,"Electricity from nuclear (TWh)":140.53,"Electricity from renewables (TWh)":89.38},{"Year":2008,"Entity":"Germany","Value_co2_emissions_kt_by_country":789690.0024,"Electricity from fossil fuels (TWh)":390.43,"Electricity from nuclear (TWh)":148.49,"Electricity from renewables (TWh)":94.28},{"Year":2009,"Entity":"Germany","Value_co2_emissions_kt_by_country":734809.9976,"Electricity from fossil fuels (TWh)":358.07,"Electricity from nuclear (TWh)":134.93,"Electricity from renewables (TWh)":95.94},{"Year":2010,"Entity":"Germany","Value_co2_emissions_kt_by_country":773070.0073,"Electricity from fossil fuels (TWh)":378.9,"Electricity from nuclear (TWh)":140.56,"Electricity from renewables (TWh)":105.18},{"Year":2011,"Entity":"Germany","Value_co2_emissions_kt_by_country":746479.9805,"Electricity from fossil fuels (TWh)":373.16,"Electricity from nuclear (TWh)":107.97,"Electricity from renewables (TWh)":124.04},{"Year":2012,"Entity":"Germany","Value_co2_emissions_kt_by_country":760130.0049,"Electricity from fossil fuels (TWh)":377.89,"Electricity from nuclear (TWh)":99.46,"Electricity from renewables (TWh)":143.04},{"Year":2013,"Entity":"Germany","Value_co2_emissions_kt_by_country":776150.0244,"Electricity from fossil fuels (TWh)":381.52,"Electricity from nuclear (TWh)":97.29,"Electricity from renewables (TWh)":152.34},{"Year":2014,"Entity":"Germany","Value_co2_emissions_kt_by_country":736010.0098,"Electricity from fossil fuels (TWh)":360.28,"Electricity from nuclear (TWh)":97.13,"Electricity from renewables (TWh)":162.54},{"Year":2015,"Entity":"Germany","Value_co2_emissions_kt_by_country":742309.9976,"Electricity from fossil fuels (TWh)":359.99,"Electricity from nuclear (TWh)":91.79,"Electricity from renewables (TWh)":188.79},{"Year":2016,"Entity":"Germany","Value_co2_emissions_kt_by_country":747150.0244,"Electricity from fossil fuels (TWh)":368.67,"Electricity from nuclear (TWh)":84.63,"Electricity from renewables (TWh)":189.67},{"Year":2017,"Entity":"Germany","Value_co2_emissions_kt_by_country":732200.0122,"Electricity from fossil fuels (TWh)":353.37,"Electricity from nuclear (TWh)":76.32,"Electricity from renewables (TWh)":216.32},{"Year":2018,"Entity":"Germany","Value_co2_emissions_kt_by_country":707700.0122,"Electricity from fossil fuels (TWh)":334.65,"Electricity from nuclear (TWh)":76,"Electricity from renewables (TWh)":222.07},{"Year":2019,"Entity":"Germany","Value_co2_emissions_kt_by_country":657400.0244,"Electricity from fossil fuels (TWh)":284.09,"Electricity from nuclear (TWh)":75.07,"Electricity from renewables (TWh)":240.33},{"Year":2020,"Entity":"Germany","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":251.4,"Electricity from nuclear (TWh)":64.38,"Electricity from renewables (TWh)":251.48},{"Year":2000,"Entity":"India","Value_co2_emissions_kt_by_country":937860,"Electricity from fossil fuels (TWh)":475.35,"Electricity from nuclear (TWh)":15.77,"Electricity from renewables (TWh)":80.27},{"Year":2001,"Entity":"India","Value_co2_emissions_kt_by_country":953540,"Electricity from fossil fuels (TWh)":491.01,"Electricity from nuclear (TWh)":18.89,"Electricity from renewables (TWh)":76.19},{"Year":2002,"Entity":"India","Value_co2_emissions_kt_by_country":985450.0122,"Electricity from fossil fuels (TWh)":517.51,"Electricity from nuclear (TWh)":19.35,"Electricity from renewables (TWh)":72.78},{"Year":2003,"Entity":"India","Value_co2_emissions_kt_by_country":1011770.02,"Electricity from fossil fuels (TWh)":545.36,"Electricity from nuclear (TWh)":18.14,"Electricity from renewables (TWh)":74.63},{"Year":2004,"Entity":"India","Value_co2_emissions_kt_by_country":1085670.044,"Electricity from fossil fuels (TWh)":567.86,"Electricity from nuclear (TWh)":21.26,"Electricity from renewables (TWh)":109.2},{"Year":2005,"Entity":"India","Value_co2_emissions_kt_by_country":1136469.971,"Electricity from fossil fuels (TWh)":579.32,"Electricity from nuclear (TWh)":17.73,"Electricity from renewables (TWh)":107.47},{"Year":2006,"Entity":"India","Value_co2_emissions_kt_by_country":1215209.961,"Electricity from fossil fuels (TWh)":599.24,"Electricity from nuclear (TWh)":17.63,"Electricity from renewables (TWh)":127.56},{"Year":2007,"Entity":"India","Value_co2_emissions_kt_by_country":1336739.99,"Electricity from fossil fuels (TWh)":636.68,"Electricity from nuclear (TWh)":17.83,"Electricity from renewables (TWh)":141.75},{"Year":2008,"Entity":"India","Value_co2_emissions_kt_by_country":1424380.005,"Electricity from fossil fuels (TWh)":674.27,"Electricity from nuclear (TWh)":15.23,"Electricity from renewables (TWh)":138.91},{"Year":2009,"Entity":"India","Value_co2_emissions_kt_by_country":1564880.005,"Electricity from fossil fuels (TWh)":728.56,"Electricity from nuclear (TWh)":16.82,"Electricity from renewables (TWh)":134.33},{"Year":2010,"Entity":"India","Value_co2_emissions_kt_by_country":1659979.98,"Electricity from fossil fuels (TWh)":771.78,"Electricity from nuclear (TWh)":23.08,"Electricity from renewables (TWh)":142.61},{"Year":2011,"Entity":"India","Value_co2_emissions_kt_by_country":1756739.99,"Electricity from fossil fuels (TWh)":828.16,"Electricity from nuclear (TWh)":32.22,"Electricity from renewables (TWh)":173.62},{"Year":2012,"Entity":"India","Value_co2_emissions_kt_by_country":1909439.941,"Electricity from fossil fuels (TWh)":893.45,"Electricity from nuclear (TWh)":33.14,"Electricity from renewables (TWh)":165.25},{"Year":2013,"Entity":"India","Value_co2_emissions_kt_by_country":1972430.054,"Electricity from fossil fuels (TWh)":924.93,"Electricity from nuclear (TWh)":33.31,"Electricity from renewables (TWh)":187.9},{"Year":2014,"Entity":"India","Value_co2_emissions_kt_by_country":2147110.107,"Electricity from fossil fuels (TWh)":1025.29,"Electricity from nuclear (TWh)":34.69,"Electricity from renewables (TWh)":202.04},{"Year":2015,"Entity":"India","Value_co2_emissions_kt_by_country":2158020.02,"Electricity from fossil fuels (TWh)":1080.44,"Electricity from nuclear (TWh)":38.31,"Electricity from renewables (TWh)":203.21},{"Year":2016,"Entity":"India","Value_co2_emissions_kt_by_country":2195250,"Electricity from fossil fuels (TWh)":1155.52,"Electricity from nuclear (TWh)":37.9,"Electricity from renewables (TWh)":208.21},{"Year":2017,"Entity":"India","Value_co2_emissions_kt_by_country":2320409.912,"Electricity from fossil fuels (TWh)":1198.85,"Electricity from nuclear (TWh)":37.41,"Electricity from renewables (TWh)":234.9},{"Year":2018,"Entity":"India","Value_co2_emissions_kt_by_country":2451929.932,"Electricity from fossil fuels (TWh)":1276.32,"Electricity from nuclear (TWh)":39.05,"Electricity from renewables (TWh)":263.61},{"Year":2019,"Entity":"India","Value_co2_emissions_kt_by_country":2456300.049,"Electricity from fossil fuels (TWh)":1273.59,"Electricity from nuclear (TWh)":45.16,"Electricity from renewables (TWh)":303.16},{"Year":2020,"Entity":"India","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":1202.34,"Electricity from nuclear (TWh)":44.61,"Electricity from renewables (TWh)":315.76},{"Year":2000,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":280650,"Electricity from fossil fuels (TWh)":78.43,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":19.6},{"Year":2001,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":302060,"Electricity from fossil fuels (TWh)":83.96,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":22.19},{"Year":2002,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":305640.0146,"Electricity from fossil fuels (TWh)":92.03,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":21},{"Year":2003,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":333890.0146,"Electricity from fossil fuels (TWh)":97.57,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":19.82},{"Year":2004,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":341239.9902,"Electricity from fossil fuels (TWh)":103.8,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":20.97},{"Year":2005,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":342149.9939,"Electricity from fossil fuels (TWh)":110.22,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":22.66},{"Year":2006,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":364470.0012,"Electricity from fossil fuels (TWh)":116.8,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":21.18},{"Year":2007,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":379959.9915,"Electricity from fossil fuels (TWh)":124.1,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":24.29},{"Year":2008,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":376140.0146,"Electricity from fossil fuels (TWh)":129.55,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":26.34},{"Year":2009,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":391079.9866,"Electricity from fossil fuels (TWh)":136.05,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":26.79},{"Year":2010,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":415519.989,"Electricity from fossil fuels (TWh)":142.88,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":34.63},{"Year":2011,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":475309.9976,"Electricity from fossil fuels (TWh)":161.41,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":30.46},{"Year":2012,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":481510.0098,"Electricity from fossil fuels (TWh)":177.83,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":31.11},{"Year":2013,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":447940.0024,"Electricity from fossil fuels (TWh)":189.66,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":35.5},{"Year":2014,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":483910.0037,"Electricity from fossil fuels (TWh)":203.11,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":34.41},{"Year":2015,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":488549.9878,"Electricity from fossil fuels (TWh)":209.71,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":33.56},{"Year":2016,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":482510.0098,"Electricity from fossil fuels (TWh)":217.97,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":39.58},{"Year":2017,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":517320.0073,"Electricity from fossil fuels (TWh)":222.64,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":43.17},{"Year":2018,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":576989.9902,"Electricity from fossil fuels (TWh)":235.41,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":48.38},{"Year":2019,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":619840.0269,"Electricity from fossil fuels (TWh)":247.39,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":48.04},{"Year":2020,"Entity":"Indonesia","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":238.91,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":52.91},{"Year":2000,"Entity":"Italy","Value_co2_emissions_kt_by_country":436300,"Electricity from fossil fuels (TWh)":218.28,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":50.87},{"Year":2001,"Entity":"Italy","Value_co2_emissions_kt_by_country":436570,"Electricity from fossil fuels (TWh)":216.73,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":54.35},{"Year":2002,"Entity":"Italy","Value_co2_emissions_kt_by_country":443470.0012,"Electricity from fossil fuels (TWh)":228.45,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":48.31},{"Year":2003,"Entity":"Italy","Value_co2_emissions_kt_by_country":462200.0122,"Electricity from fossil fuels (TWh)":238.52,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":46.86},{"Year":2004,"Entity":"Italy","Value_co2_emissions_kt_by_country":472399.9939,"Electricity from fossil fuels (TWh)":240.95,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":53.88},{"Year":2005,"Entity":"Italy","Value_co2_emissions_kt_by_country":473829.9866,"Electricity from fossil fuels (TWh)":247.29,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":48.43},{"Year":2006,"Entity":"Italy","Value_co2_emissions_kt_by_country":466649.9939,"Electricity from fossil fuels (TWh)":256.03,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":50.64},{"Year":2007,"Entity":"Italy","Value_co2_emissions_kt_by_country":459369.9951,"Electricity from fossil fuels (TWh)":259.49,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":47.72},{"Year":2008,"Entity":"Italy","Value_co2_emissions_kt_by_country":444980.011,"Electricity from fossil fuels (TWh)":254.34,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":58.16},{"Year":2009,"Entity":"Italy","Value_co2_emissions_kt_by_country":397059.9976,"Electricity from fossil fuels (TWh)":218.32,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":69.26},{"Year":2010,"Entity":"Italy","Value_co2_emissions_kt_by_country":405269.989,"Electricity from fossil fuels (TWh)":220.93,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":76.98},{"Year":2011,"Entity":"Italy","Value_co2_emissions_kt_by_country":396690.0024,"Electricity from fossil fuels (TWh)":216.78,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":82.96},{"Year":2012,"Entity":"Italy","Value_co2_emissions_kt_by_country":376750,"Electricity from fossil fuels (TWh)":204.26,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":92.22},{"Year":2013,"Entity":"Italy","Value_co2_emissions_kt_by_country":346459.9915,"Electricity from fossil fuels (TWh)":175.07,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":112},{"Year":2014,"Entity":"Italy","Value_co2_emissions_kt_by_country":327500,"Electricity from fossil fuels (TWh)":156.76,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":120.68},{"Year":2015,"Entity":"Italy","Value_co2_emissions_kt_by_country":337859.9854,"Electricity from fossil fuels (TWh)":172.06,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":108.89},{"Year":2016,"Entity":"Italy","Value_co2_emissions_kt_by_country":333339.9963,"Electricity from fossil fuels (TWh)":179.19,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":108.01},{"Year":2017,"Entity":"Italy","Value_co2_emissions_kt_by_country":329190.0024,"Electricity from fossil fuels (TWh)":189.44,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":103.89},{"Year":2018,"Entity":"Italy","Value_co2_emissions_kt_by_country":324880.0049,"Electricity from fossil fuels (TWh)":172.98,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":114.41},{"Year":2019,"Entity":"Italy","Value_co2_emissions_kt_by_country":317239.9902,"Electricity from fossil fuels (TWh)":175.52,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":115.83},{"Year":2020,"Entity":"Italy","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":161.17,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":116.9},{"Year":2000,"Entity":"Japan","Value_co2_emissions_kt_by_country":1182610,"Electricity from fossil fuels (TWh)":578.29,"Electricity from nuclear (TWh)":305.95,"Electricity from renewables (TWh)":104.16},{"Year":2001,"Entity":"Japan","Value_co2_emissions_kt_by_country":1170380,"Electricity from fossil fuels (TWh)":564.95,"Electricity from nuclear (TWh)":303.86,"Electricity from renewables (TWh)":101.36},{"Year":2002,"Entity":"Japan","Value_co2_emissions_kt_by_country":1206599.976,"Electricity from fossil fuels (TWh)":605.12,"Electricity from nuclear (TWh)":280.34,"Electricity from renewables (TWh)":101.1},{"Year":2003,"Entity":"Japan","Value_co2_emissions_kt_by_country":1214949.951,"Electricity from fossil fuels (TWh)":633.76,"Electricity from nuclear (TWh)":228.01,"Electricity from renewables (TWh)":114.18},{"Year":2004,"Entity":"Japan","Value_co2_emissions_kt_by_country":1209849.976,"Electricity from fossil fuels (TWh)":621.6,"Electricity from nuclear (TWh)":268.32,"Electricity from renewables (TWh)":114.73},{"Year":2005,"Entity":"Japan","Value_co2_emissions_kt_by_country":1212819.946,"Electricity from fossil fuels (TWh)":634.09,"Electricity from nuclear (TWh)":280.5,"Electricity from renewables (TWh)":100.57},{"Year":2006,"Entity":"Japan","Value_co2_emissions_kt_by_country":1189520.02,"Electricity from fossil fuels (TWh)":628.77,"Electricity from nuclear (TWh)":291.54,"Electricity from renewables (TWh)":112.07},{"Year":2007,"Entity":"Japan","Value_co2_emissions_kt_by_country":1225069.946,"Electricity from fossil fuels (TWh)":705.37,"Electricity from nuclear (TWh)":267.34,"Electricity from renewables (TWh)":100.8},{"Year":2008,"Entity":"Japan","Value_co2_emissions_kt_by_country":1158219.971,"Electricity from fossil fuels (TWh)":663.88,"Electricity from nuclear (TWh)":241.25,"Electricity from renewables (TWh)":100.79},{"Year":2009,"Entity":"Japan","Value_co2_emissions_kt_by_country":1100979.98,"Electricity from fossil fuels (TWh)":611.86,"Electricity from nuclear (TWh)":263.05,"Electricity from renewables (TWh)":102.28},{"Year":2010,"Entity":"Japan","Value_co2_emissions_kt_by_country":1156479.98,"Electricity from fossil fuels (TWh)":689.89,"Electricity from nuclear (TWh)":278.36,"Electricity from renewables (TWh)":113.92},{"Year":2011,"Entity":"Japan","Value_co2_emissions_kt_by_country":1213520.02,"Electricity from fossil fuels (TWh)":777.1,"Electricity from nuclear (TWh)":153.38,"Electricity from renewables (TWh)":116.5},{"Year":2012,"Entity":"Japan","Value_co2_emissions_kt_by_country":1253609.985,"Electricity from fossil fuels (TWh)":920.39,"Electricity from nuclear (TWh)":15.12,"Electricity from renewables (TWh)":111.09},{"Year":2013,"Entity":"Japan","Value_co2_emissions_kt_by_country":1262780.029,"Electricity from fossil fuels (TWh)":897.88,"Electricity from nuclear (TWh)":10.43,"Electricity from renewables (TWh)":121.48},{"Year":2014,"Entity":"Japan","Value_co2_emissions_kt_by_country":1217119.995,"Electricity from fossil fuels (TWh)":892.18,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":136.53},{"Year":2015,"Entity":"Japan","Value_co2_emissions_kt_by_country":1179439.941,"Electricity from fossil fuels (TWh)":844.23,"Electricity from nuclear (TWh)":3.24,"Electricity from renewables (TWh)":157.34},{"Year":2016,"Entity":"Japan","Value_co2_emissions_kt_by_country":1167790.039,"Electricity from fossil fuels (TWh)":832.4,"Electricity from nuclear (TWh)":14.87,"Electricity from renewables (TWh)":157.7},{"Year":2017,"Entity":"Japan","Value_co2_emissions_kt_by_country":1155229.98,"Electricity from fossil fuels (TWh)":806.12,"Electricity from nuclear (TWh)":27.75,"Electricity from renewables (TWh)":175.12},{"Year":2018,"Entity":"Japan","Value_co2_emissions_kt_by_country":1116150.024,"Electricity from fossil fuels (TWh)":780.61,"Electricity from nuclear (TWh)":47.82,"Electricity from renewables (TWh)":183.63},{"Year":2019,"Entity":"Japan","Value_co2_emissions_kt_by_country":1081569.946,"Electricity from fossil fuels (TWh)":735.66,"Electricity from nuclear (TWh)":63.88,"Electricity from renewables (TWh)":192.72},{"Year":2020,"Entity":"Japan","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":716.67,"Electricity from nuclear (TWh)":41.86,"Electricity from renewables (TWh)":205.6},{"Year":2000,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":120150,"Electricity from fossil fuels (TWh)":44.11,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.53},{"Year":2001,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":117440,"Electricity from fossil fuels (TWh)":47.3,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.08},{"Year":2002,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":131059.9976,"Electricity from fossil fuels (TWh)":49.44,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.89},{"Year":2003,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":146139.9994,"Electricity from fossil fuels (TWh)":55.24,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.62},{"Year":2004,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":158029.9988,"Electricity from fossil fuels (TWh)":58.89,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.06},{"Year":2005,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":169210.0067,"Electricity from fossil fuels (TWh)":60.06,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.86},{"Year":2006,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":185300.0031,"Electricity from fossil fuels (TWh)":63.89,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.77},{"Year":2007,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":198389.9994,"Electricity from fossil fuels (TWh)":68.45,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.17},{"Year":2008,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":242029.9988,"Electricity from fossil fuels (TWh)":72.89,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.46},{"Year":2009,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":213610.0006,"Electricity from fossil fuels (TWh)":71.85,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":6.88},{"Year":2010,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":229699.9969,"Electricity from fossil fuels (TWh)":74.63,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.02},{"Year":2011,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":245449.9969,"Electricity from fossil fuels (TWh)":78.7,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.88},{"Year":2012,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":244600.0061,"Electricity from fossil fuels (TWh)":82.98,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.64},{"Year":2013,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":260010.0098,"Electricity from fossil fuels (TWh)":84.88,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":7.73},{"Year":2014,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":209229.9957,"Electricity from fossil fuels (TWh)":86.37,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":8.27},{"Year":2015,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":190729.9957,"Electricity from fossil fuels (TWh)":82.2,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":9.45},{"Year":2016,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":202149.9939,"Electricity from fossil fuels (TWh)":82.65,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":11.98},{"Year":2017,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":214580.0018,"Electricity from fossil fuels (TWh)":91.48,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":11.64},{"Year":2018,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":216600.0061,"Electricity from fossil fuels (TWh)":96.36,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":10.91},{"Year":2019,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":212110.0006,"Electricity from fossil fuels (TWh)":95.39,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":11.09},{"Year":2020,"Entity":"Kazakhstan","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":96.7,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":11.94},{"Year":2000,"Entity":"Mexico","Value_co2_emissions_kt_by_country":379180,"Electricity from fossil fuels (TWh)":141.8,"Electricity from nuclear (TWh)":7.81,"Electricity from renewables (TWh)":44.51},{"Year":2001,"Entity":"Mexico","Value_co2_emissions_kt_by_country":378830,"Electricity from fossil fuels (TWh)":153.32,"Electricity from nuclear (TWh)":8.29,"Electricity from renewables (TWh)":39.56},{"Year":2002,"Entity":"Mexico","Value_co2_emissions_kt_by_country":386000,"Electricity from fossil fuels (TWh)":159.81,"Electricity from nuclear (TWh)":9.26,"Electricity from renewables (TWh)":35.67},{"Year":2003,"Entity":"Mexico","Value_co2_emissions_kt_by_country":404690.0024,"Electricity from fossil fuels (TWh)":160.45,"Electricity from nuclear (TWh)":9.98,"Electricity from renewables (TWh)":32.11},{"Year":2004,"Entity":"Mexico","Value_co2_emissions_kt_by_country":414100.0061,"Electricity from fossil fuels (TWh)":173.66,"Electricity from nuclear (TWh)":8.73,"Electricity from renewables (TWh)":38.19},{"Year":2005,"Entity":"Mexico","Value_co2_emissions_kt_by_country":432190.0024,"Electricity from fossil fuels (TWh)":178.76,"Electricity from nuclear (TWh)":10.32,"Electricity from renewables (TWh)":42.29},{"Year":2006,"Entity":"Mexico","Value_co2_emissions_kt_by_country":448299.9878,"Electricity from fossil fuels (TWh)":182.76,"Electricity from nuclear (TWh)":10.4,"Electricity from renewables (TWh)":43.63},{"Year":2007,"Entity":"Mexico","Value_co2_emissions_kt_by_country":457119.9951,"Electricity from fossil fuels (TWh)":191.83,"Electricity from nuclear (TWh)":9.95,"Electricity from renewables (TWh)":42.14},{"Year":2008,"Entity":"Mexico","Value_co2_emissions_kt_by_country":459549.9878,"Electricity from fossil fuels (TWh)":184.51,"Electricity from nuclear (TWh)":9.36,"Electricity from renewables (TWh)":53.22},{"Year":2009,"Entity":"Mexico","Value_co2_emissions_kt_by_country":448369.9951,"Electricity from fossil fuels (TWh)":194.75,"Electricity from nuclear (TWh)":10.11,"Electricity from renewables (TWh)":40.59},{"Year":2010,"Entity":"Mexico","Value_co2_emissions_kt_by_country":462869.9951,"Electricity from fossil fuels (TWh)":207.38,"Electricity from nuclear (TWh)":5.66,"Electricity from renewables (TWh)":51.37},{"Year":2011,"Entity":"Mexico","Value_co2_emissions_kt_by_country":478399.9939,"Electricity from fossil fuels (TWh)":219.88,"Electricity from nuclear (TWh)":9.66,"Electricity from renewables (TWh)":50.7},{"Year":2012,"Entity":"Mexico","Value_co2_emissions_kt_by_country":486450.0122,"Electricity from fossil fuels (TWh)":229.14,"Electricity from nuclear (TWh)":8.41,"Electricity from renewables (TWh)":47.2},{"Year":2013,"Entity":"Mexico","Value_co2_emissions_kt_by_country":475739.9902,"Electricity from fossil fuels (TWh)":231.23,"Electricity from nuclear (TWh)":11.38,"Electricity from renewables (TWh)":44.67},{"Year":2014,"Entity":"Mexico","Value_co2_emissions_kt_by_country":462239.9902,"Electricity from fossil fuels (TWh)":223.43,"Electricity from nuclear (TWh)":9.3,"Electricity from renewables (TWh)":57.46},{"Year":2015,"Entity":"Mexico","Value_co2_emissions_kt_by_country":471630.0049,"Electricity from fossil fuels (TWh)":234.28,"Electricity from nuclear (TWh)":11.18,"Electricity from renewables (TWh)":52.42},{"Year":2016,"Entity":"Mexico","Value_co2_emissions_kt_by_country":473309.9976,"Electricity from fossil fuels (TWh)":239.78,"Electricity from nuclear (TWh)":10.27,"Electricity from renewables (TWh)":52.97},{"Year":2017,"Entity":"Mexico","Value_co2_emissions_kt_by_country":471579.9866,"Electricity from fossil fuels (TWh)":242.69,"Electricity from nuclear (TWh)":10.57,"Electricity from renewables (TWh)":55.88},{"Year":2018,"Entity":"Mexico","Value_co2_emissions_kt_by_country":452570.0073,"Electricity from fossil fuels (TWh)":259.92,"Electricity from nuclear (TWh)":13.32,"Electricity from renewables (TWh)":58.78},{"Year":2019,"Entity":"Mexico","Value_co2_emissions_kt_by_country":449269.989,"Electricity from fossil fuels (TWh)":248.2,"Electricity from nuclear (TWh)":10.88,"Electricity from renewables (TWh)":59},{"Year":2020,"Entity":"Mexico","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":245.46,"Electricity from nuclear (TWh)":10.87,"Electricity from renewables (TWh)":69.19},{"Year":2000,"Entity":"Poland","Value_co2_emissions_kt_by_country":295770,"Electricity from fossil fuels (TWh)":140.85,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":2.33},{"Year":2001,"Entity":"Poland","Value_co2_emissions_kt_by_country":293630,"Electricity from fossil fuels (TWh)":140.94,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":2.78},{"Year":2002,"Entity":"Poland","Value_co2_emissions_kt_by_country":287320.0073,"Electricity from fossil fuels (TWh)":139.72,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":2.77},{"Year":2003,"Entity":"Poland","Value_co2_emissions_kt_by_country":297730.011,"Electricity from fossil fuels (TWh)":147.76,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":2.25},{"Year":2004,"Entity":"Poland","Value_co2_emissions_kt_by_country":301850.0061,"Electricity from fossil fuels (TWh)":149.06,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":3.2},{"Year":2005,"Entity":"Poland","Value_co2_emissions_kt_by_country":301350.0061,"Electricity from fossil fuels (TWh)":151.2,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":3.85},{"Year":2006,"Entity":"Poland","Value_co2_emissions_kt_by_country":314089.9963,"Electricity from fossil fuels (TWh)":156.16,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":4.29},{"Year":2007,"Entity":"Poland","Value_co2_emissions_kt_by_country":313380.0049,"Electricity from fossil fuels (TWh)":153.08,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":5.43},{"Year":2008,"Entity":"Poland","Value_co2_emissions_kt_by_country":308329.9866,"Electricity from fossil fuels (TWh)":148.03,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":6.61},{"Year":2009,"Entity":"Poland","Value_co2_emissions_kt_by_country":297260.0098,"Electricity from fossil fuels (TWh)":142.4,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":8.69},{"Year":2010,"Entity":"Poland","Value_co2_emissions_kt_by_country":313739.9902,"Electricity from fossil fuels (TWh)":146.12,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":10.88},{"Year":2011,"Entity":"Poland","Value_co2_emissions_kt_by_country":310589.9963,"Electricity from fossil fuels (TWh)":149.88,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":13.13},{"Year":2012,"Entity":"Poland","Value_co2_emissions_kt_by_country":303350.0061,"Electricity from fossil fuels (TWh)":144.75,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":16.88},{"Year":2013,"Entity":"Poland","Value_co2_emissions_kt_by_country":298299.9878,"Electricity from fossil fuels (TWh)":146.85,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":17.06},{"Year":2014,"Entity":"Poland","Value_co2_emissions_kt_by_country":285730.011,"Electricity from fossil fuels (TWh)":138.53,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":19.85},{"Year":2015,"Entity":"Poland","Value_co2_emissions_kt_by_country":289079.9866,"Electricity from fossil fuels (TWh)":141.55,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":22.69},{"Year":2016,"Entity":"Poland","Value_co2_emissions_kt_by_country":299799.9878,"Electricity from fossil fuels (TWh)":143.28,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":22.81},{"Year":2017,"Entity":"Poland","Value_co2_emissions_kt_by_country":312859.9854,"Electricity from fossil fuels (TWh)":145.8,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":24.13},{"Year":2018,"Entity":"Poland","Value_co2_emissions_kt_by_country":311910.0037,"Electricity from fossil fuels (TWh)":147.87,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":21.62},{"Year":2019,"Entity":"Poland","Value_co2_emissions_kt_by_country":295130.0049,"Electricity from fossil fuels (TWh)":137.58,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":25.46},{"Year":2020,"Entity":"Poland","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":128.91,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":28.23},{"Year":2000,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":249660,"Electricity from fossil fuels (TWh)":138.68,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2001,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":254090,"Electricity from fossil fuels (TWh)":146.09,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2002,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":272250,"Electricity from fossil fuels (TWh)":154.91,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2003,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":284829.9866,"Electricity from fossil fuels (TWh)":166.58,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2004,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":299890.0146,"Electricity from fossil fuels (TWh)":173.41,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2005,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":315290.0085,"Electricity from fossil fuels (TWh)":191.05,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2006,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":335440.0024,"Electricity from fossil fuels (TWh)":196.31,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2007,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":354619.9951,"Electricity from fossil fuels (TWh)":204.43,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2008,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":389720.0012,"Electricity from fossil fuels (TWh)":204.2,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2009,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":406529.9988,"Electricity from fossil fuels (TWh)":217.31,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2010,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":446130.0049,"Electricity from fossil fuels (TWh)":240.06,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0},{"Year":2011,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":463769.989,"Electricity from fossil fuels (TWh)":250.07,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.01},{"Year":2012,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":492470.0012,"Electricity from fossil fuels (TWh)":271.68,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.03},{"Year":2013,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":503209.9915,"Electricity from fossil fuels (TWh)":284.02,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.04},{"Year":2014,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":540520.0195,"Electricity from fossil fuels (TWh)":311.81,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.05},{"Year":2015,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":565190.0024,"Electricity from fossil fuels (TWh)":338.34,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.05},{"Year":2016,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":561229.9805,"Electricity from fossil fuels (TWh)":337.38,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.05},{"Year":2017,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":545070.0073,"Electricity from fossil fuels (TWh)":354.3,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.07},{"Year":2018,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":521260.0098,"Electricity from fossil fuels (TWh)":334.7,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.16},{"Year":2019,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":523780.0293,"Electricity from fossil fuels (TWh)":335.24,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.21},{"Year":2020,"Entity":"Saudi Arabia","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":337.82,"Electricity from nuclear (TWh)":null,"Electricity from renewables (TWh)":0.21},{"Year":2000,"Entity":"South Africa","Value_co2_emissions_kt_by_country":284660,"Electricity from fossil fuels (TWh)":181.67,"Electricity from nuclear (TWh)":13.01,"Electricity from renewables (TWh)":1.79},{"Year":2001,"Entity":"South Africa","Value_co2_emissions_kt_by_country":320540,"Electricity from fossil fuels (TWh)":183.36,"Electricity from nuclear (TWh)":10.72,"Electricity from renewables (TWh)":2.46},{"Year":2002,"Entity":"South Africa","Value_co2_emissions_kt_by_country":331320.0073,"Electricity from fossil fuels (TWh)":188.79,"Electricity from nuclear (TWh)":11.99,"Electricity from renewables (TWh)":2.81},{"Year":2003,"Entity":"South Africa","Value_co2_emissions_kt_by_country":353089.9963,"Electricity from fossil fuels (TWh)":204.39,"Electricity from nuclear (TWh)":12.66,"Electricity from renewables (TWh)":1.19},{"Year":2004,"Entity":"South Africa","Value_co2_emissions_kt_by_country":379989.9902,"Electricity from fossil fuels (TWh)":212.63,"Electricity from nuclear (TWh)":14.28,"Electricity from renewables (TWh)":1.33},{"Year":2005,"Entity":"South Africa","Value_co2_emissions_kt_by_country":377649.9939,"Electricity from fossil fuels (TWh)":215.23,"Electricity from nuclear (TWh)":12.24,"Electricity from renewables (TWh)":1.75},{"Year":2006,"Entity":"South Africa","Value_co2_emissions_kt_by_country":379790.0085,"Electricity from fossil fuels (TWh)":223.25,"Electricity from nuclear (TWh)":10.07,"Electricity from renewables (TWh)":3.28},{"Year":2007,"Entity":"South Africa","Value_co2_emissions_kt_by_country":397059.9976,"Electricity from fossil fuels (TWh)":232.91,"Electricity from nuclear (TWh)":12.6,"Electricity from renewables (TWh)":1.3},{"Year":2008,"Entity":"South Africa","Value_co2_emissions_kt_by_country":426739.9902,"Electricity from fossil fuels (TWh)":226.32,"Electricity from nuclear (TWh)":12.75,"Electricity from renewables (TWh)":1.66},{"Year":2009,"Entity":"South Africa","Value_co2_emissions_kt_by_country":404200.0122,"Electricity from fossil fuels (TWh)":218.17,"Electricity from nuclear (TWh)":11.57,"Electricity from renewables (TWh)":1.86},{"Year":2010,"Entity":"South Africa","Value_co2_emissions_kt_by_country":425309.9976,"Electricity from fossil fuels (TWh)":227.57,"Electricity from nuclear (TWh)":12.9,"Electricity from renewables (TWh)":2.51},{"Year":2011,"Entity":"South Africa","Value_co2_emissions_kt_by_country":409260.0098,"Electricity from fossil fuels (TWh)":229.06,"Electricity from nuclear (TWh)":12.94,"Electricity from renewables (TWh)":2.49},{"Year":2012,"Entity":"South Africa","Value_co2_emissions_kt_by_country":426779.9988,"Electricity from fossil fuels (TWh)":226.84,"Electricity from nuclear (TWh)":12.4,"Electricity from renewables (TWh)":1.66},{"Year":2013,"Entity":"South Africa","Value_co2_emissions_kt_by_country":436920.0134,"Electricity from fossil fuels (TWh)":223.28,"Electricity from nuclear (TWh)":13.61,"Electricity from renewables (TWh)":1.62},{"Year":2014,"Entity":"South Africa","Value_co2_emissions_kt_by_country":447929.9927,"Electricity from fossil fuels (TWh)":218.42,"Electricity from nuclear (TWh)":14.76,"Electricity from renewables (TWh)":3.38},{"Year":2015,"Entity":"South Africa","Value_co2_emissions_kt_by_country":424809.9976,"Electricity from fossil fuels (TWh)":214.88,"Electricity from nuclear (TWh)":10.97,"Electricity from renewables (TWh)":6.09},{"Year":2016,"Entity":"South Africa","Value_co2_emissions_kt_by_country":425140.0146,"Electricity from fossil fuels (TWh)":213.09,"Electricity from nuclear (TWh)":15.21,"Electricity from renewables (TWh)":7.69},{"Year":2017,"Entity":"South Africa","Value_co2_emissions_kt_by_country":435649.9939,"Electricity from fossil fuels (TWh)":212.77,"Electricity from nuclear (TWh)":15.09,"Electricity from renewables (TWh)":10.04},{"Year":2018,"Entity":"South Africa","Value_co2_emissions_kt_by_country":434350.0061,"Electricity from fossil fuels (TWh)":214.25,"Electricity from nuclear (TWh)":10.56,"Electricity from renewables (TWh)":12.22},{"Year":2019,"Entity":"South Africa","Value_co2_emissions_kt_by_country":439640.0146,"Electricity from fossil fuels (TWh)":208.39,"Electricity from nuclear (TWh)":13.6,"Electricity from renewables (TWh)":12.57},{"Year":2020,"Entity":"South Africa","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":197.5,"Electricity from nuclear (TWh)":11.62,"Electricity from renewables (TWh)":12.83},{"Year":2000,"Entity":"Spain","Value_co2_emissions_kt_by_country":293310,"Electricity from fossil fuels (TWh)":124.22,"Electricity from nuclear (TWh)":62.21,"Electricity from renewables (TWh)":34.49},{"Year":2001,"Entity":"Spain","Value_co2_emissions_kt_by_country":294790,"Electricity from fossil fuels (TWh)":120.06,"Electricity from nuclear (TWh)":63.71,"Electricity from renewables (TWh)":49.3},{"Year":2002,"Entity":"Spain","Value_co2_emissions_kt_by_country":312750,"Electricity from fossil fuels (TWh)":143.72,"Electricity from nuclear (TWh)":63.02,"Electricity from renewables (TWh)":33.17},{"Year":2003,"Entity":"Spain","Value_co2_emissions_kt_by_country":318660.0037,"Electricity from fossil fuels (TWh)":139.67,"Electricity from nuclear (TWh)":61.88,"Electricity from renewables (TWh)":55.75},{"Year":2004,"Entity":"Spain","Value_co2_emissions_kt_by_country":335559.9976,"Electricity from fossil fuels (TWh)":159.91,"Electricity from nuclear (TWh)":63.61,"Electricity from renewables (TWh)":50.13},{"Year":2005,"Entity":"Spain","Value_co2_emissions_kt_by_country":350500,"Electricity from fossil fuels (TWh)":184.65,"Electricity from nuclear (TWh)":57.54,"Electricity from renewables (TWh)":42.27},{"Year":2006,"Entity":"Spain","Value_co2_emissions_kt_by_country":341779.9988,"Electricity from fossil fuels (TWh)":182.98,"Electricity from nuclear (TWh)":60.13,"Electricity from renewables (TWh)":52.15},{"Year":2007,"Entity":"Spain","Value_co2_emissions_kt_by_country":354679.9927,"Electricity from fossil fuels (TWh)":188.13,"Electricity from nuclear (TWh)":55.1,"Electricity from renewables (TWh)":58.3},{"Year":2008,"Entity":"Spain","Value_co2_emissions_kt_by_country":324269.989,"Electricity from fossil fuels (TWh)":189.55,"Electricity from nuclear (TWh)":58.97,"Electricity from renewables (TWh)":62.15},{"Year":2009,"Entity":"Spain","Value_co2_emissions_kt_by_country":287489.9902,"Electricity from fossil fuels (TWh)":164.69,"Electricity from nuclear (TWh)":52.76,"Electricity from renewables (TWh)":74.08},{"Year":2010,"Entity":"Spain","Value_co2_emissions_kt_by_country":273250,"Electricity from fossil fuels (TWh)":138.39,"Electricity from nuclear (TWh)":61.99,"Electricity from renewables (TWh)":97.77},{"Year":2011,"Entity":"Spain","Value_co2_emissions_kt_by_country":274399.9939,"Electricity from fossil fuels (TWh)":146.12,"Electricity from nuclear (TWh)":57.72,"Electricity from renewables (TWh)":87.53},{"Year":2012,"Entity":"Spain","Value_co2_emissions_kt_by_country":269269.989,"Electricity from fossil fuels (TWh)":145.33,"Electricity from nuclear (TWh)":61.47,"Electricity from renewables (TWh)":86.97},{"Year":2013,"Entity":"Spain","Value_co2_emissions_kt_by_country":242809.9976,"Electricity from fossil fuels (TWh)":113.32,"Electricity from nuclear (TWh)":56.73,"Electricity from renewables (TWh)":111.42},{"Year":2014,"Entity":"Spain","Value_co2_emissions_kt_by_country":240960.0067,"Electricity from fossil fuels (TWh)":107.37,"Electricity from nuclear (TWh)":57.31,"Electricity from renewables (TWh)":110.26},{"Year":2015,"Entity":"Spain","Value_co2_emissions_kt_by_country":256279.9988,"Electricity from fossil fuels (TWh)":123.19,"Electricity from nuclear (TWh)":57.2,"Electricity from renewables (TWh)":97.09},{"Year":2016,"Entity":"Spain","Value_co2_emissions_kt_by_country":247029.9988,"Electricity from fossil fuels (TWh)":107.93,"Electricity from nuclear (TWh)":58.63,"Electricity from renewables (TWh)":104.63},{"Year":2017,"Entity":"Spain","Value_co2_emissions_kt_by_country":263450.0122,"Electricity from fossil fuels (TWh)":126.93,"Electricity from nuclear (TWh)":58.04,"Electricity from renewables (TWh)":87.93},{"Year":2018,"Entity":"Spain","Value_co2_emissions_kt_by_country":257040.0085,"Electricity from fossil fuels (TWh)":112.23,"Electricity from nuclear (TWh)":55.77,"Electricity from renewables (TWh)":103.88},{"Year":2019,"Entity":"Spain","Value_co2_emissions_kt_by_country":239979.9957,"Electricity from fossil fuels (TWh)":111.55,"Electricity from nuclear (TWh)":58.35,"Electricity from renewables (TWh)":100.99},{"Year":2020,"Entity":"Spain","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":87.64,"Electricity from nuclear (TWh)":58.3,"Electricity from renewables (TWh)":113.79},{"Year":2000,"Entity":"Thailand","Value_co2_emissions_kt_by_country":164490,"Electricity from fossil fuels (TWh)":83.15,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":6.38},{"Year":2001,"Entity":"Thailand","Value_co2_emissions_kt_by_country":173160,"Electricity from fossil fuels (TWh)":88.97,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":6.76},{"Year":2002,"Entity":"Thailand","Value_co2_emissions_kt_by_country":184240.0055,"Electricity from fossil fuels (TWh)":93.51,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":8.07},{"Year":2003,"Entity":"Thailand","Value_co2_emissions_kt_by_country":191929.9927,"Electricity from fossil fuels (TWh)":100.61,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":8.36},{"Year":2004,"Entity":"Thailand","Value_co2_emissions_kt_by_country":210190.0024,"Electricity from fossil fuels (TWh)":109.46,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":7.63},{"Year":2005,"Entity":"Thailand","Value_co2_emissions_kt_by_country":217770.0043,"Electricity from fossil fuels (TWh)":115.58,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":7.42},{"Year":2006,"Entity":"Thailand","Value_co2_emissions_kt_by_country":219880.0049,"Electricity from fossil fuels (TWh)":119.41,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":9.82},{"Year":2007,"Entity":"Thailand","Value_co2_emissions_kt_by_country":224589.9963,"Electricity from fossil fuels (TWh)":122.12,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":10.2},{"Year":2008,"Entity":"Thailand","Value_co2_emissions_kt_by_country":227580.0018,"Electricity from fossil fuels (TWh)":127.43,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":8.95},{"Year":2009,"Entity":"Thailand","Value_co2_emissions_kt_by_country":220259.9945,"Electricity from fossil fuels (TWh)":128.09,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":9.09},{"Year":2010,"Entity":"Thailand","Value_co2_emissions_kt_by_country":234380.0049,"Electricity from fossil fuels (TWh)":141.72,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":8.58},{"Year":2011,"Entity":"Thailand","Value_co2_emissions_kt_by_country":233600.0061,"Electricity from fossil fuels (TWh)":135.31,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":11.83},{"Year":2012,"Entity":"Thailand","Value_co2_emissions_kt_by_country":250679.9927,"Electricity from fossil fuels (TWh)":143.73,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":13.42},{"Year":2013,"Entity":"Thailand","Value_co2_emissions_kt_by_country":260700.0122,"Electricity from fossil fuels (TWh)":148.29,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":12.33},{"Year":2014,"Entity":"Thailand","Value_co2_emissions_kt_by_country":256799.9878,"Electricity from fossil fuels (TWh)":149.26,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":13.68},{"Year":2015,"Entity":"Thailand","Value_co2_emissions_kt_by_country":264000,"Electricity from fossil fuels (TWh)":153.4,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":13.33},{"Year":2016,"Entity":"Thailand","Value_co2_emissions_kt_by_country":261600.0061,"Electricity from fossil fuels (TWh)":161.79,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":15.97},{"Year":2017,"Entity":"Thailand","Value_co2_emissions_kt_by_country":258820.0073,"Electricity from fossil fuels (TWh)":161.88,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":19.92},{"Year":2018,"Entity":"Thailand","Value_co2_emissions_kt_by_country":257049.9878,"Electricity from fossil fuels (TWh)":156.26,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":25.84},{"Year":2019,"Entity":"Thailand","Value_co2_emissions_kt_by_country":267089.9963,"Electricity from fossil fuels (TWh)":162.59,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":28.02},{"Year":2020,"Entity":"Thailand","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":154.52,"Electricity from nuclear (TWh)":0,"Electricity from renewables (TWh)":24.73},{"Year":2000,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":297380,"Electricity from fossil fuels (TWh)":82.65,"Electricity from nuclear (TWh)":77.34,"Electricity from renewables (TWh)":11.28},{"Year":2001,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":300550,"Electricity from fossil fuels (TWh)":84.59,"Electricity from nuclear (TWh)":76.17,"Electricity from renewables (TWh)":12.05},{"Year":2002,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":303940.0024,"Electricity from fossil fuels (TWh)":85.93,"Electricity from nuclear (TWh)":77.99,"Electricity from renewables (TWh)":9.65},{"Year":2003,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":330230.011,"Electricity from fossil fuels (TWh)":89.52,"Electricity from nuclear (TWh)":81.41,"Electricity from renewables (TWh)":9.27},{"Year":2004,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":307140.0146,"Electricity from fossil fuels (TWh)":83.22,"Electricity from nuclear (TWh)":87.02,"Electricity from renewables (TWh)":11.78},{"Year":2005,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":295410.0037,"Electricity from fossil fuels (TWh)":84.75,"Electricity from nuclear (TWh)":88.76,"Electricity from renewables (TWh)":12.4},{"Year":2006,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":303989.9902,"Electricity from fossil fuels (TWh)":90.09,"Electricity from nuclear (TWh)":90.22,"Electricity from renewables (TWh)":12.92},{"Year":2007,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":312140.0146,"Electricity from fossil fuels (TWh)":93.13,"Electricity from nuclear (TWh)":92.54,"Electricity from renewables (TWh)":10.47},{"Year":2008,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":301200.0122,"Electricity from fossil fuels (TWh)":90.92,"Electricity from nuclear (TWh)":89.84,"Electricity from renewables (TWh)":11.82},{"Year":2009,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":251619.9951,"Electricity from fossil fuels (TWh)":78.58,"Electricity from nuclear (TWh)":82.92,"Electricity from renewables (TWh)":12.12},{"Year":2010,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":268920.0134,"Electricity from fossil fuels (TWh)":86.28,"Electricity from nuclear (TWh)":89.15,"Electricity from renewables (TWh)":13.39},{"Year":2011,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":283339.9963,"Electricity from fossil fuels (TWh)":93.5,"Electricity from nuclear (TWh)":90.25,"Electricity from renewables (TWh)":11.2},{"Year":2012,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":277109.9854,"Electricity from fossil fuels (TWh)":96.99,"Electricity from nuclear (TWh)":90.14,"Electricity from renewables (TWh)":11.23},{"Year":2013,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":270269.989,"Electricity from fossil fuels (TWh)":95.39,"Electricity from nuclear (TWh)":83.21,"Electricity from renewables (TWh)":15.11},{"Year":2014,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":237729.9957,"Electricity from fossil fuels (TWh)":83.42,"Electricity from nuclear (TWh)":88.39,"Electricity from renewables (TWh)":10.17},{"Year":2015,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":191070.0073,"Electricity from fossil fuels (TWh)":66.91,"Electricity from nuclear (TWh)":87.63,"Electricity from renewables (TWh)":7.1},{"Year":2016,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":201660.0037,"Electricity from fossil fuels (TWh)":72.66,"Electricity from nuclear (TWh)":80.95,"Electricity from renewables (TWh)":9.25},{"Year":2017,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":174940.0024,"Electricity from fossil fuels (TWh)":57.96,"Electricity from nuclear (TWh)":85.58,"Electricity from renewables (TWh)":10.88},{"Year":2018,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":185619.9951,"Electricity from fossil fuels (TWh)":60.81,"Electricity from nuclear (TWh)":84.4,"Electricity from renewables (TWh)":13.02},{"Year":2019,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":174729.9957,"Electricity from fossil fuels (TWh)":57.79,"Electricity from nuclear (TWh)":83,"Electricity from renewables (TWh)":11.87},{"Year":2020,"Entity":"Ukraine","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":54.5,"Electricity from nuclear (TWh)":76.2,"Electricity from renewables (TWh)":17.56},{"Year":2000,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":530890,"Electricity from fossil fuels (TWh)":279.34,"Electricity from nuclear (TWh)":85.06,"Electricity from renewables (TWh)":9.98},{"Year":2001,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":545260,"Electricity from fossil fuels (TWh)":282.72,"Electricity from nuclear (TWh)":90.09,"Electricity from renewables (TWh)":9.56},{"Year":2002,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":530789.978,"Electricity from fossil fuels (TWh)":285.62,"Electricity from nuclear (TWh)":87.85,"Electricity from renewables (TWh)":11.13},{"Year":2003,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":543039.978,"Electricity from fossil fuels (TWh)":296.15,"Electricity from nuclear (TWh)":88.69,"Electricity from renewables (TWh)":10.62},{"Year":2004,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":543080.0171,"Electricity from fossil fuels (TWh)":297.15,"Electricity from nuclear (TWh)":80,"Electricity from renewables (TWh)":14.14},{"Year":2005,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":540919.9829,"Electricity from fossil fuels (TWh)":296.87,"Electricity from nuclear (TWh)":81.62,"Electricity from renewables (TWh)":16.93},{"Year":2006,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":542059.9976,"Electricity from fossil fuels (TWh)":299.88,"Electricity from nuclear (TWh)":75.45,"Electricity from renewables (TWh)":18.11},{"Year":2007,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":530500,"Electricity from fossil fuels (TWh)":310.26,"Electricity from nuclear (TWh)":63.03,"Electricity from renewables (TWh)":19.69},{"Year":2008,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":515340.0269,"Electricity from fossil fuels (TWh)":310.5,"Electricity from nuclear (TWh)":52.49,"Electricity from renewables (TWh)":21.85},{"Year":2009,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":466489.9902,"Electricity from fossil fuels (TWh)":278.73,"Electricity from nuclear (TWh)":69.1,"Electricity from renewables (TWh)":25.25},{"Year":2010,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":482440.0024,"Electricity from fossil fuels (TWh)":290.59,"Electricity from nuclear (TWh)":62.14,"Electricity from renewables (TWh)":26.18},{"Year":2011,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":445589.9963,"Electricity from fossil fuels (TWh)":260.88,"Electricity from nuclear (TWh)":68.98,"Electricity from renewables (TWh)":35.2},{"Year":2012,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":467779.9988,"Electricity from fossil fuels (TWh)":249.25,"Electricity from nuclear (TWh)":70.4,"Electricity from renewables (TWh)":41.24},{"Year":2013,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":453760.0098,"Electricity from fossil fuels (TWh)":231.56,"Electricity from nuclear (TWh)":70.61,"Electricity from renewables (TWh)":53.21},{"Year":2014,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":415600.0061,"Electricity from fossil fuels (TWh)":206.94,"Electricity from nuclear (TWh)":63.75,"Electricity from renewables (TWh)":64.52},{"Year":2015,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":401079.9866,"Electricity from fossil fuels (TWh)":182.43,"Electricity from nuclear (TWh)":70.34,"Electricity from renewables (TWh)":82.57},{"Year":2016,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":380809.9976,"Electricity from fossil fuels (TWh)":181.56,"Electricity from nuclear (TWh)":71.73,"Electricity from renewables (TWh)":82.99},{"Year":2017,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":367000,"Electricity from fossil fuels (TWh)":165.91,"Electricity from nuclear (TWh)":70.34,"Electricity from renewables (TWh)":98.85},{"Year":2018,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":360730.011,"Electricity from fossil fuels (TWh)":155.41,"Electricity from nuclear (TWh)":65.06,"Electricity from renewables (TWh)":110.03},{"Year":2019,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":348920.0134,"Electricity from fossil fuels (TWh)":144.99,"Electricity from nuclear (TWh)":56.18,"Electricity from renewables (TWh)":120.48},{"Year":2020,"Entity":"United Kingdom","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":124.78,"Electricity from nuclear (TWh)":50.85,"Electricity from renewables (TWh)":131.74},{"Year":2000,"Entity":"United States","Value_co2_emissions_kt_by_country":5775810,"Electricity from fossil fuels (TWh)":2697.28,"Electricity from nuclear (TWh)":753.89,"Electricity from renewables (TWh)":350.93},{"Year":2001,"Entity":"United States","Value_co2_emissions_kt_by_country":5748260,"Electricity from fossil fuels (TWh)":2678.68,"Electricity from nuclear (TWh)":768.83,"Electricity from renewables (TWh)":280.06},{"Year":2002,"Entity":"United States","Value_co2_emissions_kt_by_country":5593029.785,"Electricity from fossil fuels (TWh)":2727.83,"Electricity from nuclear (TWh)":780.06,"Electricity from renewables (TWh)":336.34},{"Year":2003,"Entity":"United States","Value_co2_emissions_kt_by_country":5658990.234,"Electricity from fossil fuels (TWh)":2756.03,"Electricity from nuclear (TWh)":763.73,"Electricity from renewables (TWh)":349.18},{"Year":2004,"Entity":"United States","Value_co2_emissions_kt_by_country":5738290.039,"Electricity from fossil fuels (TWh)":2818.28,"Electricity from nuclear (TWh)":788.53,"Electricity from renewables (TWh)":345.14},{"Year":2005,"Entity":"United States","Value_co2_emissions_kt_by_country":5753490.234,"Electricity from fossil fuels (TWh)":2899.96,"Electricity from nuclear (TWh)":781.99,"Electricity from renewables (TWh)":353.04},{"Year":2006,"Entity":"United States","Value_co2_emissions_kt_by_country":5653080.078,"Electricity from fossil fuels (TWh)":2878.56,"Electricity from nuclear (TWh)":787.22,"Electricity from renewables (TWh)":381.16},{"Year":2007,"Entity":"United States","Value_co2_emissions_kt_by_country":5736319.824,"Electricity from fossil fuels (TWh)":2988.24,"Electricity from nuclear (TWh)":806.42,"Electricity from renewables (TWh)":347.91},{"Year":2008,"Entity":"United States","Value_co2_emissions_kt_by_country":5558379.883,"Electricity from fossil fuels (TWh)":2924.21,"Electricity from nuclear (TWh)":806.21,"Electricity from renewables (TWh)":377.11},{"Year":2009,"Entity":"United States","Value_co2_emissions_kt_by_country":5156430.176,"Electricity from fossil fuels (TWh)":2725.41,"Electricity from nuclear (TWh)":798.85,"Electricity from renewables (TWh)":415.56},{"Year":2010,"Entity":"United States","Value_co2_emissions_kt_by_country":5392109.863,"Electricity from fossil fuels (TWh)":2882.49,"Electricity from nuclear (TWh)":806.97,"Electricity from renewables (TWh)":424.48},{"Year":2011,"Entity":"United States","Value_co2_emissions_kt_by_country":5173600.098,"Electricity from fossil fuels (TWh)":2788.93,"Electricity from nuclear (TWh)":790.2,"Electricity from renewables (TWh)":509.74},{"Year":2012,"Entity":"United States","Value_co2_emissions_kt_by_country":4956060.059,"Electricity from fossil fuels (TWh)":2779.02,"Electricity from nuclear (TWh)":769.33,"Electricity from renewables (TWh)":492.32},{"Year":2013,"Entity":"United States","Value_co2_emissions_kt_by_country":5092100.098,"Electricity from fossil fuels (TWh)":2746.21,"Electricity from nuclear (TWh)":789.02,"Electricity from renewables (TWh)":520.38},{"Year":2014,"Entity":"United States","Value_co2_emissions_kt_by_country":5107209.961,"Electricity from fossil fuels (TWh)":2752.01,"Electricity from nuclear (TWh)":797.17,"Electricity from renewables (TWh)":546.83},{"Year":2015,"Entity":"United States","Value_co2_emissions_kt_by_country":4990709.961,"Electricity from fossil fuels (TWh)":2730.32,"Electricity from nuclear (TWh)":797.18,"Electricity from renewables (TWh)":556.49},{"Year":2016,"Entity":"United States","Value_co2_emissions_kt_by_country":4894500,"Electricity from fossil fuels (TWh)":2656.96,"Electricity from nuclear (TWh)":805.69,"Electricity from renewables (TWh)":624.91},{"Year":2017,"Entity":"United States","Value_co2_emissions_kt_by_country":4819370.117,"Electricity from fossil fuels (TWh)":2540.17,"Electricity from nuclear (TWh)":804.95,"Electricity from renewables (TWh)":707.19},{"Year":2018,"Entity":"United States","Value_co2_emissions_kt_by_country":4975310.059,"Electricity from fossil fuels (TWh)":2661.3,"Electricity from nuclear (TWh)":807.08,"Electricity from renewables (TWh)":733.17},{"Year":2019,"Entity":"United States","Value_co2_emissions_kt_by_country":4817720.215,"Electricity from fossil fuels (TWh)":2588.21,"Electricity from nuclear (TWh)":809.41,"Electricity from renewables (TWh)":760.76},{"Year":2020,"Entity":"United States","Value_co2_emissions_kt_by_country":null,"Electricity from fossil fuels (TWh)":2431.9,"Electricity from nuclear (TWh)":789.88,"Electricity from renewables (TWh)":821.4}],"anchored":true,"createdBy":"user","attachedMetadata":""},{"id":"table-82","displayId":"energy-source","names":["Entity","Year","energy","source"],"rows":[{"Entity":"Australia","Year":2000,"energy":181.05,"source":"fossil fuels"},{"Entity":"Australia","Year":2001,"energy":194.33,"source":"fossil fuels"},{"Entity":"Australia","Year":2002,"energy":197.29,"source":"fossil fuels"},{"Entity":"Australia","Year":2003,"energy":195.13,"source":"fossil fuels"},{"Entity":"Australia","Year":2004,"energy":203.66,"source":"fossil fuels"},{"Entity":"Australia","Year":2005,"energy":195.95,"source":"fossil fuels"},{"Entity":"Australia","Year":2006,"energy":198.72,"source":"fossil fuels"},{"Entity":"Australia","Year":2007,"energy":208.59,"source":"fossil fuels"},{"Entity":"Australia","Year":2008,"energy":211.06,"source":"fossil fuels"},{"Entity":"Australia","Year":2009,"energy":216.42,"source":"fossil fuels"},{"Entity":"Australia","Year":2010,"energy":212.5,"source":"fossil fuels"},{"Entity":"Australia","Year":2011,"energy":213.56,"source":"fossil fuels"},{"Entity":"Australia","Year":2012,"energy":206.75,"source":"fossil fuels"},{"Entity":"Australia","Year":2013,"energy":195.78,"source":"fossil fuels"},{"Entity":"Australia","Year":2014,"energy":205.46,"source":"fossil fuels"},{"Entity":"Australia","Year":2015,"energy":197.72,"source":"fossil fuels"},{"Entity":"Australia","Year":2016,"energy":207.66,"source":"fossil fuels"},{"Entity":"Australia","Year":2017,"energy":209.14,"source":"fossil fuels"},{"Entity":"Australia","Year":2018,"energy":207.45,"source":"fossil fuels"},{"Entity":"Australia","Year":2019,"energy":196.45,"source":"fossil fuels"},{"Entity":"Australia","Year":2020,"energy":186.92,"source":"fossil fuels"},{"Entity":"Brazil","Year":2000,"energy":28.87,"source":"fossil fuels"},{"Entity":"Brazil","Year":2001,"energy":35.19,"source":"fossil fuels"},{"Entity":"Brazil","Year":2002,"energy":33.5,"source":"fossil fuels"},{"Entity":"Brazil","Year":2003,"energy":31.62,"source":"fossil fuels"},{"Entity":"Brazil","Year":2004,"energy":40.14,"source":"fossil fuels"},{"Entity":"Brazil","Year":2005,"energy":39.56,"source":"fossil fuels"},{"Entity":"Brazil","Year":2006,"energy":39.4,"source":"fossil fuels"},{"Entity":"Brazil","Year":2007,"energy":37.64,"source":"fossil fuels"},{"Entity":"Brazil","Year":2008,"energy":55.87,"source":"fossil fuels"},{"Entity":"Brazil","Year":2009,"energy":36.32,"source":"fossil fuels"},{"Entity":"Brazil","Year":2010,"energy":61.02,"source":"fossil fuels"},{"Entity":"Brazil","Year":2011,"energy":50.27,"source":"fossil fuels"},{"Entity":"Brazil","Year":2012,"energy":77.21,"source":"fossil fuels"},{"Entity":"Brazil","Year":2013,"energy":112,"source":"fossil fuels"},{"Entity":"Brazil","Year":2014,"energy":136.58,"source":"fossil fuels"},{"Entity":"Brazil","Year":2015,"energy":128.85,"source":"fossil fuels"},{"Entity":"Brazil","Year":2016,"energy":93.06,"source":"fossil fuels"},{"Entity":"Brazil","Year":2017,"energy":101.9,"source":"fossil fuels"},{"Entity":"Brazil","Year":2018,"energy":86.69,"source":"fossil fuels"},{"Entity":"Brazil","Year":2019,"energy":90.91,"source":"fossil fuels"},{"Entity":"Brazil","Year":2020,"energy":81.15,"source":"fossil fuels"},{"Entity":"Canada","Year":2000,"energy":155.56,"source":"fossil fuels"},{"Entity":"Canada","Year":2001,"energy":159.93,"source":"fossil fuels"},{"Entity":"Canada","Year":2002,"energy":155.12,"source":"fossil fuels"},{"Entity":"Canada","Year":2003,"energy":157.35,"source":"fossil fuels"},{"Entity":"Canada","Year":2004,"energy":148.86,"source":"fossil fuels"},{"Entity":"Canada","Year":2005,"energy":150.78,"source":"fossil fuels"},{"Entity":"Canada","Year":2006,"energy":139.71,"source":"fossil fuels"},{"Entity":"Canada","Year":2007,"energy":149.36,"source":"fossil fuels"},{"Entity":"Canada","Year":2008,"energy":141.33,"source":"fossil fuels"},{"Entity":"Canada","Year":2009,"energy":129.76,"source":"fossil fuels"},{"Entity":"Canada","Year":2010,"energy":130.08,"source":"fossil fuels"},{"Entity":"Canada","Year":2011,"energy":131.3,"source":"fossil fuels"},{"Entity":"Canada","Year":2012,"energy":124.2,"source":"fossil fuels"},{"Entity":"Canada","Year":2013,"energy":122.87,"source":"fossil fuels"},{"Entity":"Canada","Year":2014,"energy":122.75,"source":"fossil fuels"},{"Entity":"Canada","Year":2015,"energy":125.7,"source":"fossil fuels"},{"Entity":"Canada","Year":2016,"energy":122.35,"source":"fossil fuels"},{"Entity":"Canada","Year":2017,"energy":113.7,"source":"fossil fuels"},{"Entity":"Canada","Year":2018,"energy":112.47,"source":"fossil fuels"},{"Entity":"Canada","Year":2019,"energy":110.65,"source":"fossil fuels"},{"Entity":"Canada","Year":2020,"energy":102.19,"source":"fossil fuels"},{"Entity":"China","Year":2000,"energy":1113.3,"source":"fossil fuels"},{"Entity":"China","Year":2001,"energy":1182.59,"source":"fossil fuels"},{"Entity":"China","Year":2002,"energy":1337.46,"source":"fossil fuels"},{"Entity":"China","Year":2003,"energy":1579.96,"source":"fossil fuels"},{"Entity":"China","Year":2004,"energy":1795.41,"source":"fossil fuels"},{"Entity":"China","Year":2005,"energy":2042.8,"source":"fossil fuels"},{"Entity":"China","Year":2006,"energy":2364.16,"source":"fossil fuels"},{"Entity":"China","Year":2007,"energy":2718.7,"source":"fossil fuels"},{"Entity":"China","Year":2008,"energy":2762.29,"source":"fossil fuels"},{"Entity":"China","Year":2009,"energy":2980.2,"source":"fossil fuels"},{"Entity":"China","Year":2010,"energy":3326.19,"source":"fossil fuels"},{"Entity":"China","Year":2011,"energy":3811.77,"source":"fossil fuels"},{"Entity":"China","Year":2012,"energy":3869.38,"source":"fossil fuels"},{"Entity":"China","Year":2013,"energy":4203.77,"source":"fossil fuels"},{"Entity":"China","Year":2014,"energy":4345.86,"source":"fossil fuels"},{"Entity":"China","Year":2015,"energy":4222.76,"source":"fossil fuels"},{"Entity":"China","Year":2016,"energy":4355,"source":"fossil fuels"},{"Entity":"China","Year":2017,"energy":4643.1,"source":"fossil fuels"},{"Entity":"China","Year":2018,"energy":4990.28,"source":"fossil fuels"},{"Entity":"China","Year":2019,"energy":5098.22,"source":"fossil fuels"},{"Entity":"China","Year":2020,"energy":5184.13,"source":"fossil fuels"},{"Entity":"France","Year":2000,"energy":50.61,"source":"fossil fuels"},{"Entity":"France","Year":2001,"energy":46.48,"source":"fossil fuels"},{"Entity":"France","Year":2002,"energy":52.67,"source":"fossil fuels"},{"Entity":"France","Year":2003,"energy":57.38,"source":"fossil fuels"},{"Entity":"France","Year":2004,"energy":56.53,"source":"fossil fuels"},{"Entity":"France","Year":2005,"energy":63.35,"source":"fossil fuels"},{"Entity":"France","Year":2006,"energy":56.9,"source":"fossil fuels"},{"Entity":"France","Year":2007,"energy":58.18,"source":"fossil fuels"},{"Entity":"France","Year":2008,"energy":55.57,"source":"fossil fuels"},{"Entity":"France","Year":2009,"energy":51.32,"source":"fossil fuels"},{"Entity":"France","Year":2010,"energy":57.63,"source":"fossil fuels"},{"Entity":"France","Year":2011,"energy":58.99,"source":"fossil fuels"},{"Entity":"France","Year":2012,"energy":56.42,"source":"fossil fuels"},{"Entity":"France","Year":2013,"energy":53.35,"source":"fossil fuels"},{"Entity":"France","Year":2014,"energy":35.68,"source":"fossil fuels"},{"Entity":"France","Year":2015,"energy":44.65,"source":"fossil fuels"},{"Entity":"France","Year":2016,"energy":56.45,"source":"fossil fuels"},{"Entity":"France","Year":2017,"energy":65.09,"source":"fossil fuels"},{"Entity":"France","Year":2018,"energy":49.27,"source":"fossil fuels"},{"Entity":"France","Year":2019,"energy":53.5,"source":"fossil fuels"},{"Entity":"France","Year":2020,"energy":48.14,"source":"fossil fuels"},{"Entity":"Germany","Year":2000,"energy":367.22,"source":"fossil fuels"},{"Entity":"Germany","Year":2001,"energy":372.69,"source":"fossil fuels"},{"Entity":"Germany","Year":2002,"energy":372.64,"source":"fossil fuels"},{"Entity":"Germany","Year":2003,"energy":390.81,"source":"fossil fuels"},{"Entity":"Germany","Year":2004,"energy":385.24,"source":"fossil fuels"},{"Entity":"Germany","Year":2005,"energy":386.96,"source":"fossil fuels"},{"Entity":"Germany","Year":2006,"energy":390.03,"source":"fossil fuels"},{"Entity":"Germany","Year":2007,"energy":402.4,"source":"fossil fuels"},{"Entity":"Germany","Year":2008,"energy":390.43,"source":"fossil fuels"},{"Entity":"Germany","Year":2009,"energy":358.07,"source":"fossil fuels"},{"Entity":"Germany","Year":2010,"energy":378.9,"source":"fossil fuels"},{"Entity":"Germany","Year":2011,"energy":373.16,"source":"fossil fuels"},{"Entity":"Germany","Year":2012,"energy":377.89,"source":"fossil fuels"},{"Entity":"Germany","Year":2013,"energy":381.52,"source":"fossil fuels"},{"Entity":"Germany","Year":2014,"energy":360.28,"source":"fossil fuels"},{"Entity":"Germany","Year":2015,"energy":359.99,"source":"fossil fuels"},{"Entity":"Germany","Year":2016,"energy":368.67,"source":"fossil fuels"},{"Entity":"Germany","Year":2017,"energy":353.37,"source":"fossil fuels"},{"Entity":"Germany","Year":2018,"energy":334.65,"source":"fossil fuels"},{"Entity":"Germany","Year":2019,"energy":284.09,"source":"fossil fuels"},{"Entity":"Germany","Year":2020,"energy":251.4,"source":"fossil fuels"},{"Entity":"India","Year":2000,"energy":475.35,"source":"fossil fuels"},{"Entity":"India","Year":2001,"energy":491.01,"source":"fossil fuels"},{"Entity":"India","Year":2002,"energy":517.51,"source":"fossil fuels"},{"Entity":"India","Year":2003,"energy":545.36,"source":"fossil fuels"},{"Entity":"India","Year":2004,"energy":567.86,"source":"fossil fuels"},{"Entity":"India","Year":2005,"energy":579.32,"source":"fossil fuels"},{"Entity":"India","Year":2006,"energy":599.24,"source":"fossil fuels"},{"Entity":"India","Year":2007,"energy":636.68,"source":"fossil fuels"},{"Entity":"India","Year":2008,"energy":674.27,"source":"fossil fuels"},{"Entity":"India","Year":2009,"energy":728.56,"source":"fossil fuels"},{"Entity":"India","Year":2010,"energy":771.78,"source":"fossil fuels"},{"Entity":"India","Year":2011,"energy":828.16,"source":"fossil fuels"},{"Entity":"India","Year":2012,"energy":893.45,"source":"fossil fuels"},{"Entity":"India","Year":2013,"energy":924.93,"source":"fossil fuels"},{"Entity":"India","Year":2014,"energy":1025.29,"source":"fossil fuels"},{"Entity":"India","Year":2015,"energy":1080.44,"source":"fossil fuels"},{"Entity":"India","Year":2016,"energy":1155.52,"source":"fossil fuels"},{"Entity":"India","Year":2017,"energy":1198.85,"source":"fossil fuels"},{"Entity":"India","Year":2018,"energy":1276.32,"source":"fossil fuels"},{"Entity":"India","Year":2019,"energy":1273.59,"source":"fossil fuels"},{"Entity":"India","Year":2020,"energy":1202.34,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2000,"energy":78.43,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2001,"energy":83.96,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2002,"energy":92.03,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2003,"energy":97.57,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2004,"energy":103.8,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2005,"energy":110.22,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2006,"energy":116.8,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2007,"energy":124.1,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2008,"energy":129.55,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2009,"energy":136.05,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2010,"energy":142.88,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2011,"energy":161.41,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2012,"energy":177.83,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2013,"energy":189.66,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2014,"energy":203.11,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2015,"energy":209.71,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2016,"energy":217.97,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2017,"energy":222.64,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2018,"energy":235.41,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2019,"energy":247.39,"source":"fossil fuels"},{"Entity":"Indonesia","Year":2020,"energy":238.91,"source":"fossil fuels"},{"Entity":"Italy","Year":2000,"energy":218.28,"source":"fossil fuels"},{"Entity":"Italy","Year":2001,"energy":216.73,"source":"fossil fuels"},{"Entity":"Italy","Year":2002,"energy":228.45,"source":"fossil fuels"},{"Entity":"Italy","Year":2003,"energy":238.52,"source":"fossil fuels"},{"Entity":"Italy","Year":2004,"energy":240.95,"source":"fossil fuels"},{"Entity":"Italy","Year":2005,"energy":247.29,"source":"fossil fuels"},{"Entity":"Italy","Year":2006,"energy":256.03,"source":"fossil fuels"},{"Entity":"Italy","Year":2007,"energy":259.49,"source":"fossil fuels"},{"Entity":"Italy","Year":2008,"energy":254.34,"source":"fossil fuels"},{"Entity":"Italy","Year":2009,"energy":218.32,"source":"fossil fuels"},{"Entity":"Italy","Year":2010,"energy":220.93,"source":"fossil fuels"},{"Entity":"Italy","Year":2011,"energy":216.78,"source":"fossil fuels"},{"Entity":"Italy","Year":2012,"energy":204.26,"source":"fossil fuels"},{"Entity":"Italy","Year":2013,"energy":175.07,"source":"fossil fuels"},{"Entity":"Italy","Year":2014,"energy":156.76,"source":"fossil fuels"},{"Entity":"Italy","Year":2015,"energy":172.06,"source":"fossil fuels"},{"Entity":"Italy","Year":2016,"energy":179.19,"source":"fossil fuels"},{"Entity":"Italy","Year":2017,"energy":189.44,"source":"fossil fuels"},{"Entity":"Italy","Year":2018,"energy":172.98,"source":"fossil fuels"},{"Entity":"Italy","Year":2019,"energy":175.52,"source":"fossil fuels"},{"Entity":"Italy","Year":2020,"energy":161.17,"source":"fossil fuels"},{"Entity":"Japan","Year":2000,"energy":578.29,"source":"fossil fuels"},{"Entity":"Japan","Year":2001,"energy":564.95,"source":"fossil fuels"},{"Entity":"Japan","Year":2002,"energy":605.12,"source":"fossil fuels"},{"Entity":"Japan","Year":2003,"energy":633.76,"source":"fossil fuels"},{"Entity":"Japan","Year":2004,"energy":621.6,"source":"fossil fuels"},{"Entity":"Japan","Year":2005,"energy":634.09,"source":"fossil fuels"},{"Entity":"Japan","Year":2006,"energy":628.77,"source":"fossil fuels"},{"Entity":"Japan","Year":2007,"energy":705.37,"source":"fossil fuels"},{"Entity":"Japan","Year":2008,"energy":663.88,"source":"fossil fuels"},{"Entity":"Japan","Year":2009,"energy":611.86,"source":"fossil fuels"},{"Entity":"Japan","Year":2010,"energy":689.89,"source":"fossil fuels"},{"Entity":"Japan","Year":2011,"energy":777.1,"source":"fossil fuels"},{"Entity":"Japan","Year":2012,"energy":920.39,"source":"fossil fuels"},{"Entity":"Japan","Year":2013,"energy":897.88,"source":"fossil fuels"},{"Entity":"Japan","Year":2014,"energy":892.18,"source":"fossil fuels"},{"Entity":"Japan","Year":2015,"energy":844.23,"source":"fossil fuels"},{"Entity":"Japan","Year":2016,"energy":832.4,"source":"fossil fuels"},{"Entity":"Japan","Year":2017,"energy":806.12,"source":"fossil fuels"},{"Entity":"Japan","Year":2018,"energy":780.61,"source":"fossil fuels"},{"Entity":"Japan","Year":2019,"energy":735.66,"source":"fossil fuels"},{"Entity":"Japan","Year":2020,"energy":716.67,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2000,"energy":44.11,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2001,"energy":47.3,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2002,"energy":49.44,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2003,"energy":55.24,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2004,"energy":58.89,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2005,"energy":60.06,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2006,"energy":63.89,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2007,"energy":68.45,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2008,"energy":72.89,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2009,"energy":71.85,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2010,"energy":74.63,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2011,"energy":78.7,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2012,"energy":82.98,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2013,"energy":84.88,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2014,"energy":86.37,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2015,"energy":82.2,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2016,"energy":82.65,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2017,"energy":91.48,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2018,"energy":96.36,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2019,"energy":95.39,"source":"fossil fuels"},{"Entity":"Kazakhstan","Year":2020,"energy":96.7,"source":"fossil fuels"},{"Entity":"Mexico","Year":2000,"energy":141.8,"source":"fossil fuels"},{"Entity":"Mexico","Year":2001,"energy":153.32,"source":"fossil fuels"},{"Entity":"Mexico","Year":2002,"energy":159.81,"source":"fossil fuels"},{"Entity":"Mexico","Year":2003,"energy":160.45,"source":"fossil fuels"},{"Entity":"Mexico","Year":2004,"energy":173.66,"source":"fossil fuels"},{"Entity":"Mexico","Year":2005,"energy":178.76,"source":"fossil fuels"},{"Entity":"Mexico","Year":2006,"energy":182.76,"source":"fossil fuels"},{"Entity":"Mexico","Year":2007,"energy":191.83,"source":"fossil fuels"},{"Entity":"Mexico","Year":2008,"energy":184.51,"source":"fossil fuels"},{"Entity":"Mexico","Year":2009,"energy":194.75,"source":"fossil fuels"},{"Entity":"Mexico","Year":2010,"energy":207.38,"source":"fossil fuels"},{"Entity":"Mexico","Year":2011,"energy":219.88,"source":"fossil fuels"},{"Entity":"Mexico","Year":2012,"energy":229.14,"source":"fossil fuels"},{"Entity":"Mexico","Year":2013,"energy":231.23,"source":"fossil fuels"},{"Entity":"Mexico","Year":2014,"energy":223.43,"source":"fossil fuels"},{"Entity":"Mexico","Year":2015,"energy":234.28,"source":"fossil fuels"},{"Entity":"Mexico","Year":2016,"energy":239.78,"source":"fossil fuels"},{"Entity":"Mexico","Year":2017,"energy":242.69,"source":"fossil fuels"},{"Entity":"Mexico","Year":2018,"energy":259.92,"source":"fossil fuels"},{"Entity":"Mexico","Year":2019,"energy":248.2,"source":"fossil fuels"},{"Entity":"Mexico","Year":2020,"energy":245.46,"source":"fossil fuels"},{"Entity":"Poland","Year":2000,"energy":140.85,"source":"fossil fuels"},{"Entity":"Poland","Year":2001,"energy":140.94,"source":"fossil fuels"},{"Entity":"Poland","Year":2002,"energy":139.72,"source":"fossil fuels"},{"Entity":"Poland","Year":2003,"energy":147.76,"source":"fossil fuels"},{"Entity":"Poland","Year":2004,"energy":149.06,"source":"fossil fuels"},{"Entity":"Poland","Year":2005,"energy":151.2,"source":"fossil fuels"},{"Entity":"Poland","Year":2006,"energy":156.16,"source":"fossil fuels"},{"Entity":"Poland","Year":2007,"energy":153.08,"source":"fossil fuels"},{"Entity":"Poland","Year":2008,"energy":148.03,"source":"fossil fuels"},{"Entity":"Poland","Year":2009,"energy":142.4,"source":"fossil fuels"},{"Entity":"Poland","Year":2010,"energy":146.12,"source":"fossil fuels"},{"Entity":"Poland","Year":2011,"energy":149.88,"source":"fossil fuels"},{"Entity":"Poland","Year":2012,"energy":144.75,"source":"fossil fuels"},{"Entity":"Poland","Year":2013,"energy":146.85,"source":"fossil fuels"},{"Entity":"Poland","Year":2014,"energy":138.53,"source":"fossil fuels"},{"Entity":"Poland","Year":2015,"energy":141.55,"source":"fossil fuels"},{"Entity":"Poland","Year":2016,"energy":143.28,"source":"fossil fuels"},{"Entity":"Poland","Year":2017,"energy":145.8,"source":"fossil fuels"},{"Entity":"Poland","Year":2018,"energy":147.87,"source":"fossil fuels"},{"Entity":"Poland","Year":2019,"energy":137.58,"source":"fossil fuels"},{"Entity":"Poland","Year":2020,"energy":128.91,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2000,"energy":138.68,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2001,"energy":146.09,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2002,"energy":154.91,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2003,"energy":166.58,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2004,"energy":173.41,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2005,"energy":191.05,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2006,"energy":196.31,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2007,"energy":204.43,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2008,"energy":204.2,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2009,"energy":217.31,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2010,"energy":240.06,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2011,"energy":250.07,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2012,"energy":271.68,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2013,"energy":284.02,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2014,"energy":311.81,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2015,"energy":338.34,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2016,"energy":337.38,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2017,"energy":354.3,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2018,"energy":334.7,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2019,"energy":335.24,"source":"fossil fuels"},{"Entity":"Saudi Arabia","Year":2020,"energy":337.82,"source":"fossil fuels"},{"Entity":"South Africa","Year":2000,"energy":181.67,"source":"fossil fuels"},{"Entity":"South Africa","Year":2001,"energy":183.36,"source":"fossil fuels"},{"Entity":"South Africa","Year":2002,"energy":188.79,"source":"fossil fuels"},{"Entity":"South Africa","Year":2003,"energy":204.39,"source":"fossil fuels"},{"Entity":"South Africa","Year":2004,"energy":212.63,"source":"fossil fuels"},{"Entity":"South Africa","Year":2005,"energy":215.23,"source":"fossil fuels"},{"Entity":"South Africa","Year":2006,"energy":223.25,"source":"fossil fuels"},{"Entity":"South Africa","Year":2007,"energy":232.91,"source":"fossil fuels"},{"Entity":"South Africa","Year":2008,"energy":226.32,"source":"fossil fuels"},{"Entity":"South Africa","Year":2009,"energy":218.17,"source":"fossil fuels"},{"Entity":"South Africa","Year":2010,"energy":227.57,"source":"fossil fuels"},{"Entity":"South Africa","Year":2011,"energy":229.06,"source":"fossil fuels"},{"Entity":"South Africa","Year":2012,"energy":226.84,"source":"fossil fuels"},{"Entity":"South Africa","Year":2013,"energy":223.28,"source":"fossil fuels"},{"Entity":"South Africa","Year":2014,"energy":218.42,"source":"fossil fuels"},{"Entity":"South Africa","Year":2015,"energy":214.88,"source":"fossil fuels"},{"Entity":"South Africa","Year":2016,"energy":213.09,"source":"fossil fuels"},{"Entity":"South Africa","Year":2017,"energy":212.77,"source":"fossil fuels"},{"Entity":"South Africa","Year":2018,"energy":214.25,"source":"fossil fuels"},{"Entity":"South Africa","Year":2019,"energy":208.39,"source":"fossil fuels"},{"Entity":"South Africa","Year":2020,"energy":197.5,"source":"fossil fuels"},{"Entity":"Spain","Year":2000,"energy":124.22,"source":"fossil fuels"},{"Entity":"Spain","Year":2001,"energy":120.06,"source":"fossil fuels"},{"Entity":"Spain","Year":2002,"energy":143.72,"source":"fossil fuels"},{"Entity":"Spain","Year":2003,"energy":139.67,"source":"fossil fuels"},{"Entity":"Spain","Year":2004,"energy":159.91,"source":"fossil fuels"},{"Entity":"Spain","Year":2005,"energy":184.65,"source":"fossil fuels"},{"Entity":"Spain","Year":2006,"energy":182.98,"source":"fossil fuels"},{"Entity":"Spain","Year":2007,"energy":188.13,"source":"fossil fuels"},{"Entity":"Spain","Year":2008,"energy":189.55,"source":"fossil fuels"},{"Entity":"Spain","Year":2009,"energy":164.69,"source":"fossil fuels"},{"Entity":"Spain","Year":2010,"energy":138.39,"source":"fossil fuels"},{"Entity":"Spain","Year":2011,"energy":146.12,"source":"fossil fuels"},{"Entity":"Spain","Year":2012,"energy":145.33,"source":"fossil fuels"},{"Entity":"Spain","Year":2013,"energy":113.32,"source":"fossil fuels"},{"Entity":"Spain","Year":2014,"energy":107.37,"source":"fossil fuels"},{"Entity":"Spain","Year":2015,"energy":123.19,"source":"fossil fuels"},{"Entity":"Spain","Year":2016,"energy":107.93,"source":"fossil fuels"},{"Entity":"Spain","Year":2017,"energy":126.93,"source":"fossil fuels"},{"Entity":"Spain","Year":2018,"energy":112.23,"source":"fossil fuels"},{"Entity":"Spain","Year":2019,"energy":111.55,"source":"fossil fuels"},{"Entity":"Spain","Year":2020,"energy":87.64,"source":"fossil fuels"},{"Entity":"Thailand","Year":2000,"energy":83.15,"source":"fossil fuels"},{"Entity":"Thailand","Year":2001,"energy":88.97,"source":"fossil fuels"},{"Entity":"Thailand","Year":2002,"energy":93.51,"source":"fossil fuels"},{"Entity":"Thailand","Year":2003,"energy":100.61,"source":"fossil fuels"},{"Entity":"Thailand","Year":2004,"energy":109.46,"source":"fossil fuels"},{"Entity":"Thailand","Year":2005,"energy":115.58,"source":"fossil fuels"},{"Entity":"Thailand","Year":2006,"energy":119.41,"source":"fossil fuels"},{"Entity":"Thailand","Year":2007,"energy":122.12,"source":"fossil fuels"},{"Entity":"Thailand","Year":2008,"energy":127.43,"source":"fossil fuels"},{"Entity":"Thailand","Year":2009,"energy":128.09,"source":"fossil fuels"},{"Entity":"Thailand","Year":2010,"energy":141.72,"source":"fossil fuels"},{"Entity":"Thailand","Year":2011,"energy":135.31,"source":"fossil fuels"},{"Entity":"Thailand","Year":2012,"energy":143.73,"source":"fossil fuels"},{"Entity":"Thailand","Year":2013,"energy":148.29,"source":"fossil fuels"},{"Entity":"Thailand","Year":2014,"energy":149.26,"source":"fossil fuels"},{"Entity":"Thailand","Year":2015,"energy":153.4,"source":"fossil fuels"},{"Entity":"Thailand","Year":2016,"energy":161.79,"source":"fossil fuels"},{"Entity":"Thailand","Year":2017,"energy":161.88,"source":"fossil fuels"},{"Entity":"Thailand","Year":2018,"energy":156.26,"source":"fossil fuels"},{"Entity":"Thailand","Year":2019,"energy":162.59,"source":"fossil fuels"},{"Entity":"Thailand","Year":2020,"energy":154.52,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2000,"energy":82.65,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2001,"energy":84.59,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2002,"energy":85.93,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2003,"energy":89.52,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2004,"energy":83.22,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2005,"energy":84.75,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2006,"energy":90.09,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2007,"energy":93.13,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2008,"energy":90.92,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2009,"energy":78.58,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2010,"energy":86.28,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2011,"energy":93.5,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2012,"energy":96.99,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2013,"energy":95.39,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2014,"energy":83.42,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2015,"energy":66.91,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2016,"energy":72.66,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2017,"energy":57.96,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2018,"energy":60.81,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2019,"energy":57.79,"source":"fossil fuels"},{"Entity":"Ukraine","Year":2020,"energy":54.5,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2000,"energy":279.34,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2001,"energy":282.72,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2002,"energy":285.62,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2003,"energy":296.15,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2004,"energy":297.15,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2005,"energy":296.87,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2006,"energy":299.88,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2007,"energy":310.26,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2008,"energy":310.5,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2009,"energy":278.73,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2010,"energy":290.59,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2011,"energy":260.88,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2012,"energy":249.25,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2013,"energy":231.56,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2014,"energy":206.94,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2015,"energy":182.43,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2016,"energy":181.56,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2017,"energy":165.91,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2018,"energy":155.41,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2019,"energy":144.99,"source":"fossil fuels"},{"Entity":"United Kingdom","Year":2020,"energy":124.78,"source":"fossil fuels"},{"Entity":"United States","Year":2000,"energy":2697.28,"source":"fossil fuels"},{"Entity":"United States","Year":2001,"energy":2678.68,"source":"fossil fuels"},{"Entity":"United States","Year":2002,"energy":2727.83,"source":"fossil fuels"},{"Entity":"United States","Year":2003,"energy":2756.03,"source":"fossil fuels"},{"Entity":"United States","Year":2004,"energy":2818.28,"source":"fossil fuels"},{"Entity":"United States","Year":2005,"energy":2899.96,"source":"fossil fuels"},{"Entity":"United States","Year":2006,"energy":2878.56,"source":"fossil fuels"},{"Entity":"United States","Year":2007,"energy":2988.24,"source":"fossil fuels"},{"Entity":"United States","Year":2008,"energy":2924.21,"source":"fossil fuels"},{"Entity":"United States","Year":2009,"energy":2725.41,"source":"fossil fuels"},{"Entity":"United States","Year":2010,"energy":2882.49,"source":"fossil fuels"},{"Entity":"United States","Year":2011,"energy":2788.93,"source":"fossil fuels"},{"Entity":"United States","Year":2012,"energy":2779.02,"source":"fossil fuels"},{"Entity":"United States","Year":2013,"energy":2746.21,"source":"fossil fuels"},{"Entity":"United States","Year":2014,"energy":2752.01,"source":"fossil fuels"},{"Entity":"United States","Year":2015,"energy":2730.32,"source":"fossil fuels"},{"Entity":"United States","Year":2016,"energy":2656.96,"source":"fossil fuels"},{"Entity":"United States","Year":2017,"energy":2540.17,"source":"fossil fuels"},{"Entity":"United States","Year":2018,"energy":2661.3,"source":"fossil fuels"},{"Entity":"United States","Year":2019,"energy":2588.21,"source":"fossil fuels"},{"Entity":"United States","Year":2020,"energy":2431.9,"source":"fossil fuels"},{"Entity":"Australia","Year":2000,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2001,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2002,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2003,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2004,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2005,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2006,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2007,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2008,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2009,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2010,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2011,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2012,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2013,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2014,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2015,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2016,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2017,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2018,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2019,"energy":0,"source":"nuclear"},{"Entity":"Australia","Year":2020,"energy":0,"source":"nuclear"},{"Entity":"Brazil","Year":2000,"energy":4.94,"source":"nuclear"},{"Entity":"Brazil","Year":2001,"energy":14.27,"source":"nuclear"},{"Entity":"Brazil","Year":2002,"energy":13.84,"source":"nuclear"},{"Entity":"Brazil","Year":2003,"energy":13.4,"source":"nuclear"},{"Entity":"Brazil","Year":2004,"energy":11.6,"source":"nuclear"},{"Entity":"Brazil","Year":2005,"energy":9.2,"source":"nuclear"},{"Entity":"Brazil","Year":2006,"energy":12.98,"source":"nuclear"},{"Entity":"Brazil","Year":2007,"energy":11.65,"source":"nuclear"},{"Entity":"Brazil","Year":2008,"energy":13.21,"source":"nuclear"},{"Entity":"Brazil","Year":2009,"energy":12.22,"source":"nuclear"},{"Entity":"Brazil","Year":2010,"energy":13.77,"source":"nuclear"},{"Entity":"Brazil","Year":2011,"energy":14.8,"source":"nuclear"},{"Entity":"Brazil","Year":2012,"energy":15.17,"source":"nuclear"},{"Entity":"Brazil","Year":2013,"energy":14.65,"source":"nuclear"},{"Entity":"Brazil","Year":2014,"energy":14.46,"source":"nuclear"},{"Entity":"Brazil","Year":2015,"energy":13.91,"source":"nuclear"},{"Entity":"Brazil","Year":2016,"energy":14.97,"source":"nuclear"},{"Entity":"Brazil","Year":2017,"energy":14.86,"source":"nuclear"},{"Entity":"Brazil","Year":2018,"energy":14.79,"source":"nuclear"},{"Entity":"Brazil","Year":2019,"energy":15.16,"source":"nuclear"},{"Entity":"Brazil","Year":2020,"energy":13.21,"source":"nuclear"},{"Entity":"Canada","Year":2000,"energy":69.16,"source":"nuclear"},{"Entity":"Canada","Year":2001,"energy":72.86,"source":"nuclear"},{"Entity":"Canada","Year":2002,"energy":71.75,"source":"nuclear"},{"Entity":"Canada","Year":2003,"energy":71.15,"source":"nuclear"},{"Entity":"Canada","Year":2004,"energy":85.87,"source":"nuclear"},{"Entity":"Canada","Year":2005,"energy":86.83,"source":"nuclear"},{"Entity":"Canada","Year":2006,"energy":92.44,"source":"nuclear"},{"Entity":"Canada","Year":2007,"energy":88.19,"source":"nuclear"},{"Entity":"Canada","Year":2008,"energy":88.3,"source":"nuclear"},{"Entity":"Canada","Year":2009,"energy":85.13,"source":"nuclear"},{"Entity":"Canada","Year":2010,"energy":85.53,"source":"nuclear"},{"Entity":"Canada","Year":2011,"energy":88.29,"source":"nuclear"},{"Entity":"Canada","Year":2012,"energy":89.49,"source":"nuclear"},{"Entity":"Canada","Year":2013,"energy":97.58,"source":"nuclear"},{"Entity":"Canada","Year":2014,"energy":101.21,"source":"nuclear"},{"Entity":"Canada","Year":2015,"energy":96.05,"source":"nuclear"},{"Entity":"Canada","Year":2016,"energy":95.69,"source":"nuclear"},{"Entity":"Canada","Year":2017,"energy":95.57,"source":"nuclear"},{"Entity":"Canada","Year":2018,"energy":95.03,"source":"nuclear"},{"Entity":"Canada","Year":2019,"energy":95.47,"source":"nuclear"},{"Entity":"Canada","Year":2020,"energy":92.65,"source":"nuclear"},{"Entity":"China","Year":2000,"energy":16.74,"source":"nuclear"},{"Entity":"China","Year":2001,"energy":17.47,"source":"nuclear"},{"Entity":"China","Year":2002,"energy":25.13,"source":"nuclear"},{"Entity":"China","Year":2003,"energy":43.34,"source":"nuclear"},{"Entity":"China","Year":2004,"energy":50.47,"source":"nuclear"},{"Entity":"China","Year":2005,"energy":53.09,"source":"nuclear"},{"Entity":"China","Year":2006,"energy":54.84,"source":"nuclear"},{"Entity":"China","Year":2007,"energy":62.13,"source":"nuclear"},{"Entity":"China","Year":2008,"energy":68.39,"source":"nuclear"},{"Entity":"China","Year":2009,"energy":70.05,"source":"nuclear"},{"Entity":"China","Year":2010,"energy":74.74,"source":"nuclear"},{"Entity":"China","Year":2011,"energy":87.2,"source":"nuclear"},{"Entity":"China","Year":2012,"energy":98.32,"source":"nuclear"},{"Entity":"China","Year":2013,"energy":111.5,"source":"nuclear"},{"Entity":"China","Year":2014,"energy":133.22,"source":"nuclear"},{"Entity":"China","Year":2015,"energy":171.38,"source":"nuclear"},{"Entity":"China","Year":2016,"energy":213.18,"source":"nuclear"},{"Entity":"China","Year":2017,"energy":248.1,"source":"nuclear"},{"Entity":"China","Year":2018,"energy":295,"source":"nuclear"},{"Entity":"China","Year":2019,"energy":348.7,"source":"nuclear"},{"Entity":"China","Year":2020,"energy":366.2,"source":"nuclear"},{"Entity":"France","Year":2000,"energy":415.16,"source":"nuclear"},{"Entity":"France","Year":2001,"energy":421.08,"source":"nuclear"},{"Entity":"France","Year":2002,"energy":436.76,"source":"nuclear"},{"Entity":"France","Year":2003,"energy":441.07,"source":"nuclear"},{"Entity":"France","Year":2004,"energy":448.24,"source":"nuclear"},{"Entity":"France","Year":2005,"energy":451.53,"source":"nuclear"},{"Entity":"France","Year":2006,"energy":450.19,"source":"nuclear"},{"Entity":"France","Year":2007,"energy":439.73,"source":"nuclear"},{"Entity":"France","Year":2008,"energy":439.45,"source":"nuclear"},{"Entity":"France","Year":2009,"energy":409.74,"source":"nuclear"},{"Entity":"France","Year":2010,"energy":428.52,"source":"nuclear"},{"Entity":"France","Year":2011,"energy":442.39,"source":"nuclear"},{"Entity":"France","Year":2012,"energy":425.41,"source":"nuclear"},{"Entity":"France","Year":2013,"energy":423.68,"source":"nuclear"},{"Entity":"France","Year":2014,"energy":436.48,"source":"nuclear"},{"Entity":"France","Year":2015,"energy":437.43,"source":"nuclear"},{"Entity":"France","Year":2016,"energy":403.2,"source":"nuclear"},{"Entity":"France","Year":2017,"energy":398.36,"source":"nuclear"},{"Entity":"France","Year":2018,"energy":412.94,"source":"nuclear"},{"Entity":"France","Year":2019,"energy":399.01,"source":"nuclear"},{"Entity":"France","Year":2020,"energy":353.83,"source":"nuclear"},{"Entity":"Germany","Year":2000,"energy":169.61,"source":"nuclear"},{"Entity":"Germany","Year":2001,"energy":171.3,"source":"nuclear"},{"Entity":"Germany","Year":2002,"energy":164.84,"source":"nuclear"},{"Entity":"Germany","Year":2003,"energy":165.06,"source":"nuclear"},{"Entity":"Germany","Year":2004,"energy":167.07,"source":"nuclear"},{"Entity":"Germany","Year":2005,"energy":163.05,"source":"nuclear"},{"Entity":"Germany","Year":2006,"energy":167.27,"source":"nuclear"},{"Entity":"Germany","Year":2007,"energy":140.53,"source":"nuclear"},{"Entity":"Germany","Year":2008,"energy":148.49,"source":"nuclear"},{"Entity":"Germany","Year":2009,"energy":134.93,"source":"nuclear"},{"Entity":"Germany","Year":2010,"energy":140.56,"source":"nuclear"},{"Entity":"Germany","Year":2011,"energy":107.97,"source":"nuclear"},{"Entity":"Germany","Year":2012,"energy":99.46,"source":"nuclear"},{"Entity":"Germany","Year":2013,"energy":97.29,"source":"nuclear"},{"Entity":"Germany","Year":2014,"energy":97.13,"source":"nuclear"},{"Entity":"Germany","Year":2015,"energy":91.79,"source":"nuclear"},{"Entity":"Germany","Year":2016,"energy":84.63,"source":"nuclear"},{"Entity":"Germany","Year":2017,"energy":76.32,"source":"nuclear"},{"Entity":"Germany","Year":2018,"energy":76,"source":"nuclear"},{"Entity":"Germany","Year":2019,"energy":75.07,"source":"nuclear"},{"Entity":"Germany","Year":2020,"energy":64.38,"source":"nuclear"},{"Entity":"India","Year":2000,"energy":15.77,"source":"nuclear"},{"Entity":"India","Year":2001,"energy":18.89,"source":"nuclear"},{"Entity":"India","Year":2002,"energy":19.35,"source":"nuclear"},{"Entity":"India","Year":2003,"energy":18.14,"source":"nuclear"},{"Entity":"India","Year":2004,"energy":21.26,"source":"nuclear"},{"Entity":"India","Year":2005,"energy":17.73,"source":"nuclear"},{"Entity":"India","Year":2006,"energy":17.63,"source":"nuclear"},{"Entity":"India","Year":2007,"energy":17.83,"source":"nuclear"},{"Entity":"India","Year":2008,"energy":15.23,"source":"nuclear"},{"Entity":"India","Year":2009,"energy":16.82,"source":"nuclear"},{"Entity":"India","Year":2010,"energy":23.08,"source":"nuclear"},{"Entity":"India","Year":2011,"energy":32.22,"source":"nuclear"},{"Entity":"India","Year":2012,"energy":33.14,"source":"nuclear"},{"Entity":"India","Year":2013,"energy":33.31,"source":"nuclear"},{"Entity":"India","Year":2014,"energy":34.69,"source":"nuclear"},{"Entity":"India","Year":2015,"energy":38.31,"source":"nuclear"},{"Entity":"India","Year":2016,"energy":37.9,"source":"nuclear"},{"Entity":"India","Year":2017,"energy":37.41,"source":"nuclear"},{"Entity":"India","Year":2018,"energy":39.05,"source":"nuclear"},{"Entity":"India","Year":2019,"energy":45.16,"source":"nuclear"},{"Entity":"India","Year":2020,"energy":44.61,"source":"nuclear"},{"Entity":"Indonesia","Year":2000,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2001,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2002,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2003,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2004,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2005,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2006,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2007,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2008,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2009,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2010,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2011,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2012,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2013,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2014,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2015,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2016,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2017,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2018,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2019,"energy":null,"source":"nuclear"},{"Entity":"Indonesia","Year":2020,"energy":null,"source":"nuclear"},{"Entity":"Italy","Year":2000,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2001,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2002,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2003,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2004,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2005,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2006,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2007,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2008,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2009,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2010,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2011,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2012,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2013,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2014,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2015,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2016,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2017,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2018,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2019,"energy":0,"source":"nuclear"},{"Entity":"Italy","Year":2020,"energy":0,"source":"nuclear"},{"Entity":"Japan","Year":2000,"energy":305.95,"source":"nuclear"},{"Entity":"Japan","Year":2001,"energy":303.86,"source":"nuclear"},{"Entity":"Japan","Year":2002,"energy":280.34,"source":"nuclear"},{"Entity":"Japan","Year":2003,"energy":228.01,"source":"nuclear"},{"Entity":"Japan","Year":2004,"energy":268.32,"source":"nuclear"},{"Entity":"Japan","Year":2005,"energy":280.5,"source":"nuclear"},{"Entity":"Japan","Year":2006,"energy":291.54,"source":"nuclear"},{"Entity":"Japan","Year":2007,"energy":267.34,"source":"nuclear"},{"Entity":"Japan","Year":2008,"energy":241.25,"source":"nuclear"},{"Entity":"Japan","Year":2009,"energy":263.05,"source":"nuclear"},{"Entity":"Japan","Year":2010,"energy":278.36,"source":"nuclear"},{"Entity":"Japan","Year":2011,"energy":153.38,"source":"nuclear"},{"Entity":"Japan","Year":2012,"energy":15.12,"source":"nuclear"},{"Entity":"Japan","Year":2013,"energy":10.43,"source":"nuclear"},{"Entity":"Japan","Year":2014,"energy":0,"source":"nuclear"},{"Entity":"Japan","Year":2015,"energy":3.24,"source":"nuclear"},{"Entity":"Japan","Year":2016,"energy":14.87,"source":"nuclear"},{"Entity":"Japan","Year":2017,"energy":27.75,"source":"nuclear"},{"Entity":"Japan","Year":2018,"energy":47.82,"source":"nuclear"},{"Entity":"Japan","Year":2019,"energy":63.88,"source":"nuclear"},{"Entity":"Japan","Year":2020,"energy":41.86,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2000,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2001,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2002,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2003,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2004,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2005,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2006,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2007,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2008,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2009,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2010,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2011,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2012,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2013,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2014,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2015,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2016,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2017,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2018,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2019,"energy":null,"source":"nuclear"},{"Entity":"Kazakhstan","Year":2020,"energy":null,"source":"nuclear"},{"Entity":"Mexico","Year":2000,"energy":7.81,"source":"nuclear"},{"Entity":"Mexico","Year":2001,"energy":8.29,"source":"nuclear"},{"Entity":"Mexico","Year":2002,"energy":9.26,"source":"nuclear"},{"Entity":"Mexico","Year":2003,"energy":9.98,"source":"nuclear"},{"Entity":"Mexico","Year":2004,"energy":8.73,"source":"nuclear"},{"Entity":"Mexico","Year":2005,"energy":10.32,"source":"nuclear"},{"Entity":"Mexico","Year":2006,"energy":10.4,"source":"nuclear"},{"Entity":"Mexico","Year":2007,"energy":9.95,"source":"nuclear"},{"Entity":"Mexico","Year":2008,"energy":9.36,"source":"nuclear"},{"Entity":"Mexico","Year":2009,"energy":10.11,"source":"nuclear"},{"Entity":"Mexico","Year":2010,"energy":5.66,"source":"nuclear"},{"Entity":"Mexico","Year":2011,"energy":9.66,"source":"nuclear"},{"Entity":"Mexico","Year":2012,"energy":8.41,"source":"nuclear"},{"Entity":"Mexico","Year":2013,"energy":11.38,"source":"nuclear"},{"Entity":"Mexico","Year":2014,"energy":9.3,"source":"nuclear"},{"Entity":"Mexico","Year":2015,"energy":11.18,"source":"nuclear"},{"Entity":"Mexico","Year":2016,"energy":10.27,"source":"nuclear"},{"Entity":"Mexico","Year":2017,"energy":10.57,"source":"nuclear"},{"Entity":"Mexico","Year":2018,"energy":13.32,"source":"nuclear"},{"Entity":"Mexico","Year":2019,"energy":10.88,"source":"nuclear"},{"Entity":"Mexico","Year":2020,"energy":10.87,"source":"nuclear"},{"Entity":"Poland","Year":2000,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2001,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2002,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2003,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2004,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2005,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2006,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2007,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2008,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2009,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2010,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2011,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2012,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2013,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2014,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2015,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2016,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2017,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2018,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2019,"energy":0,"source":"nuclear"},{"Entity":"Poland","Year":2020,"energy":0,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2000,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2001,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2002,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2003,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2004,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2005,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2006,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2007,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2008,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2009,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2010,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2011,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2012,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2013,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2014,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2015,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2016,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2017,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2018,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2019,"energy":null,"source":"nuclear"},{"Entity":"Saudi Arabia","Year":2020,"energy":null,"source":"nuclear"},{"Entity":"South Africa","Year":2000,"energy":13.01,"source":"nuclear"},{"Entity":"South Africa","Year":2001,"energy":10.72,"source":"nuclear"},{"Entity":"South Africa","Year":2002,"energy":11.99,"source":"nuclear"},{"Entity":"South Africa","Year":2003,"energy":12.66,"source":"nuclear"},{"Entity":"South Africa","Year":2004,"energy":14.28,"source":"nuclear"},{"Entity":"South Africa","Year":2005,"energy":12.24,"source":"nuclear"},{"Entity":"South Africa","Year":2006,"energy":10.07,"source":"nuclear"},{"Entity":"South Africa","Year":2007,"energy":12.6,"source":"nuclear"},{"Entity":"South Africa","Year":2008,"energy":12.75,"source":"nuclear"},{"Entity":"South Africa","Year":2009,"energy":11.57,"source":"nuclear"},{"Entity":"South Africa","Year":2010,"energy":12.9,"source":"nuclear"},{"Entity":"South Africa","Year":2011,"energy":12.94,"source":"nuclear"},{"Entity":"South Africa","Year":2012,"energy":12.4,"source":"nuclear"},{"Entity":"South Africa","Year":2013,"energy":13.61,"source":"nuclear"},{"Entity":"South Africa","Year":2014,"energy":14.76,"source":"nuclear"},{"Entity":"South Africa","Year":2015,"energy":10.97,"source":"nuclear"},{"Entity":"South Africa","Year":2016,"energy":15.21,"source":"nuclear"},{"Entity":"South Africa","Year":2017,"energy":15.09,"source":"nuclear"},{"Entity":"South Africa","Year":2018,"energy":10.56,"source":"nuclear"},{"Entity":"South Africa","Year":2019,"energy":13.6,"source":"nuclear"},{"Entity":"South Africa","Year":2020,"energy":11.62,"source":"nuclear"},{"Entity":"Spain","Year":2000,"energy":62.21,"source":"nuclear"},{"Entity":"Spain","Year":2001,"energy":63.71,"source":"nuclear"},{"Entity":"Spain","Year":2002,"energy":63.02,"source":"nuclear"},{"Entity":"Spain","Year":2003,"energy":61.88,"source":"nuclear"},{"Entity":"Spain","Year":2004,"energy":63.61,"source":"nuclear"},{"Entity":"Spain","Year":2005,"energy":57.54,"source":"nuclear"},{"Entity":"Spain","Year":2006,"energy":60.13,"source":"nuclear"},{"Entity":"Spain","Year":2007,"energy":55.1,"source":"nuclear"},{"Entity":"Spain","Year":2008,"energy":58.97,"source":"nuclear"},{"Entity":"Spain","Year":2009,"energy":52.76,"source":"nuclear"},{"Entity":"Spain","Year":2010,"energy":61.99,"source":"nuclear"},{"Entity":"Spain","Year":2011,"energy":57.72,"source":"nuclear"},{"Entity":"Spain","Year":2012,"energy":61.47,"source":"nuclear"},{"Entity":"Spain","Year":2013,"energy":56.73,"source":"nuclear"},{"Entity":"Spain","Year":2014,"energy":57.31,"source":"nuclear"},{"Entity":"Spain","Year":2015,"energy":57.2,"source":"nuclear"},{"Entity":"Spain","Year":2016,"energy":58.63,"source":"nuclear"},{"Entity":"Spain","Year":2017,"energy":58.04,"source":"nuclear"},{"Entity":"Spain","Year":2018,"energy":55.77,"source":"nuclear"},{"Entity":"Spain","Year":2019,"energy":58.35,"source":"nuclear"},{"Entity":"Spain","Year":2020,"energy":58.3,"source":"nuclear"},{"Entity":"Thailand","Year":2000,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2001,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2002,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2003,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2004,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2005,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2006,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2007,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2008,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2009,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2010,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2011,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2012,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2013,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2014,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2015,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2016,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2017,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2018,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2019,"energy":0,"source":"nuclear"},{"Entity":"Thailand","Year":2020,"energy":0,"source":"nuclear"},{"Entity":"Ukraine","Year":2000,"energy":77.34,"source":"nuclear"},{"Entity":"Ukraine","Year":2001,"energy":76.17,"source":"nuclear"},{"Entity":"Ukraine","Year":2002,"energy":77.99,"source":"nuclear"},{"Entity":"Ukraine","Year":2003,"energy":81.41,"source":"nuclear"},{"Entity":"Ukraine","Year":2004,"energy":87.02,"source":"nuclear"},{"Entity":"Ukraine","Year":2005,"energy":88.76,"source":"nuclear"},{"Entity":"Ukraine","Year":2006,"energy":90.22,"source":"nuclear"},{"Entity":"Ukraine","Year":2007,"energy":92.54,"source":"nuclear"},{"Entity":"Ukraine","Year":2008,"energy":89.84,"source":"nuclear"},{"Entity":"Ukraine","Year":2009,"energy":82.92,"source":"nuclear"},{"Entity":"Ukraine","Year":2010,"energy":89.15,"source":"nuclear"},{"Entity":"Ukraine","Year":2011,"energy":90.25,"source":"nuclear"},{"Entity":"Ukraine","Year":2012,"energy":90.14,"source":"nuclear"},{"Entity":"Ukraine","Year":2013,"energy":83.21,"source":"nuclear"},{"Entity":"Ukraine","Year":2014,"energy":88.39,"source":"nuclear"},{"Entity":"Ukraine","Year":2015,"energy":87.63,"source":"nuclear"},{"Entity":"Ukraine","Year":2016,"energy":80.95,"source":"nuclear"},{"Entity":"Ukraine","Year":2017,"energy":85.58,"source":"nuclear"},{"Entity":"Ukraine","Year":2018,"energy":84.4,"source":"nuclear"},{"Entity":"Ukraine","Year":2019,"energy":83,"source":"nuclear"},{"Entity":"Ukraine","Year":2020,"energy":76.2,"source":"nuclear"},{"Entity":"United Kingdom","Year":2000,"energy":85.06,"source":"nuclear"},{"Entity":"United Kingdom","Year":2001,"energy":90.09,"source":"nuclear"},{"Entity":"United Kingdom","Year":2002,"energy":87.85,"source":"nuclear"},{"Entity":"United Kingdom","Year":2003,"energy":88.69,"source":"nuclear"},{"Entity":"United Kingdom","Year":2004,"energy":80,"source":"nuclear"},{"Entity":"United Kingdom","Year":2005,"energy":81.62,"source":"nuclear"},{"Entity":"United Kingdom","Year":2006,"energy":75.45,"source":"nuclear"},{"Entity":"United Kingdom","Year":2007,"energy":63.03,"source":"nuclear"},{"Entity":"United Kingdom","Year":2008,"energy":52.49,"source":"nuclear"},{"Entity":"United Kingdom","Year":2009,"energy":69.1,"source":"nuclear"},{"Entity":"United Kingdom","Year":2010,"energy":62.14,"source":"nuclear"},{"Entity":"United Kingdom","Year":2011,"energy":68.98,"source":"nuclear"},{"Entity":"United Kingdom","Year":2012,"energy":70.4,"source":"nuclear"},{"Entity":"United Kingdom","Year":2013,"energy":70.61,"source":"nuclear"},{"Entity":"United Kingdom","Year":2014,"energy":63.75,"source":"nuclear"},{"Entity":"United Kingdom","Year":2015,"energy":70.34,"source":"nuclear"},{"Entity":"United Kingdom","Year":2016,"energy":71.73,"source":"nuclear"},{"Entity":"United Kingdom","Year":2017,"energy":70.34,"source":"nuclear"},{"Entity":"United Kingdom","Year":2018,"energy":65.06,"source":"nuclear"},{"Entity":"United Kingdom","Year":2019,"energy":56.18,"source":"nuclear"},{"Entity":"United Kingdom","Year":2020,"energy":50.85,"source":"nuclear"},{"Entity":"United States","Year":2000,"energy":753.89,"source":"nuclear"},{"Entity":"United States","Year":2001,"energy":768.83,"source":"nuclear"},{"Entity":"United States","Year":2002,"energy":780.06,"source":"nuclear"},{"Entity":"United States","Year":2003,"energy":763.73,"source":"nuclear"},{"Entity":"United States","Year":2004,"energy":788.53,"source":"nuclear"},{"Entity":"United States","Year":2005,"energy":781.99,"source":"nuclear"},{"Entity":"United States","Year":2006,"energy":787.22,"source":"nuclear"},{"Entity":"United States","Year":2007,"energy":806.42,"source":"nuclear"},{"Entity":"United States","Year":2008,"energy":806.21,"source":"nuclear"},{"Entity":"United States","Year":2009,"energy":798.85,"source":"nuclear"},{"Entity":"United States","Year":2010,"energy":806.97,"source":"nuclear"},{"Entity":"United States","Year":2011,"energy":790.2,"source":"nuclear"},{"Entity":"United States","Year":2012,"energy":769.33,"source":"nuclear"},{"Entity":"United States","Year":2013,"energy":789.02,"source":"nuclear"},{"Entity":"United States","Year":2014,"energy":797.17,"source":"nuclear"},{"Entity":"United States","Year":2015,"energy":797.18,"source":"nuclear"},{"Entity":"United States","Year":2016,"energy":805.69,"source":"nuclear"},{"Entity":"United States","Year":2017,"energy":804.95,"source":"nuclear"},{"Entity":"United States","Year":2018,"energy":807.08,"source":"nuclear"},{"Entity":"United States","Year":2019,"energy":809.41,"source":"nuclear"},{"Entity":"United States","Year":2020,"energy":789.88,"source":"nuclear"},{"Entity":"Australia","Year":2000,"energy":17.11,"source":"renewables"},{"Entity":"Australia","Year":2001,"energy":17.4,"source":"renewables"},{"Entity":"Australia","Year":2002,"energy":17.35,"source":"renewables"},{"Entity":"Australia","Year":2003,"energy":18.5,"source":"renewables"},{"Entity":"Australia","Year":2004,"energy":19.41,"source":"renewables"},{"Entity":"Australia","Year":2005,"energy":19.75,"source":"renewables"},{"Entity":"Australia","Year":2006,"energy":21.19,"source":"renewables"},{"Entity":"Australia","Year":2007,"energy":20.93,"source":"renewables"},{"Entity":"Australia","Year":2008,"energy":18.49,"source":"renewables"},{"Entity":"Australia","Year":2009,"energy":18.32,"source":"renewables"},{"Entity":"Australia","Year":2010,"energy":21.13,"source":"renewables"},{"Entity":"Australia","Year":2011,"energy":27.33,"source":"renewables"},{"Entity":"Australia","Year":2012,"energy":26.63,"source":"renewables"},{"Entity":"Australia","Year":2013,"energy":34.2,"source":"renewables"},{"Entity":"Australia","Year":2014,"energy":36.15,"source":"renewables"},{"Entity":"Australia","Year":2015,"energy":33.12,"source":"renewables"},{"Entity":"Australia","Year":2016,"energy":38.41,"source":"renewables"},{"Entity":"Australia","Year":2017,"energy":40.77,"source":"renewables"},{"Entity":"Australia","Year":2018,"energy":42.93,"source":"renewables"},{"Entity":"Australia","Year":2019,"energy":53.41,"source":"renewables"},{"Entity":"Australia","Year":2020,"energy":63.99,"source":"renewables"},{"Entity":"Brazil","Year":2000,"energy":308.77,"source":"renewables"},{"Entity":"Brazil","Year":2001,"energy":273.71,"source":"renewables"},{"Entity":"Brazil","Year":2002,"energy":292.95,"source":"renewables"},{"Entity":"Brazil","Year":2003,"energy":313.88,"source":"renewables"},{"Entity":"Brazil","Year":2004,"energy":329.43,"source":"renewables"},{"Entity":"Brazil","Year":2005,"energy":346.96,"source":"renewables"},{"Entity":"Brazil","Year":2006,"energy":359.55,"source":"renewables"},{"Entity":"Brazil","Year":2007,"energy":387.88,"source":"renewables"},{"Entity":"Brazil","Year":2008,"energy":385.61,"source":"renewables"},{"Entity":"Brazil","Year":2009,"energy":410.13,"source":"renewables"},{"Entity":"Brazil","Year":2010,"energy":435.99,"source":"renewables"},{"Entity":"Brazil","Year":2011,"energy":462.32,"source":"renewables"},{"Entity":"Brazil","Year":2012,"energy":454.78,"source":"renewables"},{"Entity":"Brazil","Year":2013,"energy":436.84,"source":"renewables"},{"Entity":"Brazil","Year":2014,"energy":430.82,"source":"renewables"},{"Entity":"Brazil","Year":2015,"energy":428.81,"source":"renewables"},{"Entity":"Brazil","Year":2016,"energy":463.37,"source":"renewables"},{"Entity":"Brazil","Year":2017,"energy":464.4,"source":"renewables"},{"Entity":"Brazil","Year":2018,"energy":492.66,"source":"renewables"},{"Entity":"Brazil","Year":2019,"energy":512.59,"source":"renewables"},{"Entity":"Brazil","Year":2020,"energy":520.01,"source":"renewables"},{"Entity":"Canada","Year":2000,"energy":363.7,"source":"renewables"},{"Entity":"Canada","Year":2001,"energy":339.58,"source":"renewables"},{"Entity":"Canada","Year":2002,"energy":357.06,"source":"renewables"},{"Entity":"Canada","Year":2003,"energy":343.88,"source":"renewables"},{"Entity":"Canada","Year":2004,"energy":347.68,"source":"renewables"},{"Entity":"Canada","Year":2005,"energy":368.86,"source":"renewables"},{"Entity":"Canada","Year":2006,"energy":360.48,"source":"renewables"},{"Entity":"Canada","Year":2007,"energy":375.42,"source":"renewables"},{"Entity":"Canada","Year":2008,"energy":385.21,"source":"renewables"},{"Entity":"Canada","Year":2009,"energy":380.24,"source":"renewables"},{"Entity":"Canada","Year":2010,"energy":366.21,"source":"renewables"},{"Entity":"Canada","Year":2011,"energy":391.95,"source":"renewables"},{"Entity":"Canada","Year":2012,"energy":398.58,"source":"renewables"},{"Entity":"Canada","Year":2013,"energy":417.28,"source":"renewables"},{"Entity":"Canada","Year":2014,"energy":412.13,"source":"renewables"},{"Entity":"Canada","Year":2015,"energy":417.2,"source":"renewables"},{"Entity":"Canada","Year":2016,"energy":426.84,"source":"renewables"},{"Entity":"Canada","Year":2017,"energy":435.43,"source":"renewables"},{"Entity":"Canada","Year":2018,"energy":428.39,"source":"renewables"},{"Entity":"Canada","Year":2019,"energy":421.8,"source":"renewables"},{"Entity":"Canada","Year":2020,"energy":429.24,"source":"renewables"},{"Entity":"China","Year":2000,"energy":225.56,"source":"renewables"},{"Entity":"China","Year":2001,"energy":280.73,"source":"renewables"},{"Entity":"China","Year":2002,"energy":291.41,"source":"renewables"},{"Entity":"China","Year":2003,"energy":287.28,"source":"renewables"},{"Entity":"China","Year":2004,"energy":357.43,"source":"renewables"},{"Entity":"China","Year":2005,"energy":404.37,"source":"renewables"},{"Entity":"China","Year":2006,"energy":446.72,"source":"renewables"},{"Entity":"China","Year":2007,"energy":500.71,"source":"renewables"},{"Entity":"China","Year":2008,"energy":665.08,"source":"renewables"},{"Entity":"China","Year":2009,"energy":664.39,"source":"renewables"},{"Entity":"China","Year":2010,"energy":786.38,"source":"renewables"},{"Entity":"China","Year":2011,"energy":792.38,"source":"renewables"},{"Entity":"China","Year":2012,"energy":999.56,"source":"renewables"},{"Entity":"China","Year":2013,"energy":1093.37,"source":"renewables"},{"Entity":"China","Year":2014,"energy":1289.23,"source":"renewables"},{"Entity":"China","Year":2015,"energy":1393.66,"source":"renewables"},{"Entity":"China","Year":2016,"energy":1522.79,"source":"renewables"},{"Entity":"China","Year":2017,"energy":1667.06,"source":"renewables"},{"Entity":"China","Year":2018,"energy":1835.32,"source":"renewables"},{"Entity":"China","Year":2019,"energy":2014.57,"source":"renewables"},{"Entity":"China","Year":2020,"energy":2184.94,"source":"renewables"},{"Entity":"France","Year":2000,"energy":67.83,"source":"renewables"},{"Entity":"France","Year":2001,"energy":76.09,"source":"renewables"},{"Entity":"France","Year":2002,"energy":62.69,"source":"renewables"},{"Entity":"France","Year":2003,"energy":61.47,"source":"renewables"},{"Entity":"France","Year":2004,"energy":62.42,"source":"renewables"},{"Entity":"France","Year":2005,"energy":54.98,"source":"renewables"},{"Entity":"France","Year":2006,"energy":60.91,"source":"renewables"},{"Entity":"France","Year":2007,"energy":64.3,"source":"renewables"},{"Entity":"France","Year":2008,"energy":72.33,"source":"renewables"},{"Entity":"France","Year":2009,"energy":68.15,"source":"renewables"},{"Entity":"France","Year":2010,"energy":76.68,"source":"renewables"},{"Entity":"France","Year":2011,"energy":66.02,"source":"renewables"},{"Entity":"France","Year":2012,"energy":85.25,"source":"renewables"},{"Entity":"France","Year":2013,"energy":99.42,"source":"renewables"},{"Entity":"France","Year":2014,"energy":94.03,"source":"renewables"},{"Entity":"France","Year":2015,"energy":91.84,"source":"renewables"},{"Entity":"France","Year":2016,"energy":99,"source":"renewables"},{"Entity":"France","Year":2017,"energy":92.63,"source":"renewables"},{"Entity":"France","Year":2018,"energy":113.62,"source":"renewables"},{"Entity":"France","Year":2019,"energy":113.21,"source":"renewables"},{"Entity":"France","Year":2020,"energy":125.28,"source":"renewables"},{"Entity":"Germany","Year":2000,"energy":35.47,"source":"renewables"},{"Entity":"Germany","Year":2001,"energy":37.9,"source":"renewables"},{"Entity":"Germany","Year":2002,"energy":44.48,"source":"renewables"},{"Entity":"Germany","Year":2003,"energy":46.67,"source":"renewables"},{"Entity":"Germany","Year":2004,"energy":57.97,"source":"renewables"},{"Entity":"Germany","Year":2005,"energy":63.4,"source":"renewables"},{"Entity":"Germany","Year":2006,"energy":72.51,"source":"renewables"},{"Entity":"Germany","Year":2007,"energy":89.38,"source":"renewables"},{"Entity":"Germany","Year":2008,"energy":94.28,"source":"renewables"},{"Entity":"Germany","Year":2009,"energy":95.94,"source":"renewables"},{"Entity":"Germany","Year":2010,"energy":105.18,"source":"renewables"},{"Entity":"Germany","Year":2011,"energy":124.04,"source":"renewables"},{"Entity":"Germany","Year":2012,"energy":143.04,"source":"renewables"},{"Entity":"Germany","Year":2013,"energy":152.34,"source":"renewables"},{"Entity":"Germany","Year":2014,"energy":162.54,"source":"renewables"},{"Entity":"Germany","Year":2015,"energy":188.79,"source":"renewables"},{"Entity":"Germany","Year":2016,"energy":189.67,"source":"renewables"},{"Entity":"Germany","Year":2017,"energy":216.32,"source":"renewables"},{"Entity":"Germany","Year":2018,"energy":222.07,"source":"renewables"},{"Entity":"Germany","Year":2019,"energy":240.33,"source":"renewables"},{"Entity":"Germany","Year":2020,"energy":251.48,"source":"renewables"},{"Entity":"India","Year":2000,"energy":80.27,"source":"renewables"},{"Entity":"India","Year":2001,"energy":76.19,"source":"renewables"},{"Entity":"India","Year":2002,"energy":72.78,"source":"renewables"},{"Entity":"India","Year":2003,"energy":74.63,"source":"renewables"},{"Entity":"India","Year":2004,"energy":109.2,"source":"renewables"},{"Entity":"India","Year":2005,"energy":107.47,"source":"renewables"},{"Entity":"India","Year":2006,"energy":127.56,"source":"renewables"},{"Entity":"India","Year":2007,"energy":141.75,"source":"renewables"},{"Entity":"India","Year":2008,"energy":138.91,"source":"renewables"},{"Entity":"India","Year":2009,"energy":134.33,"source":"renewables"},{"Entity":"India","Year":2010,"energy":142.61,"source":"renewables"},{"Entity":"India","Year":2011,"energy":173.62,"source":"renewables"},{"Entity":"India","Year":2012,"energy":165.25,"source":"renewables"},{"Entity":"India","Year":2013,"energy":187.9,"source":"renewables"},{"Entity":"India","Year":2014,"energy":202.04,"source":"renewables"},{"Entity":"India","Year":2015,"energy":203.21,"source":"renewables"},{"Entity":"India","Year":2016,"energy":208.21,"source":"renewables"},{"Entity":"India","Year":2017,"energy":234.9,"source":"renewables"},{"Entity":"India","Year":2018,"energy":263.61,"source":"renewables"},{"Entity":"India","Year":2019,"energy":303.16,"source":"renewables"},{"Entity":"India","Year":2020,"energy":315.76,"source":"renewables"},{"Entity":"Indonesia","Year":2000,"energy":19.6,"source":"renewables"},{"Entity":"Indonesia","Year":2001,"energy":22.19,"source":"renewables"},{"Entity":"Indonesia","Year":2002,"energy":21,"source":"renewables"},{"Entity":"Indonesia","Year":2003,"energy":19.82,"source":"renewables"},{"Entity":"Indonesia","Year":2004,"energy":20.97,"source":"renewables"},{"Entity":"Indonesia","Year":2005,"energy":22.66,"source":"renewables"},{"Entity":"Indonesia","Year":2006,"energy":21.18,"source":"renewables"},{"Entity":"Indonesia","Year":2007,"energy":24.29,"source":"renewables"},{"Entity":"Indonesia","Year":2008,"energy":26.34,"source":"renewables"},{"Entity":"Indonesia","Year":2009,"energy":26.79,"source":"renewables"},{"Entity":"Indonesia","Year":2010,"energy":34.63,"source":"renewables"},{"Entity":"Indonesia","Year":2011,"energy":30.46,"source":"renewables"},{"Entity":"Indonesia","Year":2012,"energy":31.11,"source":"renewables"},{"Entity":"Indonesia","Year":2013,"energy":35.5,"source":"renewables"},{"Entity":"Indonesia","Year":2014,"energy":34.41,"source":"renewables"},{"Entity":"Indonesia","Year":2015,"energy":33.56,"source":"renewables"},{"Entity":"Indonesia","Year":2016,"energy":39.58,"source":"renewables"},{"Entity":"Indonesia","Year":2017,"energy":43.17,"source":"renewables"},{"Entity":"Indonesia","Year":2018,"energy":48.38,"source":"renewables"},{"Entity":"Indonesia","Year":2019,"energy":48.04,"source":"renewables"},{"Entity":"Indonesia","Year":2020,"energy":52.91,"source":"renewables"},{"Entity":"Italy","Year":2000,"energy":50.87,"source":"renewables"},{"Entity":"Italy","Year":2001,"energy":54.35,"source":"renewables"},{"Entity":"Italy","Year":2002,"energy":48.31,"source":"renewables"},{"Entity":"Italy","Year":2003,"energy":46.86,"source":"renewables"},{"Entity":"Italy","Year":2004,"energy":53.88,"source":"renewables"},{"Entity":"Italy","Year":2005,"energy":48.43,"source":"renewables"},{"Entity":"Italy","Year":2006,"energy":50.64,"source":"renewables"},{"Entity":"Italy","Year":2007,"energy":47.72,"source":"renewables"},{"Entity":"Italy","Year":2008,"energy":58.16,"source":"renewables"},{"Entity":"Italy","Year":2009,"energy":69.26,"source":"renewables"},{"Entity":"Italy","Year":2010,"energy":76.98,"source":"renewables"},{"Entity":"Italy","Year":2011,"energy":82.96,"source":"renewables"},{"Entity":"Italy","Year":2012,"energy":92.22,"source":"renewables"},{"Entity":"Italy","Year":2013,"energy":112,"source":"renewables"},{"Entity":"Italy","Year":2014,"energy":120.68,"source":"renewables"},{"Entity":"Italy","Year":2015,"energy":108.89,"source":"renewables"},{"Entity":"Italy","Year":2016,"energy":108.01,"source":"renewables"},{"Entity":"Italy","Year":2017,"energy":103.89,"source":"renewables"},{"Entity":"Italy","Year":2018,"energy":114.41,"source":"renewables"},{"Entity":"Italy","Year":2019,"energy":115.83,"source":"renewables"},{"Entity":"Italy","Year":2020,"energy":116.9,"source":"renewables"},{"Entity":"Japan","Year":2000,"energy":104.16,"source":"renewables"},{"Entity":"Japan","Year":2001,"energy":101.36,"source":"renewables"},{"Entity":"Japan","Year":2002,"energy":101.1,"source":"renewables"},{"Entity":"Japan","Year":2003,"energy":114.18,"source":"renewables"},{"Entity":"Japan","Year":2004,"energy":114.73,"source":"renewables"},{"Entity":"Japan","Year":2005,"energy":100.57,"source":"renewables"},{"Entity":"Japan","Year":2006,"energy":112.07,"source":"renewables"},{"Entity":"Japan","Year":2007,"energy":100.8,"source":"renewables"},{"Entity":"Japan","Year":2008,"energy":100.79,"source":"renewables"},{"Entity":"Japan","Year":2009,"energy":102.28,"source":"renewables"},{"Entity":"Japan","Year":2010,"energy":113.92,"source":"renewables"},{"Entity":"Japan","Year":2011,"energy":116.5,"source":"renewables"},{"Entity":"Japan","Year":2012,"energy":111.09,"source":"renewables"},{"Entity":"Japan","Year":2013,"energy":121.48,"source":"renewables"},{"Entity":"Japan","Year":2014,"energy":136.53,"source":"renewables"},{"Entity":"Japan","Year":2015,"energy":157.34,"source":"renewables"},{"Entity":"Japan","Year":2016,"energy":157.7,"source":"renewables"},{"Entity":"Japan","Year":2017,"energy":175.12,"source":"renewables"},{"Entity":"Japan","Year":2018,"energy":183.63,"source":"renewables"},{"Entity":"Japan","Year":2019,"energy":192.72,"source":"renewables"},{"Entity":"Japan","Year":2020,"energy":205.6,"source":"renewables"},{"Entity":"Kazakhstan","Year":2000,"energy":7.53,"source":"renewables"},{"Entity":"Kazakhstan","Year":2001,"energy":8.08,"source":"renewables"},{"Entity":"Kazakhstan","Year":2002,"energy":8.89,"source":"renewables"},{"Entity":"Kazakhstan","Year":2003,"energy":8.62,"source":"renewables"},{"Entity":"Kazakhstan","Year":2004,"energy":8.06,"source":"renewables"},{"Entity":"Kazakhstan","Year":2005,"energy":7.86,"source":"renewables"},{"Entity":"Kazakhstan","Year":2006,"energy":7.77,"source":"renewables"},{"Entity":"Kazakhstan","Year":2007,"energy":8.17,"source":"renewables"},{"Entity":"Kazakhstan","Year":2008,"energy":7.46,"source":"renewables"},{"Entity":"Kazakhstan","Year":2009,"energy":6.88,"source":"renewables"},{"Entity":"Kazakhstan","Year":2010,"energy":8.02,"source":"renewables"},{"Entity":"Kazakhstan","Year":2011,"energy":7.88,"source":"renewables"},{"Entity":"Kazakhstan","Year":2012,"energy":7.64,"source":"renewables"},{"Entity":"Kazakhstan","Year":2013,"energy":7.73,"source":"renewables"},{"Entity":"Kazakhstan","Year":2014,"energy":8.27,"source":"renewables"},{"Entity":"Kazakhstan","Year":2015,"energy":9.45,"source":"renewables"},{"Entity":"Kazakhstan","Year":2016,"energy":11.98,"source":"renewables"},{"Entity":"Kazakhstan","Year":2017,"energy":11.64,"source":"renewables"},{"Entity":"Kazakhstan","Year":2018,"energy":10.91,"source":"renewables"},{"Entity":"Kazakhstan","Year":2019,"energy":11.09,"source":"renewables"},{"Entity":"Kazakhstan","Year":2020,"energy":11.94,"source":"renewables"},{"Entity":"Mexico","Year":2000,"energy":44.51,"source":"renewables"},{"Entity":"Mexico","Year":2001,"energy":39.56,"source":"renewables"},{"Entity":"Mexico","Year":2002,"energy":35.67,"source":"renewables"},{"Entity":"Mexico","Year":2003,"energy":32.11,"source":"renewables"},{"Entity":"Mexico","Year":2004,"energy":38.19,"source":"renewables"},{"Entity":"Mexico","Year":2005,"energy":42.29,"source":"renewables"},{"Entity":"Mexico","Year":2006,"energy":43.63,"source":"renewables"},{"Entity":"Mexico","Year":2007,"energy":42.14,"source":"renewables"},{"Entity":"Mexico","Year":2008,"energy":53.22,"source":"renewables"},{"Entity":"Mexico","Year":2009,"energy":40.59,"source":"renewables"},{"Entity":"Mexico","Year":2010,"energy":51.37,"source":"renewables"},{"Entity":"Mexico","Year":2011,"energy":50.7,"source":"renewables"},{"Entity":"Mexico","Year":2012,"energy":47.2,"source":"renewables"},{"Entity":"Mexico","Year":2013,"energy":44.67,"source":"renewables"},{"Entity":"Mexico","Year":2014,"energy":57.46,"source":"renewables"},{"Entity":"Mexico","Year":2015,"energy":52.42,"source":"renewables"},{"Entity":"Mexico","Year":2016,"energy":52.97,"source":"renewables"},{"Entity":"Mexico","Year":2017,"energy":55.88,"source":"renewables"},{"Entity":"Mexico","Year":2018,"energy":58.78,"source":"renewables"},{"Entity":"Mexico","Year":2019,"energy":59,"source":"renewables"},{"Entity":"Mexico","Year":2020,"energy":69.19,"source":"renewables"},{"Entity":"Poland","Year":2000,"energy":2.33,"source":"renewables"},{"Entity":"Poland","Year":2001,"energy":2.78,"source":"renewables"},{"Entity":"Poland","Year":2002,"energy":2.77,"source":"renewables"},{"Entity":"Poland","Year":2003,"energy":2.25,"source":"renewables"},{"Entity":"Poland","Year":2004,"energy":3.2,"source":"renewables"},{"Entity":"Poland","Year":2005,"energy":3.85,"source":"renewables"},{"Entity":"Poland","Year":2006,"energy":4.29,"source":"renewables"},{"Entity":"Poland","Year":2007,"energy":5.43,"source":"renewables"},{"Entity":"Poland","Year":2008,"energy":6.61,"source":"renewables"},{"Entity":"Poland","Year":2009,"energy":8.69,"source":"renewables"},{"Entity":"Poland","Year":2010,"energy":10.88,"source":"renewables"},{"Entity":"Poland","Year":2011,"energy":13.13,"source":"renewables"},{"Entity":"Poland","Year":2012,"energy":16.88,"source":"renewables"},{"Entity":"Poland","Year":2013,"energy":17.06,"source":"renewables"},{"Entity":"Poland","Year":2014,"energy":19.85,"source":"renewables"},{"Entity":"Poland","Year":2015,"energy":22.69,"source":"renewables"},{"Entity":"Poland","Year":2016,"energy":22.81,"source":"renewables"},{"Entity":"Poland","Year":2017,"energy":24.13,"source":"renewables"},{"Entity":"Poland","Year":2018,"energy":21.62,"source":"renewables"},{"Entity":"Poland","Year":2019,"energy":25.46,"source":"renewables"},{"Entity":"Poland","Year":2020,"energy":28.23,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2000,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2001,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2002,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2003,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2004,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2005,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2006,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2007,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2008,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2009,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2010,"energy":0,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2011,"energy":0.01,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2012,"energy":0.03,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2013,"energy":0.04,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2014,"energy":0.05,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2015,"energy":0.05,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2016,"energy":0.05,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2017,"energy":0.07,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2018,"energy":0.16,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2019,"energy":0.21,"source":"renewables"},{"Entity":"Saudi Arabia","Year":2020,"energy":0.21,"source":"renewables"},{"Entity":"South Africa","Year":2000,"energy":1.79,"source":"renewables"},{"Entity":"South Africa","Year":2001,"energy":2.46,"source":"renewables"},{"Entity":"South Africa","Year":2002,"energy":2.81,"source":"renewables"},{"Entity":"South Africa","Year":2003,"energy":1.19,"source":"renewables"},{"Entity":"South Africa","Year":2004,"energy":1.33,"source":"renewables"},{"Entity":"South Africa","Year":2005,"energy":1.75,"source":"renewables"},{"Entity":"South Africa","Year":2006,"energy":3.28,"source":"renewables"},{"Entity":"South Africa","Year":2007,"energy":1.3,"source":"renewables"},{"Entity":"South Africa","Year":2008,"energy":1.66,"source":"renewables"},{"Entity":"South Africa","Year":2009,"energy":1.86,"source":"renewables"},{"Entity":"South Africa","Year":2010,"energy":2.51,"source":"renewables"},{"Entity":"South Africa","Year":2011,"energy":2.49,"source":"renewables"},{"Entity":"South Africa","Year":2012,"energy":1.66,"source":"renewables"},{"Entity":"South Africa","Year":2013,"energy":1.62,"source":"renewables"},{"Entity":"South Africa","Year":2014,"energy":3.38,"source":"renewables"},{"Entity":"South Africa","Year":2015,"energy":6.09,"source":"renewables"},{"Entity":"South Africa","Year":2016,"energy":7.69,"source":"renewables"},{"Entity":"South Africa","Year":2017,"energy":10.04,"source":"renewables"},{"Entity":"South Africa","Year":2018,"energy":12.22,"source":"renewables"},{"Entity":"South Africa","Year":2019,"energy":12.57,"source":"renewables"},{"Entity":"South Africa","Year":2020,"energy":12.83,"source":"renewables"},{"Entity":"Spain","Year":2000,"energy":34.49,"source":"renewables"},{"Entity":"Spain","Year":2001,"energy":49.3,"source":"renewables"},{"Entity":"Spain","Year":2002,"energy":33.17,"source":"renewables"},{"Entity":"Spain","Year":2003,"energy":55.75,"source":"renewables"},{"Entity":"Spain","Year":2004,"energy":50.13,"source":"renewables"},{"Entity":"Spain","Year":2005,"energy":42.27,"source":"renewables"},{"Entity":"Spain","Year":2006,"energy":52.15,"source":"renewables"},{"Entity":"Spain","Year":2007,"energy":58.3,"source":"renewables"},{"Entity":"Spain","Year":2008,"energy":62.15,"source":"renewables"},{"Entity":"Spain","Year":2009,"energy":74.08,"source":"renewables"},{"Entity":"Spain","Year":2010,"energy":97.77,"source":"renewables"},{"Entity":"Spain","Year":2011,"energy":87.53,"source":"renewables"},{"Entity":"Spain","Year":2012,"energy":86.97,"source":"renewables"},{"Entity":"Spain","Year":2013,"energy":111.42,"source":"renewables"},{"Entity":"Spain","Year":2014,"energy":110.26,"source":"renewables"},{"Entity":"Spain","Year":2015,"energy":97.09,"source":"renewables"},{"Entity":"Spain","Year":2016,"energy":104.63,"source":"renewables"},{"Entity":"Spain","Year":2017,"energy":87.93,"source":"renewables"},{"Entity":"Spain","Year":2018,"energy":103.88,"source":"renewables"},{"Entity":"Spain","Year":2019,"energy":100.99,"source":"renewables"},{"Entity":"Spain","Year":2020,"energy":113.79,"source":"renewables"},{"Entity":"Thailand","Year":2000,"energy":6.38,"source":"renewables"},{"Entity":"Thailand","Year":2001,"energy":6.76,"source":"renewables"},{"Entity":"Thailand","Year":2002,"energy":8.07,"source":"renewables"},{"Entity":"Thailand","Year":2003,"energy":8.36,"source":"renewables"},{"Entity":"Thailand","Year":2004,"energy":7.63,"source":"renewables"},{"Entity":"Thailand","Year":2005,"energy":7.42,"source":"renewables"},{"Entity":"Thailand","Year":2006,"energy":9.82,"source":"renewables"},{"Entity":"Thailand","Year":2007,"energy":10.2,"source":"renewables"},{"Entity":"Thailand","Year":2008,"energy":8.95,"source":"renewables"},{"Entity":"Thailand","Year":2009,"energy":9.09,"source":"renewables"},{"Entity":"Thailand","Year":2010,"energy":8.58,"source":"renewables"},{"Entity":"Thailand","Year":2011,"energy":11.83,"source":"renewables"},{"Entity":"Thailand","Year":2012,"energy":13.42,"source":"renewables"},{"Entity":"Thailand","Year":2013,"energy":12.33,"source":"renewables"},{"Entity":"Thailand","Year":2014,"energy":13.68,"source":"renewables"},{"Entity":"Thailand","Year":2015,"energy":13.33,"source":"renewables"},{"Entity":"Thailand","Year":2016,"energy":15.97,"source":"renewables"},{"Entity":"Thailand","Year":2017,"energy":19.92,"source":"renewables"},{"Entity":"Thailand","Year":2018,"energy":25.84,"source":"renewables"},{"Entity":"Thailand","Year":2019,"energy":28.02,"source":"renewables"},{"Entity":"Thailand","Year":2020,"energy":24.73,"source":"renewables"},{"Entity":"Ukraine","Year":2000,"energy":11.28,"source":"renewables"},{"Entity":"Ukraine","Year":2001,"energy":12.05,"source":"renewables"},{"Entity":"Ukraine","Year":2002,"energy":9.65,"source":"renewables"},{"Entity":"Ukraine","Year":2003,"energy":9.27,"source":"renewables"},{"Entity":"Ukraine","Year":2004,"energy":11.78,"source":"renewables"},{"Entity":"Ukraine","Year":2005,"energy":12.4,"source":"renewables"},{"Entity":"Ukraine","Year":2006,"energy":12.92,"source":"renewables"},{"Entity":"Ukraine","Year":2007,"energy":10.47,"source":"renewables"},{"Entity":"Ukraine","Year":2008,"energy":11.82,"source":"renewables"},{"Entity":"Ukraine","Year":2009,"energy":12.12,"source":"renewables"},{"Entity":"Ukraine","Year":2010,"energy":13.39,"source":"renewables"},{"Entity":"Ukraine","Year":2011,"energy":11.2,"source":"renewables"},{"Entity":"Ukraine","Year":2012,"energy":11.23,"source":"renewables"},{"Entity":"Ukraine","Year":2013,"energy":15.11,"source":"renewables"},{"Entity":"Ukraine","Year":2014,"energy":10.17,"source":"renewables"},{"Entity":"Ukraine","Year":2015,"energy":7.1,"source":"renewables"},{"Entity":"Ukraine","Year":2016,"energy":9.25,"source":"renewables"},{"Entity":"Ukraine","Year":2017,"energy":10.88,"source":"renewables"},{"Entity":"Ukraine","Year":2018,"energy":13.02,"source":"renewables"},{"Entity":"Ukraine","Year":2019,"energy":11.87,"source":"renewables"},{"Entity":"Ukraine","Year":2020,"energy":17.56,"source":"renewables"},{"Entity":"United Kingdom","Year":2000,"energy":9.98,"source":"renewables"},{"Entity":"United Kingdom","Year":2001,"energy":9.56,"source":"renewables"},{"Entity":"United Kingdom","Year":2002,"energy":11.13,"source":"renewables"},{"Entity":"United Kingdom","Year":2003,"energy":10.62,"source":"renewables"},{"Entity":"United Kingdom","Year":2004,"energy":14.14,"source":"renewables"},{"Entity":"United Kingdom","Year":2005,"energy":16.93,"source":"renewables"},{"Entity":"United Kingdom","Year":2006,"energy":18.11,"source":"renewables"},{"Entity":"United Kingdom","Year":2007,"energy":19.69,"source":"renewables"},{"Entity":"United Kingdom","Year":2008,"energy":21.85,"source":"renewables"},{"Entity":"United Kingdom","Year":2009,"energy":25.25,"source":"renewables"},{"Entity":"United Kingdom","Year":2010,"energy":26.18,"source":"renewables"},{"Entity":"United Kingdom","Year":2011,"energy":35.2,"source":"renewables"},{"Entity":"United Kingdom","Year":2012,"energy":41.24,"source":"renewables"},{"Entity":"United Kingdom","Year":2013,"energy":53.21,"source":"renewables"},{"Entity":"United Kingdom","Year":2014,"energy":64.52,"source":"renewables"},{"Entity":"United Kingdom","Year":2015,"energy":82.57,"source":"renewables"},{"Entity":"United Kingdom","Year":2016,"energy":82.99,"source":"renewables"},{"Entity":"United Kingdom","Year":2017,"energy":98.85,"source":"renewables"},{"Entity":"United Kingdom","Year":2018,"energy":110.03,"source":"renewables"},{"Entity":"United Kingdom","Year":2019,"energy":120.48,"source":"renewables"},{"Entity":"United Kingdom","Year":2020,"energy":131.74,"source":"renewables"},{"Entity":"United States","Year":2000,"energy":350.93,"source":"renewables"},{"Entity":"United States","Year":2001,"energy":280.06,"source":"renewables"},{"Entity":"United States","Year":2002,"energy":336.34,"source":"renewables"},{"Entity":"United States","Year":2003,"energy":349.18,"source":"renewables"},{"Entity":"United States","Year":2004,"energy":345.14,"source":"renewables"},{"Entity":"United States","Year":2005,"energy":353.04,"source":"renewables"},{"Entity":"United States","Year":2006,"energy":381.16,"source":"renewables"},{"Entity":"United States","Year":2007,"energy":347.91,"source":"renewables"},{"Entity":"United States","Year":2008,"energy":377.11,"source":"renewables"},{"Entity":"United States","Year":2009,"energy":415.56,"source":"renewables"},{"Entity":"United States","Year":2010,"energy":424.48,"source":"renewables"},{"Entity":"United States","Year":2011,"energy":509.74,"source":"renewables"},{"Entity":"United States","Year":2012,"energy":492.32,"source":"renewables"},{"Entity":"United States","Year":2013,"energy":520.38,"source":"renewables"},{"Entity":"United States","Year":2014,"energy":546.83,"source":"renewables"},{"Entity":"United States","Year":2015,"energy":556.49,"source":"renewables"},{"Entity":"United States","Year":2016,"energy":624.91,"source":"renewables"},{"Entity":"United States","Year":2017,"energy":707.19,"source":"renewables"},{"Entity":"United States","Year":2018,"energy":733.17,"source":"renewables"},{"Entity":"United States","Year":2019,"energy":760.76,"source":"renewables"},{"Entity":"United States","Year":2020,"energy":821.4,"source":"renewables"}],"metadata":{"Entity":{"type":"string","semanticType":"Location"},"Year":{"type":"number","semanticType":"Year"},"energy":{"type":"number","semanticType":"Number"},"source":{"type":"string","semanticType":"String","levels":["fossil fuels","nuclear","renewables"]}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Unpivot the energy source columns into long format\n    transformed_df = pd.melt(\n        df_energy,\n        id_vars=['Year', 'Entity'],\n        value_vars=[\n            'Electricity from fossil fuels (TWh)',\n            'Electricity from nuclear (TWh)',\n            'Electricity from renewables (TWh)'\n        ],\n        var_name='source',\n        value_name='energy'\n    )\n    \n    # Clean up the source names to be more readable\n    transformed_df['source'] = transformed_df['source'].str.replace('Electricity from ', '').str.replace(' (TWh)', '')\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 158029.9988, 190729.9957, 209229.9957, ..., 6993180.176, 9861099.609, 9874660.156, 10096009.77\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 90.14, 91.79, 92.54, 804.95\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"\",\n    \"chart_type\": \"Line Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Transform the data into a long format where different energy sources (fossil fuels, nuclear, renewables) are unpivoted into separate rows. Each row should contain the year, entity (country), energy source type, and the corresponding energy value in TWh. This will enable visualization of energy generation trends over time by source and country.\",\n    \"display_instruction\": \"Show **energy generation** trends by **source** and **Entity** over **Year**\",\n    \"output_fields\": [\"Year\", \"Entity\", \"source\", \"energy\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    },\n    \"reason\": \"The user wants to visualize energy data across different sources with a line chart faceted by source. The original data has energy sources in separate columns (fossil fuels, nuclear, renewables), so we need to unpivot these columns into a long format with 'source' and 'energy' fields. The chart_encodings provided by the user are appropriate for this visualization goal, using faceting (column) to separate different energy sources.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Unpivot the energy source columns into long format\n    transformed_df = pd.melt(\n        df_energy,\n        id_vars=['Year', 'Entity'],\n        value_vars=[\n            'Electricity from fossil fuels (TWh)',\n            'Electricity from nuclear (TWh)',\n            'Electricity from renewables (TWh)'\n        ],\n        var_name='source',\n        value_name='energy'\n    )\n    \n    # Clean up the source names to be more readable\n    transformed_df['source'] = transformed_df['source'].str.replace('Electricity from ', '').str.replace(' (TWh)', '')\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"global-energy-20-small.csv","sourceTableIds":["global-energy-20-small.csv"],"instruction":"","displayInstruction":"Show **energy generation** trends by **source** and **Entity** over **Year**","chart":{"id":"chart-1760738394155","chartType":"Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"channel":"y","bin":false,"fieldID":"concept-1760738385163"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"opacity":{"channel":"opacity","bin":false},"column":{"channel":"column","bin":false,"fieldID":"concept-1760738389404"},"row":{"channel":"row","bin":false}},"tableRef":"global-energy-20-small.csv","saved":false,"source":"trigger","unread":false},"resultTableId":"table-82"},"explanation":{"agent":"CodeExplanationAgent","code":"The code performs a data transformation to restructure the energy data from a wide format to a long format:\n\n1. **Unpivot energy columns**: Uses `pd.melt()` to transform the three energy source columns (**Electricity from fossil fuels**, **Electricity from nuclear**, and **Electricity from renewables**) from separate columns into rows, while keeping **Year** and **Entity** as identifier columns.\n\n2. **Create source classification**: Generates a new **source** column that captures which energy type each row represents, and stores the corresponding energy values in an **energy** column.\n\n3. **Clean source labels**: Removes the prefix \"Electricity from \" and suffix \" (TWh)\" from the source names, resulting in cleaner labels: **fossil fuels**, **nuclear**, and **renewables**.\n\n4. **Return restructured data**: The final dataset has each country-year-energy source combination as a separate row, making it easier to analyze and visualize energy mix across countries and time periods.","concepts":[],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 190729.9957, 227580.0018, 233600.0061, ..., 5736319.824, 5738290.039, nan, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 90.14, 91.79, 92.54, nan\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Unpivot the energy source columns into long format\n    transformed_df = pd.melt(\n        df_energy,\n        id_vars=['Year', 'Entity'],\n        value_vars=[\n            'Electricity from fossil fuels (TWh)',\n            'Electricity from nuclear (TWh)',\n            'Electricity from renewables (TWh)'\n        ],\n        var_name='source',\n        value_name='energy'\n    )\n    \n    # Clean up the source names to be more readable\n    transformed_df['source'] = transformed_df['source'].str.replace('Electricity from ', '').str.replace(' (TWh)', '')\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\nThe code performs a data transformation to restructure the energy data from a wide format to a long format:\n\n1. **Unpivot energy columns**: Uses `pd.melt()` to transform the three energy source columns (**Electricity from fossil fuels**, **Electricity from nuclear**, and **Electricity from renewables**) from separate columns into rows, while keeping **Year** and **Entity** as identifier columns.\n\n2. **Create source classification**: Generates a new **source** column that captures which energy type each row represents, and stores the corresponding energy values in an **energy** column.\n\n3. **Clean source labels**: Removes the prefix \"Electricity from \" and suffix \" (TWh)\" from the source names, resulting in cleaner labels: **fossil fuels**, **nuclear**, and **renewables**.\n\n4. **Return restructured data**: The final dataset has each country-year-energy source combination as a separate row, making it easier to analyze and visualize energy mix across countries and time periods.\n\n[CONCEPTS EXPLANATION]\n\n```json\n[]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""},{"id":"table-45","displayId":"renewable-energy","names":["Entity","Year","renewable_percentage"],"rows":[{"Entity":"Australia","Year":2000,"renewable_percentage":8.6344368187},{"Entity":"Australia","Year":2001,"renewable_percentage":8.2180135078},{"Entity":"Australia","Year":2002,"renewable_percentage":8.0833022736},{"Entity":"Australia","Year":2003,"renewable_percentage":8.6598324205},{"Entity":"Australia","Year":2004,"renewable_percentage":8.7013045232},{"Entity":"Australia","Year":2005,"renewable_percentage":9.1562355123},{"Entity":"Australia","Year":2006,"renewable_percentage":9.6357600837},{"Entity":"Australia","Year":2007,"renewable_percentage":9.1190310213},{"Entity":"Australia","Year":2008,"renewable_percentage":8.0548900022},{"Entity":"Australia","Year":2009,"renewable_percentage":7.8043793133},{"Entity":"Australia","Year":2010,"renewable_percentage":9.0442152121},{"Entity":"Australia","Year":2011,"renewable_percentage":11.3454273735},{"Entity":"Australia","Year":2012,"renewable_percentage":11.4105750279},{"Entity":"Australia","Year":2013,"renewable_percentage":14.8708583355},{"Entity":"Australia","Year":2014,"renewable_percentage":14.9621290509},{"Entity":"Australia","Year":2015,"renewable_percentage":14.3476000693},{"Entity":"Australia","Year":2016,"renewable_percentage":15.6093794449},{"Entity":"Australia","Year":2017,"renewable_percentage":16.3138729943},{"Entity":"Australia","Year":2018,"renewable_percentage":17.145938174},{"Entity":"Australia","Year":2019,"renewable_percentage":21.3759705435},{"Entity":"Australia","Year":2020,"renewable_percentage":25.5031684668},{"Entity":"Brazil","Year":2000,"renewable_percentage":90.1307723743},{"Entity":"Brazil","Year":2001,"renewable_percentage":84.6953615744},{"Entity":"Brazil","Year":2002,"renewable_percentage":86.0883364189},{"Entity":"Brazil","Year":2003,"renewable_percentage":87.4561159097},{"Entity":"Brazil","Year":2004,"renewable_percentage":86.4260041451},{"Entity":"Brazil","Year":2005,"renewable_percentage":87.6781562721},{"Entity":"Brazil","Year":2006,"renewable_percentage":87.2842473236},{"Entity":"Brazil","Year":2007,"renewable_percentage":88.7252098726},{"Entity":"Brazil","Year":2008,"renewable_percentage":84.8072313004},{"Entity":"Brazil","Year":2009,"renewable_percentage":89.4172280725},{"Entity":"Brazil","Year":2010,"renewable_percentage":85.3576882415},{"Entity":"Brazil","Year":2011,"renewable_percentage":87.6618820986},{"Entity":"Brazil","Year":2012,"renewable_percentage":83.1164558813},{"Entity":"Brazil","Year":2013,"renewable_percentage":77.5240022006},{"Entity":"Brazil","Year":2014,"renewable_percentage":74.0418657409},{"Entity":"Brazil","Year":2015,"renewable_percentage":75.0231817625},{"Entity":"Brazil","Year":2016,"renewable_percentage":81.0938046902},{"Entity":"Brazil","Year":2017,"renewable_percentage":79.9091472228},{"Entity":"Brazil","Year":2018,"renewable_percentage":82.9198505403},{"Entity":"Brazil","Year":2019,"renewable_percentage":82.8548799017},{"Entity":"Brazil","Year":2020,"renewable_percentage":84.6411771408},{"Entity":"Canada","Year":2000,"renewable_percentage":61.8095917882},{"Entity":"Canada","Year":2001,"renewable_percentage":59.3287558747},{"Entity":"Canada","Year":2002,"renewable_percentage":61.1477403113},{"Entity":"Canada","Year":2003,"renewable_percentage":60.0789685174},{"Entity":"Canada","Year":2004,"renewable_percentage":59.6967771845},{"Entity":"Canada","Year":2005,"renewable_percentage":60.8208155391},{"Entity":"Canada","Year":2006,"renewable_percentage":60.8271602855},{"Entity":"Canada","Year":2007,"renewable_percentage":61.2460642446},{"Entity":"Canada","Year":2008,"renewable_percentage":62.6520720838},{"Entity":"Canada","Year":2009,"renewable_percentage":63.8919227732},{"Entity":"Canada","Year":2010,"renewable_percentage":62.9421470558},{"Entity":"Canada","Year":2011,"renewable_percentage":64.0922915917},{"Entity":"Canada","Year":2012,"renewable_percentage":65.098730952},{"Entity":"Canada","Year":2013,"renewable_percentage":65.4320794066},{"Entity":"Canada","Year":2014,"renewable_percentage":64.791145907},{"Entity":"Canada","Year":2015,"renewable_percentage":65.2946239925},{"Entity":"Canada","Year":2016,"renewable_percentage":66.1890584295},{"Entity":"Canada","Year":2017,"renewable_percentage":67.5399410579},{"Entity":"Canada","Year":2018,"renewable_percentage":67.3685700357},{"Entity":"Canada","Year":2019,"renewable_percentage":67.1741623137},{"Entity":"Canada","Year":2020,"renewable_percentage":68.7796436354},{"Entity":"China","Year":2000,"renewable_percentage":16.639126586},{"Entity":"China","Year":2001,"renewable_percentage":18.9581237042},{"Entity":"China","Year":2002,"renewable_percentage":17.6185006046},{"Entity":"China","Year":2003,"renewable_percentage":15.0362717081},{"Entity":"China","Year":2004,"renewable_percentage":16.2224108273},{"Entity":"China","Year":2005,"renewable_percentage":16.1731179957},{"Entity":"China","Year":2006,"renewable_percentage":15.5884036124},{"Entity":"China","Year":2007,"renewable_percentage":15.2583847828},{"Entity":"China","Year":2008,"renewable_percentage":19.0253335469},{"Entity":"China","Year":2009,"renewable_percentage":17.8857170547},{"Entity":"China","Year":2010,"renewable_percentage":18.7800759915},{"Entity":"China","Year":2011,"renewable_percentage":16.8902341543},{"Entity":"China","Year":2012,"renewable_percentage":20.122965176},{"Entity":"China","Year":2013,"renewable_percentage":20.2152481955},{"Entity":"China","Year":2014,"renewable_percentage":22.3502204285},{"Entity":"China","Year":2015,"renewable_percentage":24.079270189},{"Entity":"China","Year":2016,"renewable_percentage":25.0007798429},{"Entity":"China","Year":2017,"renewable_percentage":25.419242299},{"Entity":"China","Year":2018,"renewable_percentage":25.7747942589},{"Entity":"China","Year":2019,"renewable_percentage":26.9995671106},{"Entity":"China","Year":2020,"renewable_percentage":28.2464606924},{"Entity":"France","Year":2000,"renewable_percentage":12.7117691154},{"Entity":"France","Year":2001,"renewable_percentage":13.9961372206},{"Entity":"France","Year":2002,"renewable_percentage":11.3544157067},{"Entity":"France","Year":2003,"renewable_percentage":10.9783540506},{"Entity":"France","Year":2004,"renewable_percentage":11.0051305559},{"Entity":"France","Year":2005,"renewable_percentage":9.6479837153},{"Entity":"France","Year":2006,"renewable_percentage":10.7235915493},{"Entity":"France","Year":2007,"renewable_percentage":11.4370075239},{"Entity":"France","Year":2008,"renewable_percentage":12.7487441615},{"Entity":"France","Year":2009,"renewable_percentage":12.8776856068},{"Entity":"France","Year":2010,"renewable_percentage":13.6240072491},{"Entity":"France","Year":2011,"renewable_percentage":11.63553049},{"Entity":"France","Year":2012,"renewable_percentage":15.0331522889},{"Entity":"France","Year":2013,"renewable_percentage":17.2469424928},{"Entity":"France","Year":2014,"renewable_percentage":16.6074992494},{"Entity":"France","Year":2015,"renewable_percentage":16.002230276},{"Entity":"France","Year":2016,"renewable_percentage":17.7212924013},{"Entity":"France","Year":2017,"renewable_percentage":16.6576751547},{"Entity":"France","Year":2018,"renewable_percentage":19.7315179827},{"Entity":"France","Year":2019,"renewable_percentage":20.0116665488},{"Entity":"France","Year":2020,"renewable_percentage":23.7610241821},{"Entity":"Germany","Year":2000,"renewable_percentage":6.1977983575},{"Entity":"Germany","Year":2001,"renewable_percentage":6.5132585197},{"Entity":"Germany","Year":2002,"renewable_percentage":7.6431369854},{"Entity":"Germany","Year":2003,"renewable_percentage":7.7455438643},{"Entity":"Germany","Year":2004,"renewable_percentage":9.4989185292},{"Entity":"Germany","Year":2005,"renewable_percentage":10.3356645637},{"Entity":"Germany","Year":2006,"renewable_percentage":11.5129959829},{"Entity":"Germany","Year":2007,"renewable_percentage":14.135471525},{"Entity":"Germany","Year":2008,"renewable_percentage":14.8894504106},{"Entity":"Germany","Year":2009,"renewable_percentage":16.2902842395},{"Entity":"Germany","Year":2010,"renewable_percentage":16.8384989754},{"Entity":"Germany","Year":2011,"renewable_percentage":20.4967199299},{"Entity":"Germany","Year":2012,"renewable_percentage":23.056464482},{"Entity":"Germany","Year":2013,"renewable_percentage":24.1368929731},{"Entity":"Germany","Year":2014,"renewable_percentage":26.2182434067},{"Entity":"Germany","Year":2015,"renewable_percentage":29.4721888318},{"Entity":"Germany","Year":2016,"renewable_percentage":29.4990435013},{"Entity":"Germany","Year":2017,"renewable_percentage":33.4855497593},{"Entity":"Germany","Year":2018,"renewable_percentage":35.0976735365},{"Entity":"Germany","Year":2019,"renewable_percentage":40.0890757144},{"Entity":"Germany","Year":2020,"renewable_percentage":44.3324048937},{"Entity":"India","Year":2000,"renewable_percentage":14.0481982534},{"Entity":"India","Year":2001,"renewable_percentage":12.9997099422},{"Entity":"India","Year":2002,"renewable_percentage":11.938193032},{"Entity":"India","Year":2003,"renewable_percentage":11.695109147},{"Entity":"India","Year":2004,"renewable_percentage":15.6375300722},{"Entity":"India","Year":2005,"renewable_percentage":15.2543575768},{"Entity":"India","Year":2006,"renewable_percentage":17.1352578483},{"Entity":"India","Year":2007,"renewable_percentage":17.8019742295},{"Entity":"India","Year":2008,"renewable_percentage":16.768266921},{"Entity":"India","Year":2009,"renewable_percentage":15.269804822},{"Entity":"India","Year":2010,"renewable_percentage":15.2122201244},{"Entity":"India","Year":2011,"renewable_percentage":16.7911025145},{"Entity":"India","Year":2012,"renewable_percentage":15.1350014654},{"Entity":"India","Year":2013,"renewable_percentage":16.3941577818},{"Entity":"India","Year":2014,"renewable_percentage":16.0092550039},{"Entity":"India","Year":2015,"renewable_percentage":15.3718720687},{"Entity":"India","Year":2016,"renewable_percentage":14.8548475703},{"Entity":"India","Year":2017,"renewable_percentage":15.9669920335},{"Entity":"India","Year":2018,"renewable_percentage":16.6949549709},{"Entity":"India","Year":2019,"renewable_percentage":18.6915426873},{"Entity":"India","Year":2020,"renewable_percentage":20.2059243238},{"Entity":"Indonesia","Year":2000,"renewable_percentage":null},{"Entity":"Indonesia","Year":2001,"renewable_percentage":null},{"Entity":"Indonesia","Year":2002,"renewable_percentage":null},{"Entity":"Indonesia","Year":2003,"renewable_percentage":null},{"Entity":"Indonesia","Year":2004,"renewable_percentage":null},{"Entity":"Indonesia","Year":2005,"renewable_percentage":null},{"Entity":"Indonesia","Year":2006,"renewable_percentage":null},{"Entity":"Indonesia","Year":2007,"renewable_percentage":null},{"Entity":"Indonesia","Year":2008,"renewable_percentage":null},{"Entity":"Indonesia","Year":2009,"renewable_percentage":null},{"Entity":"Indonesia","Year":2010,"renewable_percentage":null},{"Entity":"Indonesia","Year":2011,"renewable_percentage":null},{"Entity":"Indonesia","Year":2012,"renewable_percentage":null},{"Entity":"Indonesia","Year":2013,"renewable_percentage":null},{"Entity":"Indonesia","Year":2014,"renewable_percentage":null},{"Entity":"Indonesia","Year":2015,"renewable_percentage":null},{"Entity":"Indonesia","Year":2016,"renewable_percentage":null},{"Entity":"Indonesia","Year":2017,"renewable_percentage":null},{"Entity":"Indonesia","Year":2018,"renewable_percentage":null},{"Entity":"Indonesia","Year":2019,"renewable_percentage":null},{"Entity":"Indonesia","Year":2020,"renewable_percentage":null},{"Entity":"Italy","Year":2000,"renewable_percentage":18.900241501},{"Entity":"Italy","Year":2001,"renewable_percentage":20.049431902},{"Entity":"Italy","Year":2002,"renewable_percentage":17.4555571614},{"Entity":"Italy","Year":2003,"renewable_percentage":16.4202116476},{"Entity":"Italy","Year":2004,"renewable_percentage":18.2749380999},{"Entity":"Italy","Year":2005,"renewable_percentage":16.3769782226},{"Entity":"Italy","Year":2006,"renewable_percentage":16.5128639906},{"Entity":"Italy","Year":2007,"renewable_percentage":15.5333485238},{"Entity":"Italy","Year":2008,"renewable_percentage":18.6112},{"Entity":"Italy","Year":2009,"renewable_percentage":24.0837332221},{"Entity":"Italy","Year":2010,"renewable_percentage":25.8400187976},{"Entity":"Italy","Year":2011,"renewable_percentage":27.6773203443},{"Entity":"Italy","Year":2012,"renewable_percentage":31.1049649217},{"Entity":"Italy","Year":2013,"renewable_percentage":39.0148744209},{"Entity":"Italy","Year":2014,"renewable_percentage":43.4976931949},{"Entity":"Italy","Year":2015,"renewable_percentage":38.7577860829},{"Entity":"Italy","Year":2016,"renewable_percentage":37.6079387187},{"Entity":"Italy","Year":2017,"renewable_percentage":35.4174479255},{"Entity":"Italy","Year":2018,"renewable_percentage":39.8100142663},{"Entity":"Italy","Year":2019,"renewable_percentage":39.7563068474},{"Entity":"Italy","Year":2020,"renewable_percentage":42.0397741576},{"Entity":"Japan","Year":2000,"renewable_percentage":10.5382436261},{"Entity":"Japan","Year":2001,"renewable_percentage":10.447653504},{"Entity":"Japan","Year":2002,"renewable_percentage":10.2477294843},{"Entity":"Japan","Year":2003,"renewable_percentage":11.6993698448},{"Entity":"Japan","Year":2004,"renewable_percentage":11.4198974767},{"Entity":"Japan","Year":2005,"renewable_percentage":9.9068127192},{"Entity":"Japan","Year":2006,"renewable_percentage":10.8554989442},{"Entity":"Japan","Year":2007,"renewable_percentage":9.3897588285},{"Entity":"Japan","Year":2008,"renewable_percentage":10.0196834738},{"Entity":"Japan","Year":2009,"renewable_percentage":10.4667464874},{"Entity":"Japan","Year":2010,"renewable_percentage":10.5269966826},{"Entity":"Japan","Year":2011,"renewable_percentage":11.1272421632},{"Entity":"Japan","Year":2012,"renewable_percentage":10.6143703421},{"Entity":"Japan","Year":2013,"renewable_percentage":11.7965798852},{"Entity":"Japan","Year":2014,"renewable_percentage":13.2719619718},{"Entity":"Japan","Year":2015,"renewable_percentage":15.6586817408},{"Entity":"Japan","Year":2016,"renewable_percentage":15.6920107068},{"Entity":"Japan","Year":2017,"renewable_percentage":17.3559698312},{"Entity":"Japan","Year":2018,"renewable_percentage":18.144181175},{"Entity":"Japan","Year":2019,"renewable_percentage":19.4223288251},{"Entity":"Japan","Year":2020,"renewable_percentage":21.324925062},{"Entity":"Kazakhstan","Year":2000,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2001,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2002,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2003,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2004,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2005,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2006,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2007,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2008,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2009,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2010,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2011,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2012,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2013,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2014,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2015,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2016,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2017,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2018,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2019,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2020,"renewable_percentage":null},{"Entity":"Mexico","Year":2000,"renewable_percentage":22.9291160107},{"Entity":"Mexico","Year":2001,"renewable_percentage":19.6649599841},{"Entity":"Mexico","Year":2002,"renewable_percentage":17.4220963173},{"Entity":"Mexico","Year":2003,"renewable_percentage":15.8536585366},{"Entity":"Mexico","Year":2004,"renewable_percentage":17.3134463687},{"Entity":"Mexico","Year":2005,"renewable_percentage":18.2780827246},{"Entity":"Mexico","Year":2006,"renewable_percentage":18.4256091896},{"Entity":"Mexico","Year":2007,"renewable_percentage":17.2761561168},{"Entity":"Mexico","Year":2008,"renewable_percentage":21.5387105913},{"Entity":"Mexico","Year":2009,"renewable_percentage":16.5369729069},{"Entity":"Mexico","Year":2010,"renewable_percentage":19.4281608109},{"Entity":"Mexico","Year":2011,"renewable_percentage":18.0916357408},{"Entity":"Mexico","Year":2012,"renewable_percentage":16.5759438104},{"Entity":"Mexico","Year":2013,"renewable_percentage":15.5492898914},{"Entity":"Mexico","Year":2014,"renewable_percentage":19.8008201523},{"Entity":"Mexico","Year":2015,"renewable_percentage":17.5976903451},{"Entity":"Mexico","Year":2016,"renewable_percentage":17.4806943436},{"Entity":"Mexico","Year":2017,"renewable_percentage":18.0759526428},{"Entity":"Mexico","Year":2018,"renewable_percentage":17.703752786},{"Entity":"Mexico","Year":2019,"renewable_percentage":18.5487927565},{"Entity":"Mexico","Year":2020,"renewable_percentage":21.2552224134},{"Entity":"Poland","Year":2000,"renewable_percentage":1.6273222517},{"Entity":"Poland","Year":2001,"renewable_percentage":1.934316727},{"Entity":"Poland","Year":2002,"renewable_percentage":1.9439960699},{"Entity":"Poland","Year":2003,"renewable_percentage":1.4999000067},{"Entity":"Poland","Year":2004,"renewable_percentage":2.1016681991},{"Entity":"Poland","Year":2005,"renewable_percentage":2.4830699774},{"Entity":"Poland","Year":2006,"renewable_percentage":2.673730134},{"Entity":"Poland","Year":2007,"renewable_percentage":3.4256513785},{"Entity":"Poland","Year":2008,"renewable_percentage":4.2744438696},{"Entity":"Poland","Year":2009,"renewable_percentage":5.7515388179},{"Entity":"Poland","Year":2010,"renewable_percentage":6.9299363057},{"Entity":"Poland","Year":2011,"renewable_percentage":8.0547205693},{"Entity":"Poland","Year":2012,"renewable_percentage":10.4436057663},{"Entity":"Poland","Year":2013,"renewable_percentage":10.4081508145},{"Entity":"Poland","Year":2014,"renewable_percentage":12.5331481248},{"Entity":"Poland","Year":2015,"renewable_percentage":13.8151485631},{"Entity":"Poland","Year":2016,"renewable_percentage":13.7335179722},{"Entity":"Poland","Year":2017,"renewable_percentage":14.1999646913},{"Entity":"Poland","Year":2018,"renewable_percentage":12.7559148032},{"Entity":"Poland","Year":2019,"renewable_percentage":15.6157998037},{"Entity":"Poland","Year":2020,"renewable_percentage":17.9648720886},{"Entity":"Saudi Arabia","Year":2000,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2001,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2002,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2003,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2004,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2005,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2006,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2007,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2008,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2009,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2010,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2011,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2012,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2013,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2014,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2015,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2016,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2017,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2018,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2019,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2020,"renewable_percentage":null},{"Entity":"South Africa","Year":2000,"renewable_percentage":0.9110805721},{"Entity":"South Africa","Year":2001,"renewable_percentage":1.2516536074},{"Entity":"South Africa","Year":2002,"renewable_percentage":1.3802249619},{"Entity":"South Africa","Year":2003,"renewable_percentage":0.545271261},{"Entity":"South Africa","Year":2004,"renewable_percentage":0.5827199439},{"Entity":"South Africa","Year":2005,"renewable_percentage":0.763458686},{"Entity":"South Africa","Year":2006,"renewable_percentage":1.3863060017},{"Entity":"South Africa","Year":2007,"renewable_percentage":0.5267209594},{"Entity":"South Africa","Year":2008,"renewable_percentage":0.6895692269},{"Entity":"South Africa","Year":2009,"renewable_percentage":0.8031088083},{"Entity":"South Africa","Year":2010,"renewable_percentage":1.0330068318},{"Entity":"South Africa","Year":2011,"renewable_percentage":1.0184465622},{"Entity":"South Africa","Year":2012,"renewable_percentage":0.6890826069},{"Entity":"South Africa","Year":2013,"renewable_percentage":0.6792168043},{"Entity":"South Africa","Year":2014,"renewable_percentage":1.4288129861},{"Entity":"South Africa","Year":2015,"renewable_percentage":2.6256790549},{"Entity":"South Africa","Year":2016,"renewable_percentage":3.2586126531},{"Entity":"South Africa","Year":2017,"renewable_percentage":4.2202606137},{"Entity":"South Africa","Year":2018,"renewable_percentage":5.1554655529},{"Entity":"South Africa","Year":2019,"renewable_percentage":5.3589699864},{"Entity":"South Africa","Year":2020,"renewable_percentage":5.780581212},{"Entity":"Spain","Year":2000,"renewable_percentage":15.6119862394},{"Entity":"Spain","Year":2001,"renewable_percentage":21.1524434719},{"Entity":"Spain","Year":2002,"renewable_percentage":13.8260180901},{"Entity":"Spain","Year":2003,"renewable_percentage":21.667314419},{"Entity":"Spain","Year":2004,"renewable_percentage":18.3190206468},{"Entity":"Spain","Year":2005,"renewable_percentage":14.8597342333},{"Entity":"Spain","Year":2006,"renewable_percentage":17.6623992413},{"Entity":"Spain","Year":2007,"renewable_percentage":19.3347262296},{"Entity":"Spain","Year":2008,"renewable_percentage":20.0051501593},{"Entity":"Spain","Year":2009,"renewable_percentage":25.4107639008},{"Entity":"Spain","Year":2010,"renewable_percentage":32.7922186819},{"Entity":"Spain","Year":2011,"renewable_percentage":30.0408415417},{"Entity":"Spain","Year":2012,"renewable_percentage":29.6047928652},{"Entity":"Spain","Year":2013,"renewable_percentage":39.5850357054},{"Entity":"Spain","Year":2014,"renewable_percentage":40.1032952644},{"Entity":"Spain","Year":2015,"renewable_percentage":34.9899091826},{"Entity":"Spain","Year":2016,"renewable_percentage":38.5818061138},{"Entity":"Spain","Year":2017,"renewable_percentage":32.220593624},{"Entity":"Spain","Year":2018,"renewable_percentage":38.2080329557},{"Entity":"Spain","Year":2019,"renewable_percentage":37.280815091},{"Entity":"Spain","Year":2020,"renewable_percentage":43.8108805298},{"Entity":"Thailand","Year":2000,"renewable_percentage":7.1261029822},{"Entity":"Thailand","Year":2001,"renewable_percentage":7.061527212},{"Entity":"Thailand","Year":2002,"renewable_percentage":7.9444772593},{"Entity":"Thailand","Year":2003,"renewable_percentage":7.6718362852},{"Entity":"Thailand","Year":2004,"renewable_percentage":6.5163549406},{"Entity":"Thailand","Year":2005,"renewable_percentage":6.0325203252},{"Entity":"Thailand","Year":2006,"renewable_percentage":7.5988547551},{"Entity":"Thailand","Year":2007,"renewable_percentage":7.7085852479},{"Entity":"Thailand","Year":2008,"renewable_percentage":6.5625458278},{"Entity":"Thailand","Year":2009,"renewable_percentage":6.6263303689},{"Entity":"Thailand","Year":2010,"renewable_percentage":5.7085828343},{"Entity":"Thailand","Year":2011,"renewable_percentage":8.039961941},{"Entity":"Thailand","Year":2012,"renewable_percentage":8.5396118358},{"Entity":"Thailand","Year":2013,"renewable_percentage":7.6765035487},{"Entity":"Thailand","Year":2014,"renewable_percentage":8.395728489},{"Entity":"Thailand","Year":2015,"renewable_percentage":7.9949619145},{"Entity":"Thailand","Year":2016,"renewable_percentage":8.9840234023},{"Entity":"Thailand","Year":2017,"renewable_percentage":10.9570957096},{"Entity":"Thailand","Year":2018,"renewable_percentage":14.1900054915},{"Entity":"Thailand","Year":2019,"renewable_percentage":14.7001731284},{"Entity":"Thailand","Year":2020,"renewable_percentage":13.7963737796},{"Entity":"Ukraine","Year":2000,"renewable_percentage":6.5860921352},{"Entity":"Ukraine","Year":2001,"renewable_percentage":6.9729761009},{"Entity":"Ukraine","Year":2002,"renewable_percentage":5.5597165409},{"Entity":"Ukraine","Year":2003,"renewable_percentage":5.1442841287},{"Entity":"Ukraine","Year":2004,"renewable_percentage":6.4718162839},{"Entity":"Ukraine","Year":2005,"renewable_percentage":6.6698940347},{"Entity":"Ukraine","Year":2006,"renewable_percentage":6.68633235},{"Entity":"Ukraine","Year":2007,"renewable_percentage":5.3380238605},{"Entity":"Ukraine","Year":2008,"renewable_percentage":6.1377090041},{"Entity":"Ukraine","Year":2009,"renewable_percentage":6.980762585},{"Entity":"Ukraine","Year":2010,"renewable_percentage":7.0914098083},{"Entity":"Ukraine","Year":2011,"renewable_percentage":5.7450628366},{"Entity":"Ukraine","Year":2012,"renewable_percentage":5.6614236741},{"Entity":"Ukraine","Year":2013,"renewable_percentage":7.8003200661},{"Entity":"Ukraine","Year":2014,"renewable_percentage":5.5885262117},{"Entity":"Ukraine","Year":2015,"renewable_percentage":4.3924771096},{"Entity":"Ukraine","Year":2016,"renewable_percentage":5.6797249171},{"Entity":"Ukraine","Year":2017,"renewable_percentage":7.0457194664},{"Entity":"Ukraine","Year":2018,"renewable_percentage":8.228528092},{"Entity":"Ukraine","Year":2019,"renewable_percentage":7.7754487096},{"Entity":"Ukraine","Year":2020,"renewable_percentage":11.8440577364},{"Entity":"United Kingdom","Year":2000,"renewable_percentage":2.6657406913},{"Entity":"United Kingdom","Year":2001,"renewable_percentage":2.5001961451},{"Entity":"United Kingdom","Year":2002,"renewable_percentage":2.8939157566},{"Entity":"United Kingdom","Year":2003,"renewable_percentage":2.6854802003},{"Entity":"United Kingdom","Year":2004,"renewable_percentage":3.6136880575},{"Entity":"United Kingdom","Year":2005,"renewable_percentage":4.2815234434},{"Entity":"United Kingdom","Year":2006,"renewable_percentage":4.6029890199},{"Entity":"United Kingdom","Year":2007,"renewable_percentage":5.0104331009},{"Entity":"United Kingdom","Year":2008,"renewable_percentage":5.6776842324},{"Entity":"United Kingdom","Year":2009,"renewable_percentage":6.7679854187},{"Entity":"United Kingdom","Year":2010,"renewable_percentage":6.9092924441},{"Entity":"United Kingdom","Year":2011,"renewable_percentage":9.6422505889},{"Entity":"United Kingdom","Year":2012,"renewable_percentage":11.4273047189},{"Entity":"United Kingdom","Year":2013,"renewable_percentage":14.9727052732},{"Entity":"United Kingdom","Year":2014,"renewable_percentage":19.2476358104},{"Entity":"United Kingdom","Year":2015,"renewable_percentage":24.6227709191},{"Entity":"United Kingdom","Year":2016,"renewable_percentage":24.6788390627},{"Entity":"United Kingdom","Year":2017,"renewable_percentage":29.4986571173},{"Entity":"United Kingdom","Year":2018,"renewable_percentage":33.2919818457},{"Entity":"United Kingdom","Year":2019,"renewable_percentage":37.4568630499},{"Entity":"United Kingdom","Year":2020,"renewable_percentage":42.8603962651},{"Entity":"United States","Year":2000,"renewable_percentage":9.2298992662},{"Entity":"United States","Year":2001,"renewable_percentage":7.5132056541},{"Entity":"United States","Year":2002,"renewable_percentage":8.749216358},{"Entity":"United States","Year":2003,"renewable_percentage":9.0252110397},{"Entity":"United States","Year":2004,"renewable_percentage":8.7334100887},{"Entity":"United States","Year":2005,"renewable_percentage":8.7494640631},{"Entity":"United States","Year":2006,"renewable_percentage":9.4184742052},{"Entity":"United States","Year":2007,"renewable_percentage":8.3984096829},{"Entity":"United States","Year":2008,"renewable_percentage":9.180943292},{"Entity":"United States","Year":2009,"renewable_percentage":10.547689996},{"Entity":"United States","Year":2010,"renewable_percentage":10.3180892283},{"Entity":"United States","Year":2011,"renewable_percentage":12.4665249812},{"Entity":"United States","Year":2012,"renewable_percentage":12.1841179804},{"Entity":"United States","Year":2013,"renewable_percentage":12.8311154179},{"Entity":"United States","Year":2014,"renewable_percentage":13.3503092033},{"Entity":"United States","Year":2015,"renewable_percentage":13.6261352256},{"Entity":"United States","Year":2016,"renewable_percentage":15.2880936304},{"Entity":"United States","Year":2017,"renewable_percentage":17.4515276472},{"Entity":"United States","Year":2018,"renewable_percentage":17.4499886946},{"Entity":"United States","Year":2019,"renewable_percentage":18.2946243489},{"Entity":"United States","Year":2020,"renewable_percentage":20.3156921037}],"metadata":{"Entity":{"type":"string","semanticType":"Location"},"Year":{"type":"number","semanticType":"Year"},"renewable_percentage":{"type":"number","semanticType":"Percentage"}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage']].copy()\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 158029.9988, 190729.9957, 209229.9957, ..., 6993180.176, 9861099.609, 9874660.156, 10096009.77\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 90.14, 91.79, 92.54, 804.95\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"\",\n    \"chart_type\": \"Line Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Transform the data into a long format where different energy sources (fossil fuels, nuclear, renewables) are unpivoted into separate rows. Each row should contain the year, entity (country), energy source type, and the corresponding energy value in TWh. This will enable visualization of energy generation trends over time by source and country.\",\n    \"display_instruction\": \"Show **energy generation** trends by **source** and **Entity** over **Year**\",\n    \"output_fields\": [\"Year\", \"Entity\", \"source\", \"energy\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    },\n    \"reason\": \"The user wants to visualize energy data across different sources with a line chart faceted by source. The original data has energy sources in separate columns (fossil fuels, nuclear, renewables), so we need to unpivot these columns into a long format with 'source' and 'energy' fields. The chart_encodings provided by the user are appropriate for this visualization goal, using faceting (column) to separate different energy sources.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Unpivot the energy source columns into long format\n    transformed_df = pd.melt(\n        df_energy,\n        id_vars=['Year', 'Entity'],\n        value_vars=[\n            'Electricity from fossil fuels (TWh)',\n            'Electricity from nuclear (TWh)',\n            'Electricity from renewables (TWh)'\n        ],\n        var_name='source',\n        value_name='energy'\n    )\n    \n    # Clean up the source names to be more readable\n    transformed_df['source'] = transformed_df['source'].str.replace('Electricity from ', '').str.replace(' (TWh)', '')\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n      Entity  Year  energy        source\n0  Australia  2000  181.05  fossil fuels\n1  Australia  2001  194.33  fossil fuels\n2  Australia  2002  197.29  fossil fuels\n3  Australia  2003  195.13  fossil fuels\n4  Australia  2004  203.66  fossil fuels\n5  Australia  2005  195.95  fossil fuels\n6  Australia  2006  198.72  fossil fuels\n7  Australia  2007  208.59  fossil fuels\n8  Australia  2008  211.06  fossil fuels\n9  Australia  2009  216.42  fossil fuels\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show renewable percentage for each country\",\n    \"chart_type\": \"Line Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Calculate the renewable energy percentage for each country and year. The renewable percentage is computed as the ratio of renewable energy to total energy (sum of fossil fuels, nuclear, and renewables) multiplied by 100. The output should contain year, entity (country), and the renewable percentage value.\",\n    \"display_instruction\": \"Show **renewable percentage** for each **Entity** over **Year**\",\n    \"output_fields\": [\"Year\", \"Entity\", \"renewable_percentage\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"renewable_percentage\",\n        \"color\": \"Entity\"\n    },\n    \"reason\": \"The user wants to see renewable percentage trends, which requires calculating the proportion of renewable energy relative to total energy generation. This is a single metric per country per year, so we don't need the 'column' faceting by source anymore. The chart_encodings are updated to reflect that we're now showing a percentage metric rather than absolute energy values by source.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage']].copy()\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"table-82","sourceTableIds":["global-energy-20-small.csv"],"instruction":"show renewable percentage for each country","displayInstruction":"Show **renewable percentage** for each **Entity** over **Year**","chart":{"id":"chart-1760738416626","chartType":"Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"fieldID":"concept-1760738385163"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"opacity":{"channel":"opacity","bin":false},"column":{"fieldID":"concept-1760738389404","sortBy":"[\"fossil fuels\",\"nuclear\",\"renewables\"]"},"row":{"channel":"row","bin":false}},"tableRef":"table-82","saved":false,"source":"trigger","unread":false},"resultTableId":"table-45"},"explanation":{"agent":"CodeExplanationAgent","code":"The code transforms global energy data to analyze renewable energy adoption:\n\n- Calculates **total_energy** by summing electricity generation from three sources: **fossil fuels**, **nuclear**, and **renewables** (all measured in TWh)\n- Computes **renewable_percentage** by dividing **Electricity from renewables (TWh)** by **total_energy** and multiplying by **100**\n- Handles edge cases by replacing infinite values (from division by zero) with **NaN**\n- Filters the dataset to retain only **Year**, **Entity** (country), and **renewable_percentage** columns","concepts":[{"explanation":"The proportion of a country's total electricity generation that comes from renewable sources, expressed as a percentage. Calculated as: \\( \\frac{\\text{Electricity from renewables}}{\\text{Total electricity generation}} \\times 100 \\). This metric indicates the degree of renewable energy adoption in each country's energy mix.","field":"renewable_percentage"}],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 5738290.039, 9861099.609, 10502929.69, 10707219.73\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., nan, nan, nan, nan\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage']].copy()\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\nThe code transforms global energy data to analyze renewable energy adoption:\n\n- Calculates **total_energy** by summing electricity generation from three sources: **fossil fuels**, **nuclear**, and **renewables** (all measured in TWh)\n- Computes **renewable_percentage** by dividing **Electricity from renewables (TWh)** by **total_energy** and multiplying by **100**\n- Handles edge cases by replacing infinite values (from division by zero) with **NaN**\n- Filters the dataset to retain only **Year**, **Entity** (country), and **renewable_percentage** columns\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"renewable_percentage\",\n        \"explanation\": \"The proportion of a country's total electricity generation that comes from renewable sources, expressed as a percentage. Calculated as: \\\\( \\\\frac{\\\\text{Electricity from renewables}}{\\\\text{Total electricity generation}} \\\\times 100 \\\\). This metric indicates the degree of renewable energy adoption in each country's energy mix.\"\n    }\n]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""},{"id":"table-78","displayId":"renewable-energy-rank","names":["Entity","Year","rank","renewable_percentage"],"rows":[{"Entity":"Australia","Year":2000,"rank":11,"renewable_percentage":8.6344368187},{"Entity":"Australia","Year":2001,"rank":10,"renewable_percentage":8.2180135078},{"Entity":"Australia","Year":2002,"rank":11,"renewable_percentage":8.0833022736},{"Entity":"Australia","Year":2003,"rank":11,"renewable_percentage":8.6598324205},{"Entity":"Australia","Year":2004,"rank":12,"renewable_percentage":8.7013045232},{"Entity":"Australia","Year":2005,"rank":11,"renewable_percentage":9.1562355123},{"Entity":"Australia","Year":2006,"rank":11,"renewable_percentage":9.6357600837},{"Entity":"Australia","Year":2007,"rank":11,"renewable_percentage":9.1190310213},{"Entity":"Australia","Year":2008,"rank":12,"renewable_percentage":8.0548900022},{"Entity":"Australia","Year":2009,"rank":12,"renewable_percentage":7.8043793133},{"Entity":"Australia","Year":2010,"rank":12,"renewable_percentage":9.0442152121},{"Entity":"Australia","Year":2011,"rank":11,"renewable_percentage":11.3454273735},{"Entity":"Australia","Year":2012,"rank":12,"renewable_percentage":11.4105750279},{"Entity":"Australia","Year":2013,"rank":11,"renewable_percentage":14.8708583355},{"Entity":"Australia","Year":2014,"rank":11,"renewable_percentage":14.9621290509},{"Entity":"Australia","Year":2015,"rank":12,"renewable_percentage":14.3476000693},{"Entity":"Australia","Year":2016,"rank":11,"renewable_percentage":15.6093794449},{"Entity":"Australia","Year":2017,"rank":12,"renewable_percentage":16.3138729943},{"Entity":"Australia","Year":2018,"rank":12,"renewable_percentage":17.145938174},{"Entity":"Australia","Year":2019,"rank":8,"renewable_percentage":21.3759705435},{"Entity":"Australia","Year":2020,"rank":8,"renewable_percentage":25.5031684668},{"Entity":"Brazil","Year":2000,"rank":1,"renewable_percentage":90.1307723743},{"Entity":"Brazil","Year":2001,"rank":1,"renewable_percentage":84.6953615744},{"Entity":"Brazil","Year":2002,"rank":1,"renewable_percentage":86.0883364189},{"Entity":"Brazil","Year":2003,"rank":1,"renewable_percentage":87.4561159097},{"Entity":"Brazil","Year":2004,"rank":1,"renewable_percentage":86.4260041451},{"Entity":"Brazil","Year":2005,"rank":1,"renewable_percentage":87.6781562721},{"Entity":"Brazil","Year":2006,"rank":1,"renewable_percentage":87.2842473236},{"Entity":"Brazil","Year":2007,"rank":1,"renewable_percentage":88.7252098726},{"Entity":"Brazil","Year":2008,"rank":1,"renewable_percentage":84.8072313004},{"Entity":"Brazil","Year":2009,"rank":1,"renewable_percentage":89.4172280725},{"Entity":"Brazil","Year":2010,"rank":1,"renewable_percentage":85.3576882415},{"Entity":"Brazil","Year":2011,"rank":1,"renewable_percentage":87.6618820986},{"Entity":"Brazil","Year":2012,"rank":1,"renewable_percentage":83.1164558813},{"Entity":"Brazil","Year":2013,"rank":1,"renewable_percentage":77.5240022006},{"Entity":"Brazil","Year":2014,"rank":1,"renewable_percentage":74.0418657409},{"Entity":"Brazil","Year":2015,"rank":1,"renewable_percentage":75.0231817625},{"Entity":"Brazil","Year":2016,"rank":1,"renewable_percentage":81.0938046902},{"Entity":"Brazil","Year":2017,"rank":1,"renewable_percentage":79.9091472228},{"Entity":"Brazil","Year":2018,"rank":1,"renewable_percentage":82.9198505403},{"Entity":"Brazil","Year":2019,"rank":1,"renewable_percentage":82.8548799017},{"Entity":"Brazil","Year":2020,"rank":1,"renewable_percentage":84.6411771408},{"Entity":"Canada","Year":2000,"rank":2,"renewable_percentage":61.8095917882},{"Entity":"Canada","Year":2001,"rank":2,"renewable_percentage":59.3287558747},{"Entity":"Canada","Year":2002,"rank":2,"renewable_percentage":61.1477403113},{"Entity":"Canada","Year":2003,"rank":2,"renewable_percentage":60.0789685174},{"Entity":"Canada","Year":2004,"rank":2,"renewable_percentage":59.6967771845},{"Entity":"Canada","Year":2005,"rank":2,"renewable_percentage":60.8208155391},{"Entity":"Canada","Year":2006,"rank":2,"renewable_percentage":60.8271602855},{"Entity":"Canada","Year":2007,"rank":2,"renewable_percentage":61.2460642446},{"Entity":"Canada","Year":2008,"rank":2,"renewable_percentage":62.6520720838},{"Entity":"Canada","Year":2009,"rank":2,"renewable_percentage":63.8919227732},{"Entity":"Canada","Year":2010,"rank":2,"renewable_percentage":62.9421470558},{"Entity":"Canada","Year":2011,"rank":2,"renewable_percentage":64.0922915917},{"Entity":"Canada","Year":2012,"rank":2,"renewable_percentage":65.098730952},{"Entity":"Canada","Year":2013,"rank":2,"renewable_percentage":65.4320794066},{"Entity":"Canada","Year":2014,"rank":2,"renewable_percentage":64.791145907},{"Entity":"Canada","Year":2015,"rank":2,"renewable_percentage":65.2946239925},{"Entity":"Canada","Year":2016,"rank":2,"renewable_percentage":66.1890584295},{"Entity":"Canada","Year":2017,"rank":2,"renewable_percentage":67.5399410579},{"Entity":"Canada","Year":2018,"rank":2,"renewable_percentage":67.3685700357},{"Entity":"Canada","Year":2019,"rank":2,"renewable_percentage":67.1741623137},{"Entity":"Canada","Year":2020,"rank":2,"renewable_percentage":68.7796436354},{"Entity":"China","Year":2000,"rank":5,"renewable_percentage":16.639126586},{"Entity":"China","Year":2001,"rank":6,"renewable_percentage":18.9581237042},{"Entity":"China","Year":2002,"rank":3,"renewable_percentage":17.6185006046},{"Entity":"China","Year":2003,"rank":6,"renewable_percentage":15.0362717081},{"Entity":"China","Year":2004,"rank":6,"renewable_percentage":16.2224108273},{"Entity":"China","Year":2005,"rank":5,"renewable_percentage":16.1731179957},{"Entity":"China","Year":2006,"rank":7,"renewable_percentage":15.5884036124},{"Entity":"China","Year":2007,"rank":7,"renewable_percentage":15.2583847828},{"Entity":"China","Year":2008,"rank":5,"renewable_percentage":19.0253335469},{"Entity":"China","Year":2009,"rank":5,"renewable_percentage":17.8857170547},{"Entity":"China","Year":2010,"rank":6,"renewable_percentage":18.7800759915},{"Entity":"China","Year":2011,"rank":7,"renewable_percentage":16.8902341543},{"Entity":"China","Year":2012,"rank":6,"renewable_percentage":20.122965176},{"Entity":"China","Year":2013,"rank":6,"renewable_percentage":20.2152481955},{"Entity":"China","Year":2014,"rank":6,"renewable_percentage":22.3502204285},{"Entity":"China","Year":2015,"rank":7,"renewable_percentage":24.079270189},{"Entity":"China","Year":2016,"rank":6,"renewable_percentage":25.0007798429},{"Entity":"China","Year":2017,"rank":7,"renewable_percentage":25.419242299},{"Entity":"China","Year":2018,"rank":7,"renewable_percentage":25.7747942589},{"Entity":"China","Year":2019,"rank":7,"renewable_percentage":26.9995671106},{"Entity":"China","Year":2020,"rank":7,"renewable_percentage":28.2464606924},{"Entity":"France","Year":2000,"rank":8,"renewable_percentage":12.7117691154},{"Entity":"France","Year":2001,"rank":7,"renewable_percentage":13.9961372206},{"Entity":"France","Year":2002,"rank":8,"renewable_percentage":11.3544157067},{"Entity":"France","Year":2003,"rank":9,"renewable_percentage":10.9783540506},{"Entity":"France","Year":2004,"rank":9,"renewable_percentage":11.0051305559},{"Entity":"France","Year":2005,"rank":10,"renewable_percentage":9.6479837153},{"Entity":"France","Year":2006,"rank":10,"renewable_percentage":10.7235915493},{"Entity":"France","Year":2007,"rank":9,"renewable_percentage":11.4370075239},{"Entity":"France","Year":2008,"rank":9,"renewable_percentage":12.7487441615},{"Entity":"France","Year":2009,"rank":9,"renewable_percentage":12.8776856068},{"Entity":"France","Year":2010,"rank":9,"renewable_percentage":13.6240072491},{"Entity":"France","Year":2011,"rank":10,"renewable_percentage":11.63553049},{"Entity":"France","Year":2012,"rank":9,"renewable_percentage":15.0331522889},{"Entity":"France","Year":2013,"rank":7,"renewable_percentage":17.2469424928},{"Entity":"France","Year":2014,"rank":9,"renewable_percentage":16.6074992494},{"Entity":"France","Year":2015,"rank":9,"renewable_percentage":16.002230276},{"Entity":"France","Year":2016,"rank":8,"renewable_percentage":17.7212924013},{"Entity":"France","Year":2017,"rank":11,"renewable_percentage":16.6576751547},{"Entity":"France","Year":2018,"rank":8,"renewable_percentage":19.7315179827},{"Entity":"France","Year":2019,"rank":9,"renewable_percentage":20.0116665488},{"Entity":"France","Year":2020,"rank":9,"renewable_percentage":23.7610241821},{"Entity":"Germany","Year":2000,"rank":14,"renewable_percentage":6.1977983575},{"Entity":"Germany","Year":2001,"rank":14,"renewable_percentage":6.5132585197},{"Entity":"Germany","Year":2002,"rank":13,"renewable_percentage":7.6431369854},{"Entity":"Germany","Year":2003,"rank":12,"renewable_percentage":7.7455438643},{"Entity":"Germany","Year":2004,"rank":10,"renewable_percentage":9.4989185292},{"Entity":"Germany","Year":2005,"rank":8,"renewable_percentage":10.3356645637},{"Entity":"Germany","Year":2006,"rank":8,"renewable_percentage":11.5129959829},{"Entity":"Germany","Year":2007,"rank":8,"renewable_percentage":14.135471525},{"Entity":"Germany","Year":2008,"rank":8,"renewable_percentage":14.8894504106},{"Entity":"Germany","Year":2009,"rank":7,"renewable_percentage":16.2902842395},{"Entity":"Germany","Year":2010,"rank":7,"renewable_percentage":16.8384989754},{"Entity":"Germany","Year":2011,"rank":5,"renewable_percentage":20.4967199299},{"Entity":"Germany","Year":2012,"rank":5,"renewable_percentage":23.056464482},{"Entity":"Germany","Year":2013,"rank":5,"renewable_percentage":24.1368929731},{"Entity":"Germany","Year":2014,"rank":5,"renewable_percentage":26.2182434067},{"Entity":"Germany","Year":2015,"rank":5,"renewable_percentage":29.4721888318},{"Entity":"Germany","Year":2016,"rank":5,"renewable_percentage":29.4990435013},{"Entity":"Germany","Year":2017,"rank":4,"renewable_percentage":33.4855497593},{"Entity":"Germany","Year":2018,"rank":5,"renewable_percentage":35.0976735365},{"Entity":"Germany","Year":2019,"rank":3,"renewable_percentage":40.0890757144},{"Entity":"Germany","Year":2020,"rank":3,"renewable_percentage":44.3324048937},{"Entity":"India","Year":2000,"rank":7,"renewable_percentage":14.0481982534},{"Entity":"India","Year":2001,"rank":8,"renewable_percentage":12.9997099422},{"Entity":"India","Year":2002,"rank":7,"renewable_percentage":11.938193032},{"Entity":"India","Year":2003,"rank":8,"renewable_percentage":11.695109147},{"Entity":"India","Year":2004,"rank":7,"renewable_percentage":15.6375300722},{"Entity":"India","Year":2005,"rank":6,"renewable_percentage":15.2543575768},{"Entity":"India","Year":2006,"rank":5,"renewable_percentage":17.1352578483},{"Entity":"India","Year":2007,"rank":4,"renewable_percentage":17.8019742295},{"Entity":"India","Year":2008,"rank":7,"renewable_percentage":16.768266921},{"Entity":"India","Year":2009,"rank":8,"renewable_percentage":15.269804822},{"Entity":"India","Year":2010,"rank":8,"renewable_percentage":15.2122201244},{"Entity":"India","Year":2011,"rank":8,"renewable_percentage":16.7911025145},{"Entity":"India","Year":2012,"rank":8,"renewable_percentage":15.1350014654},{"Entity":"India","Year":2013,"rank":8,"renewable_percentage":16.3941577818},{"Entity":"India","Year":2014,"rank":10,"renewable_percentage":16.0092550039},{"Entity":"India","Year":2015,"rank":11,"renewable_percentage":15.3718720687},{"Entity":"India","Year":2016,"rank":13,"renewable_percentage":14.8548475703},{"Entity":"India","Year":2017,"rank":13,"renewable_percentage":15.9669920335},{"Entity":"India","Year":2018,"rank":13,"renewable_percentage":16.6949549709},{"Entity":"India","Year":2019,"rank":11,"renewable_percentage":18.6915426873},{"Entity":"India","Year":2020,"rank":13,"renewable_percentage":20.2059243238},{"Entity":"Indonesia","Year":2000,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2001,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2002,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2003,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2004,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2005,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2006,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2007,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2008,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2009,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2010,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2011,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2012,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2013,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2014,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2015,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2016,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2017,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2018,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2019,"rank":null,"renewable_percentage":null},{"Entity":"Indonesia","Year":2020,"rank":null,"renewable_percentage":null},{"Entity":"Italy","Year":2000,"rank":4,"renewable_percentage":18.900241501},{"Entity":"Italy","Year":2001,"rank":4,"renewable_percentage":20.049431902},{"Entity":"Italy","Year":2002,"rank":4,"renewable_percentage":17.4555571614},{"Entity":"Italy","Year":2003,"rank":4,"renewable_percentage":16.4202116476},{"Entity":"Italy","Year":2004,"rank":4,"renewable_percentage":18.2749380999},{"Entity":"Italy","Year":2005,"rank":4,"renewable_percentage":16.3769782226},{"Entity":"Italy","Year":2006,"rank":6,"renewable_percentage":16.5128639906},{"Entity":"Italy","Year":2007,"rank":6,"renewable_percentage":15.5333485238},{"Entity":"Italy","Year":2008,"rank":6,"renewable_percentage":18.6112},{"Entity":"Italy","Year":2009,"rank":4,"renewable_percentage":24.0837332221},{"Entity":"Italy","Year":2010,"rank":4,"renewable_percentage":25.8400187976},{"Entity":"Italy","Year":2011,"rank":4,"renewable_percentage":27.6773203443},{"Entity":"Italy","Year":2012,"rank":3,"renewable_percentage":31.1049649217},{"Entity":"Italy","Year":2013,"rank":4,"renewable_percentage":39.0148744209},{"Entity":"Italy","Year":2014,"rank":3,"renewable_percentage":43.4976931949},{"Entity":"Italy","Year":2015,"rank":3,"renewable_percentage":38.7577860829},{"Entity":"Italy","Year":2016,"rank":4,"renewable_percentage":37.6079387187},{"Entity":"Italy","Year":2017,"rank":3,"renewable_percentage":35.4174479255},{"Entity":"Italy","Year":2018,"rank":3,"renewable_percentage":39.8100142663},{"Entity":"Italy","Year":2019,"rank":4,"renewable_percentage":39.7563068474},{"Entity":"Italy","Year":2020,"rank":6,"renewable_percentage":42.0397741576},{"Entity":"Japan","Year":2000,"rank":9,"renewable_percentage":10.5382436261},{"Entity":"Japan","Year":2001,"rank":9,"renewable_percentage":10.447653504},{"Entity":"Japan","Year":2002,"rank":9,"renewable_percentage":10.2477294843},{"Entity":"Japan","Year":2003,"rank":7,"renewable_percentage":11.6993698448},{"Entity":"Japan","Year":2004,"rank":8,"renewable_percentage":11.4198974767},{"Entity":"Japan","Year":2005,"rank":9,"renewable_percentage":9.9068127192},{"Entity":"Japan","Year":2006,"rank":9,"renewable_percentage":10.8554989442},{"Entity":"Japan","Year":2007,"rank":10,"renewable_percentage":9.3897588285},{"Entity":"Japan","Year":2008,"rank":10,"renewable_percentage":10.0196834738},{"Entity":"Japan","Year":2009,"rank":11,"renewable_percentage":10.4667464874},{"Entity":"Japan","Year":2010,"rank":10,"renewable_percentage":10.5269966826},{"Entity":"Japan","Year":2011,"rank":12,"renewable_percentage":11.1272421632},{"Entity":"Japan","Year":2012,"rank":13,"renewable_percentage":10.6143703421},{"Entity":"Japan","Year":2013,"rank":13,"renewable_percentage":11.7965798852},{"Entity":"Japan","Year":2014,"rank":13,"renewable_percentage":13.2719619718},{"Entity":"Japan","Year":2015,"rank":10,"renewable_percentage":15.6586817408},{"Entity":"Japan","Year":2016,"rank":10,"renewable_percentage":15.6920107068},{"Entity":"Japan","Year":2017,"rank":10,"renewable_percentage":17.3559698312},{"Entity":"Japan","Year":2018,"rank":9,"renewable_percentage":18.144181175},{"Entity":"Japan","Year":2019,"rank":10,"renewable_percentage":19.4223288251},{"Entity":"Japan","Year":2020,"rank":10,"renewable_percentage":21.324925062},{"Entity":"Kazakhstan","Year":2000,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2001,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2002,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2003,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2004,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2005,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2006,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2007,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2008,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2009,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2010,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2011,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2012,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2013,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2014,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2015,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2016,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2017,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2018,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2019,"rank":null,"renewable_percentage":null},{"Entity":"Kazakhstan","Year":2020,"rank":null,"renewable_percentage":null},{"Entity":"Mexico","Year":2000,"rank":3,"renewable_percentage":22.9291160107},{"Entity":"Mexico","Year":2001,"rank":5,"renewable_percentage":19.6649599841},{"Entity":"Mexico","Year":2002,"rank":5,"renewable_percentage":17.4220963173},{"Entity":"Mexico","Year":2003,"rank":5,"renewable_percentage":15.8536585366},{"Entity":"Mexico","Year":2004,"rank":5,"renewable_percentage":17.3134463687},{"Entity":"Mexico","Year":2005,"rank":3,"renewable_percentage":18.2780827246},{"Entity":"Mexico","Year":2006,"rank":3,"renewable_percentage":18.4256091896},{"Entity":"Mexico","Year":2007,"rank":5,"renewable_percentage":17.2761561168},{"Entity":"Mexico","Year":2008,"rank":3,"renewable_percentage":21.5387105913},{"Entity":"Mexico","Year":2009,"rank":6,"renewable_percentage":16.5369729069},{"Entity":"Mexico","Year":2010,"rank":5,"renewable_percentage":19.4281608109},{"Entity":"Mexico","Year":2011,"rank":6,"renewable_percentage":18.0916357408},{"Entity":"Mexico","Year":2012,"rank":7,"renewable_percentage":16.5759438104},{"Entity":"Mexico","Year":2013,"rank":9,"renewable_percentage":15.5492898914},{"Entity":"Mexico","Year":2014,"rank":7,"renewable_percentage":19.8008201523},{"Entity":"Mexico","Year":2015,"rank":8,"renewable_percentage":17.5976903451},{"Entity":"Mexico","Year":2016,"rank":9,"renewable_percentage":17.4806943436},{"Entity":"Mexico","Year":2017,"rank":8,"renewable_percentage":18.0759526428},{"Entity":"Mexico","Year":2018,"rank":10,"renewable_percentage":17.703752786},{"Entity":"Mexico","Year":2019,"rank":12,"renewable_percentage":18.5487927565},{"Entity":"Mexico","Year":2020,"rank":11,"renewable_percentage":21.2552224134},{"Entity":"Poland","Year":2000,"rank":16,"renewable_percentage":1.6273222517},{"Entity":"Poland","Year":2001,"rank":16,"renewable_percentage":1.934316727},{"Entity":"Poland","Year":2002,"rank":16,"renewable_percentage":1.9439960699},{"Entity":"Poland","Year":2003,"rank":16,"renewable_percentage":1.4999000067},{"Entity":"Poland","Year":2004,"rank":16,"renewable_percentage":2.1016681991},{"Entity":"Poland","Year":2005,"rank":16,"renewable_percentage":2.4830699774},{"Entity":"Poland","Year":2006,"rank":16,"renewable_percentage":2.673730134},{"Entity":"Poland","Year":2007,"rank":16,"renewable_percentage":3.4256513785},{"Entity":"Poland","Year":2008,"rank":16,"renewable_percentage":4.2744438696},{"Entity":"Poland","Year":2009,"rank":16,"renewable_percentage":5.7515388179},{"Entity":"Poland","Year":2010,"rank":14,"renewable_percentage":6.9299363057},{"Entity":"Poland","Year":2011,"rank":14,"renewable_percentage":8.0547205693},{"Entity":"Poland","Year":2012,"rank":14,"renewable_percentage":10.4436057663},{"Entity":"Poland","Year":2013,"rank":14,"renewable_percentage":10.4081508145},{"Entity":"Poland","Year":2014,"rank":14,"renewable_percentage":12.5331481248},{"Entity":"Poland","Year":2015,"rank":13,"renewable_percentage":13.8151485631},{"Entity":"Poland","Year":2016,"rank":14,"renewable_percentage":13.7335179722},{"Entity":"Poland","Year":2017,"rank":14,"renewable_percentage":14.1999646913},{"Entity":"Poland","Year":2018,"rank":15,"renewable_percentage":12.7559148032},{"Entity":"Poland","Year":2019,"rank":14,"renewable_percentage":15.6157998037},{"Entity":"Poland","Year":2020,"rank":14,"renewable_percentage":17.9648720886},{"Entity":"Saudi Arabia","Year":2000,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2001,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2002,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2003,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2004,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2005,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2006,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2007,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2008,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2009,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2010,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2011,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2012,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2013,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2014,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2015,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2016,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2017,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2018,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2019,"rank":null,"renewable_percentage":null},{"Entity":"Saudi Arabia","Year":2020,"rank":null,"renewable_percentage":null},{"Entity":"South Africa","Year":2000,"rank":17,"renewable_percentage":0.9110805721},{"Entity":"South Africa","Year":2001,"rank":17,"renewable_percentage":1.2516536074},{"Entity":"South Africa","Year":2002,"rank":17,"renewable_percentage":1.3802249619},{"Entity":"South Africa","Year":2003,"rank":17,"renewable_percentage":0.545271261},{"Entity":"South Africa","Year":2004,"rank":17,"renewable_percentage":0.5827199439},{"Entity":"South Africa","Year":2005,"rank":17,"renewable_percentage":0.763458686},{"Entity":"South Africa","Year":2006,"rank":17,"renewable_percentage":1.3863060017},{"Entity":"South Africa","Year":2007,"rank":17,"renewable_percentage":0.5267209594},{"Entity":"South Africa","Year":2008,"rank":17,"renewable_percentage":0.6895692269},{"Entity":"South Africa","Year":2009,"rank":17,"renewable_percentage":0.8031088083},{"Entity":"South Africa","Year":2010,"rank":17,"renewable_percentage":1.0330068318},{"Entity":"South Africa","Year":2011,"rank":17,"renewable_percentage":1.0184465622},{"Entity":"South Africa","Year":2012,"rank":17,"renewable_percentage":0.6890826069},{"Entity":"South Africa","Year":2013,"rank":17,"renewable_percentage":0.6792168043},{"Entity":"South Africa","Year":2014,"rank":17,"renewable_percentage":1.4288129861},{"Entity":"South Africa","Year":2015,"rank":17,"renewable_percentage":2.6256790549},{"Entity":"South Africa","Year":2016,"rank":17,"renewable_percentage":3.2586126531},{"Entity":"South Africa","Year":2017,"rank":17,"renewable_percentage":4.2202606137},{"Entity":"South Africa","Year":2018,"rank":17,"renewable_percentage":5.1554655529},{"Entity":"South Africa","Year":2019,"rank":17,"renewable_percentage":5.3589699864},{"Entity":"South Africa","Year":2020,"rank":17,"renewable_percentage":5.780581212},{"Entity":"Spain","Year":2000,"rank":6,"renewable_percentage":15.6119862394},{"Entity":"Spain","Year":2001,"rank":3,"renewable_percentage":21.1524434719},{"Entity":"Spain","Year":2002,"rank":6,"renewable_percentage":13.8260180901},{"Entity":"Spain","Year":2003,"rank":3,"renewable_percentage":21.667314419},{"Entity":"Spain","Year":2004,"rank":3,"renewable_percentage":18.3190206468},{"Entity":"Spain","Year":2005,"rank":7,"renewable_percentage":14.8597342333},{"Entity":"Spain","Year":2006,"rank":4,"renewable_percentage":17.6623992413},{"Entity":"Spain","Year":2007,"rank":3,"renewable_percentage":19.3347262296},{"Entity":"Spain","Year":2008,"rank":4,"renewable_percentage":20.0051501593},{"Entity":"Spain","Year":2009,"rank":3,"renewable_percentage":25.4107639008},{"Entity":"Spain","Year":2010,"rank":3,"renewable_percentage":32.7922186819},{"Entity":"Spain","Year":2011,"rank":3,"renewable_percentage":30.0408415417},{"Entity":"Spain","Year":2012,"rank":4,"renewable_percentage":29.6047928652},{"Entity":"Spain","Year":2013,"rank":3,"renewable_percentage":39.5850357054},{"Entity":"Spain","Year":2014,"rank":4,"renewable_percentage":40.1032952644},{"Entity":"Spain","Year":2015,"rank":4,"renewable_percentage":34.9899091826},{"Entity":"Spain","Year":2016,"rank":3,"renewable_percentage":38.5818061138},{"Entity":"Spain","Year":2017,"rank":5,"renewable_percentage":32.220593624},{"Entity":"Spain","Year":2018,"rank":4,"renewable_percentage":38.2080329557},{"Entity":"Spain","Year":2019,"rank":6,"renewable_percentage":37.280815091},{"Entity":"Spain","Year":2020,"rank":4,"renewable_percentage":43.8108805298},{"Entity":"Thailand","Year":2000,"rank":12,"renewable_percentage":7.1261029822},{"Entity":"Thailand","Year":2001,"rank":12,"renewable_percentage":7.061527212},{"Entity":"Thailand","Year":2002,"rank":12,"renewable_percentage":7.9444772593},{"Entity":"Thailand","Year":2003,"rank":13,"renewable_percentage":7.6718362852},{"Entity":"Thailand","Year":2004,"rank":13,"renewable_percentage":6.5163549406},{"Entity":"Thailand","Year":2005,"rank":14,"renewable_percentage":6.0325203252},{"Entity":"Thailand","Year":2006,"rank":13,"renewable_percentage":7.5988547551},{"Entity":"Thailand","Year":2007,"rank":13,"renewable_percentage":7.7085852479},{"Entity":"Thailand","Year":2008,"rank":13,"renewable_percentage":6.5625458278},{"Entity":"Thailand","Year":2009,"rank":15,"renewable_percentage":6.6263303689},{"Entity":"Thailand","Year":2010,"rank":16,"renewable_percentage":5.7085828343},{"Entity":"Thailand","Year":2011,"rank":15,"renewable_percentage":8.039961941},{"Entity":"Thailand","Year":2012,"rank":15,"renewable_percentage":8.5396118358},{"Entity":"Thailand","Year":2013,"rank":16,"renewable_percentage":7.6765035487},{"Entity":"Thailand","Year":2014,"rank":15,"renewable_percentage":8.395728489},{"Entity":"Thailand","Year":2015,"rank":15,"renewable_percentage":7.9949619145},{"Entity":"Thailand","Year":2016,"rank":15,"renewable_percentage":8.9840234023},{"Entity":"Thailand","Year":2017,"rank":15,"renewable_percentage":10.9570957096},{"Entity":"Thailand","Year":2018,"rank":14,"renewable_percentage":14.1900054915},{"Entity":"Thailand","Year":2019,"rank":15,"renewable_percentage":14.7001731284},{"Entity":"Thailand","Year":2020,"rank":15,"renewable_percentage":13.7963737796},{"Entity":"Ukraine","Year":2000,"rank":13,"renewable_percentage":6.5860921352},{"Entity":"Ukraine","Year":2001,"rank":13,"renewable_percentage":6.9729761009},{"Entity":"Ukraine","Year":2002,"rank":14,"renewable_percentage":5.5597165409},{"Entity":"Ukraine","Year":2003,"rank":14,"renewable_percentage":5.1442841287},{"Entity":"Ukraine","Year":2004,"rank":14,"renewable_percentage":6.4718162839},{"Entity":"Ukraine","Year":2005,"rank":13,"renewable_percentage":6.6698940347},{"Entity":"Ukraine","Year":2006,"rank":14,"renewable_percentage":6.68633235},{"Entity":"Ukraine","Year":2007,"rank":14,"renewable_percentage":5.3380238605},{"Entity":"Ukraine","Year":2008,"rank":14,"renewable_percentage":6.1377090041},{"Entity":"Ukraine","Year":2009,"rank":13,"renewable_percentage":6.980762585},{"Entity":"Ukraine","Year":2010,"rank":13,"renewable_percentage":7.0914098083},{"Entity":"Ukraine","Year":2011,"rank":16,"renewable_percentage":5.7450628366},{"Entity":"Ukraine","Year":2012,"rank":16,"renewable_percentage":5.6614236741},{"Entity":"Ukraine","Year":2013,"rank":15,"renewable_percentage":7.8003200661},{"Entity":"Ukraine","Year":2014,"rank":16,"renewable_percentage":5.5885262117},{"Entity":"Ukraine","Year":2015,"rank":16,"renewable_percentage":4.3924771096},{"Entity":"Ukraine","Year":2016,"rank":16,"renewable_percentage":5.6797249171},{"Entity":"Ukraine","Year":2017,"rank":16,"renewable_percentage":7.0457194664},{"Entity":"Ukraine","Year":2018,"rank":16,"renewable_percentage":8.228528092},{"Entity":"Ukraine","Year":2019,"rank":16,"renewable_percentage":7.7754487096},{"Entity":"Ukraine","Year":2020,"rank":16,"renewable_percentage":11.8440577364},{"Entity":"United Kingdom","Year":2000,"rank":15,"renewable_percentage":2.6657406913},{"Entity":"United Kingdom","Year":2001,"rank":15,"renewable_percentage":2.5001961451},{"Entity":"United Kingdom","Year":2002,"rank":15,"renewable_percentage":2.8939157566},{"Entity":"United Kingdom","Year":2003,"rank":15,"renewable_percentage":2.6854802003},{"Entity":"United Kingdom","Year":2004,"rank":15,"renewable_percentage":3.6136880575},{"Entity":"United Kingdom","Year":2005,"rank":15,"renewable_percentage":4.2815234434},{"Entity":"United Kingdom","Year":2006,"rank":15,"renewable_percentage":4.6029890199},{"Entity":"United Kingdom","Year":2007,"rank":15,"renewable_percentage":5.0104331009},{"Entity":"United Kingdom","Year":2008,"rank":15,"renewable_percentage":5.6776842324},{"Entity":"United Kingdom","Year":2009,"rank":14,"renewable_percentage":6.7679854187},{"Entity":"United Kingdom","Year":2010,"rank":15,"renewable_percentage":6.9092924441},{"Entity":"United Kingdom","Year":2011,"rank":13,"renewable_percentage":9.6422505889},{"Entity":"United Kingdom","Year":2012,"rank":11,"renewable_percentage":11.4273047189},{"Entity":"United Kingdom","Year":2013,"rank":10,"renewable_percentage":14.9727052732},{"Entity":"United Kingdom","Year":2014,"rank":8,"renewable_percentage":19.2476358104},{"Entity":"United Kingdom","Year":2015,"rank":6,"renewable_percentage":24.6227709191},{"Entity":"United Kingdom","Year":2016,"rank":7,"renewable_percentage":24.6788390627},{"Entity":"United Kingdom","Year":2017,"rank":6,"renewable_percentage":29.4986571173},{"Entity":"United Kingdom","Year":2018,"rank":6,"renewable_percentage":33.2919818457},{"Entity":"United Kingdom","Year":2019,"rank":5,"renewable_percentage":37.4568630499},{"Entity":"United Kingdom","Year":2020,"rank":5,"renewable_percentage":42.8603962651},{"Entity":"United States","Year":2000,"rank":10,"renewable_percentage":9.2298992662},{"Entity":"United States","Year":2001,"rank":11,"renewable_percentage":7.5132056541},{"Entity":"United States","Year":2002,"rank":10,"renewable_percentage":8.749216358},{"Entity":"United States","Year":2003,"rank":10,"renewable_percentage":9.0252110397},{"Entity":"United States","Year":2004,"rank":11,"renewable_percentage":8.7334100887},{"Entity":"United States","Year":2005,"rank":12,"renewable_percentage":8.7494640631},{"Entity":"United States","Year":2006,"rank":12,"renewable_percentage":9.4184742052},{"Entity":"United States","Year":2007,"rank":12,"renewable_percentage":8.3984096829},{"Entity":"United States","Year":2008,"rank":11,"renewable_percentage":9.180943292},{"Entity":"United States","Year":2009,"rank":10,"renewable_percentage":10.547689996},{"Entity":"United States","Year":2010,"rank":11,"renewable_percentage":10.3180892283},{"Entity":"United States","Year":2011,"rank":9,"renewable_percentage":12.4665249812},{"Entity":"United States","Year":2012,"rank":10,"renewable_percentage":12.1841179804},{"Entity":"United States","Year":2013,"rank":12,"renewable_percentage":12.8311154179},{"Entity":"United States","Year":2014,"rank":12,"renewable_percentage":13.3503092033},{"Entity":"United States","Year":2015,"rank":14,"renewable_percentage":13.6261352256},{"Entity":"United States","Year":2016,"rank":12,"renewable_percentage":15.2880936304},{"Entity":"United States","Year":2017,"rank":9,"renewable_percentage":17.4515276472},{"Entity":"United States","Year":2018,"rank":11,"renewable_percentage":17.4499886946},{"Entity":"United States","Year":2019,"rank":13,"renewable_percentage":18.2946243489},{"Entity":"United States","Year":2020,"rank":12,"renewable_percentage":20.3156921037}],"metadata":{"Entity":{"type":"string","semanticType":"Location"},"Year":{"type":"number","semanticType":"Year"},"rank":{"type":"number","semanticType":"Number"},"renewable_percentage":{"type":"number","semanticType":"Percentage"}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Rank countries by renewable percentage within each year (highest percentage = rank 1)\n    df_energy['rank'] = df_energy.groupby('Year')['renewable_percentage'].rank(\n        method='dense', \n        ascending=False\n    )\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage', 'rank']].copy()\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 158029.9988, 190729.9957, 209229.9957, ..., 6993180.176, 9861099.609, 9874660.156, 10096009.77\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 90.14, 91.79, 92.54, 804.95\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"\",\n    \"chart_type\": \"Line Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Transform the data into a long format where different energy sources (fossil fuels, nuclear, renewables) are unpivoted into separate rows. Each row should contain the year, entity (country), energy source type, and the corresponding energy value in TWh. This will enable visualization of energy generation trends over time by source and country.\",\n    \"display_instruction\": \"Show **energy generation** trends by **source** and **Entity** over **Year**\",\n    \"output_fields\": [\"Year\", \"Entity\", \"source\", \"energy\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    },\n    \"reason\": \"The user wants to visualize energy data across different sources with a line chart faceted by source. The original data has energy sources in separate columns (fossil fuels, nuclear, renewables), so we need to unpivot these columns into a long format with 'source' and 'energy' fields. The chart_encodings provided by the user are appropriate for this visualization goal, using faceting (column) to separate different energy sources.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Unpivot the energy source columns into long format\n    transformed_df = pd.melt(\n        df_energy,\n        id_vars=['Year', 'Entity'],\n        value_vars=[\n            'Electricity from fossil fuels (TWh)',\n            'Electricity from nuclear (TWh)',\n            'Electricity from renewables (TWh)'\n        ],\n        var_name='source',\n        value_name='energy'\n    )\n    \n    # Clean up the source names to be more readable\n    transformed_df['source'] = transformed_df['source'].str.replace('Electricity from ', '').str.replace(' (TWh)', '')\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n      Entity  Year  energy        source\n0  Australia  2000  181.05  fossil fuels\n1  Australia  2001  194.33  fossil fuels\n2  Australia  2002  197.29  fossil fuels\n3  Australia  2003  195.13  fossil fuels\n4  Australia  2004  203.66  fossil fuels\n5  Australia  2005  195.95  fossil fuels\n6  Australia  2006  198.72  fossil fuels\n7  Australia  2007  208.59  fossil fuels\n8  Australia  2008  211.06  fossil fuels\n9  Australia  2009  216.42  fossil fuels\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show renewable percentage for each country\",\n    \"chart_type\": \"Line Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"energy\",\n        \"color\": \"Entity\",\n        \"column\": \"source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Calculate the renewable energy percentage for each country and year. The renewable percentage is computed as the ratio of renewable energy to total energy (sum of fossil fuels, nuclear, and renewables) multiplied by 100. The output should contain year, entity (country), and the renewable percentage value.\",\n    \"display_instruction\": \"Show **renewable percentage** for each **Entity** over **Year**\",\n    \"output_fields\": [\"Year\", \"Entity\", \"renewable_percentage\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"renewable_percentage\",\n        \"color\": \"Entity\"\n    },\n    \"reason\": \"The user wants to see renewable percentage trends, which requires calculating the proportion of renewable energy relative to total energy generation. This is a single metric per country per year, so we don't need the 'column' faceting by source anymore. The chart_encodings are updated to reflect that we're now showing a percentage metric rather than absolute energy values by source.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage']].copy()\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n      Entity  Year  renewable_percentage\n0  Australia  2000              8.634437\n1  Australia  2001              8.218014\n2  Australia  2002              8.083302\n3  Australia  2003              8.659832\n4  Australia  2004              8.701305\n5  Australia  2005              9.156236\n6  Australia  2006              9.635760\n7  Australia  2007              9.119031\n8  Australia  2008              8.054890\n9  Australia  2009              7.804379\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"rank countries by their renewable percentage\",\n    \"chart_type\": \"Line Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"renewable_percentage\",\n        \"color\": \"Entity\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Calculate the renewable energy percentage for each country and year, then rank countries based on their renewable percentage. The ranking should be computed for each year, showing which countries have the highest to lowest renewable percentage. The output should contain year, entity (country), renewable percentage, and the rank of each country within that year.\",\n    \"display_instruction\": \"Show **countries ranked** by **renewable percentage** over **Year**\",\n    \"output_fields\": [\"Year\", \"Entity\", \"renewable_percentage\", \"rank\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"renewable_percentage\",\n        \"color\": \"Entity\"\n    },\n    \"reason\": \"The user wants to rank countries by their renewable percentage, which requires adding a rank field that orders countries within each year based on their renewable percentage (highest percentage = rank 1). This allows comparison of countries' relative positions in renewable energy adoption over time. The chart_encodings remain the same as the previous step since we're still visualizing renewable percentage trends, but now with ranking information available.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Rank countries by renewable percentage within each year (highest percentage = rank 1)\n    df_energy['rank'] = df_energy.groupby('Year')['renewable_percentage'].rank(\n        method='dense', \n        ascending=False\n    )\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage', 'rank']].copy()\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"table-45","sourceTableIds":["global-energy-20-small.csv"],"instruction":"rank countries by their renewable percentage","displayInstruction":"Show **countries ranked** by **renewable percentage** over **Year**","chart":{"id":"chart-1760738441793","chartType":"Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"fieldID":"concept-renewable_percentage-1760738424337"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"opacity":{"channel":"opacity","bin":false},"column":{},"row":{"channel":"row","bin":false}},"tableRef":"table-45","saved":false,"source":"trigger","unread":false},"resultTableId":"table-78"},"explanation":{"agent":"CodeExplanationAgent","code":"- Calculate **total_energy** for each country-year by summing electricity generated from **fossil fuels**, **nuclear**, and **renewables** (all measured in TWh)\n- Compute **renewable_percentage** by dividing **Electricity from renewables (TWh)** by **total_energy** and multiplying by **100**\n- Replace any infinite values in **renewable_percentage** with NaN to handle cases where total energy is zero\n- Assign a **rank** to each country within each **Year** based on **renewable_percentage**, where rank **1** represents the highest renewable percentage (using dense ranking method)\n- Return a dataset containing **Year**, **Entity** (country name), **renewable_percentage**, and **rank**","concepts":[{"explanation":"The proportion of a country's total electricity generation that comes from renewable sources, expressed as a percentage. Calculated as: \\[ \\text{renewable\\_percentage} = \\frac{\\text{Electricity from renewables (TWh)}}{\\text{total\\_energy}} \\times 100 \\]","field":"renewable_percentage"}],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 190729.9957, 227580.0018, 233600.0061, ..., 9282549.805, 9861099.609, 9874660.156, 10096009.77\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 88.76, 90.14, 91.79, 92.54\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total energy for each row\n    df_energy['total_energy'] = (\n        df_energy['Electricity from fossil fuels (TWh)'] + \n        df_energy['Electricity from nuclear (TWh)'] + \n        df_energy['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_energy['renewable_percentage'] = (\n        df_energy['Electricity from renewables (TWh)'] / df_energy['total_energy'] * 100\n    )\n    \n    # Handle division by zero cases\n    df_energy['renewable_percentage'] = df_energy['renewable_percentage'].replace([np.inf, -np.inf], np.nan)\n    \n    # Rank countries by renewable percentage within each year (highest percentage = rank 1)\n    df_energy['rank'] = df_energy.groupby('Year')['renewable_percentage'].rank(\n        method='dense', \n        ascending=False\n    )\n    \n    # Select only the required columns\n    transformed_df = df_energy[['Year', 'Entity', 'renewable_percentage', 'rank']].copy()\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\n- Calculate **total_energy** for each country-year by summing electricity generated from **fossil fuels**, **nuclear**, and **renewables** (all measured in TWh)\n- Compute **renewable_percentage** by dividing **Electricity from renewables (TWh)** by **total_energy** and multiplying by **100**\n- Replace any infinite values in **renewable_percentage** with NaN to handle cases where total energy is zero\n- Assign a **rank** to each country within each **Year** based on **renewable_percentage**, where rank **1** represents the highest renewable percentage (using dense ranking method)\n- Return a dataset containing **Year**, **Entity** (country name), **renewable_percentage**, and **rank**\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"renewable_percentage\",\n        \"explanation\": \"The proportion of a country's total electricity generation that comes from renewable sources, expressed as a percentage. Calculated as: \\\\[ \\\\text{renewable\\\\_percentage} = \\\\frac{\\\\text{Electricity from renewables (TWh)}}{\\\\text{total\\\\_energy}} \\\\times 100 \\\\]\"\n    }\n]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""},{"id":"table-97","displayId":"renewable-elec","names":["Electricity from renewables (TWh)","Entity","Year"],"rows":[{"Electricity from renewables (TWh)":17.11,"Entity":"Australia","Year":"2000"},{"Electricity from renewables (TWh)":63.99,"Entity":"Australia","Year":"2020"},{"Electricity from renewables (TWh)":308.77,"Entity":"Brazil","Year":"2000"},{"Electricity from renewables (TWh)":520.01,"Entity":"Brazil","Year":"2020"},{"Electricity from renewables (TWh)":363.7,"Entity":"Canada","Year":"2000"},{"Electricity from renewables (TWh)":429.24,"Entity":"Canada","Year":"2020"},{"Electricity from renewables (TWh)":225.56,"Entity":"China","Year":"2000"},{"Electricity from renewables (TWh)":2184.94,"Entity":"China","Year":"2020"},{"Electricity from renewables (TWh)":67.83,"Entity":"France","Year":"2000"},{"Electricity from renewables (TWh)":125.28,"Entity":"France","Year":"2020"},{"Electricity from renewables (TWh)":35.47,"Entity":"Germany","Year":"2000"},{"Electricity from renewables (TWh)":251.48,"Entity":"Germany","Year":"2020"},{"Electricity from renewables (TWh)":80.27,"Entity":"India","Year":"2000"},{"Electricity from renewables (TWh)":315.76,"Entity":"India","Year":"2020"},{"Electricity from renewables (TWh)":19.6,"Entity":"Indonesia","Year":"2000"},{"Electricity from renewables (TWh)":52.91,"Entity":"Indonesia","Year":"2020"},{"Electricity from renewables (TWh)":50.87,"Entity":"Italy","Year":"2000"},{"Electricity from renewables (TWh)":116.9,"Entity":"Italy","Year":"2020"},{"Electricity from renewables (TWh)":104.16,"Entity":"Japan","Year":"2000"},{"Electricity from renewables (TWh)":205.6,"Entity":"Japan","Year":"2020"},{"Electricity from renewables (TWh)":7.53,"Entity":"Kazakhstan","Year":"2000"},{"Electricity from renewables (TWh)":11.94,"Entity":"Kazakhstan","Year":"2020"},{"Electricity from renewables (TWh)":44.51,"Entity":"Mexico","Year":"2000"},{"Electricity from renewables (TWh)":69.19,"Entity":"Mexico","Year":"2020"},{"Electricity from renewables (TWh)":2.33,"Entity":"Poland","Year":"2000"},{"Electricity from renewables (TWh)":28.23,"Entity":"Poland","Year":"2020"},{"Electricity from renewables (TWh)":0,"Entity":"Saudi Arabia","Year":"2000"},{"Electricity from renewables (TWh)":0.21,"Entity":"Saudi Arabia","Year":"2020"},{"Electricity from renewables (TWh)":1.79,"Entity":"South Africa","Year":"2000"},{"Electricity from renewables (TWh)":12.83,"Entity":"South Africa","Year":"2020"},{"Electricity from renewables (TWh)":34.49,"Entity":"Spain","Year":"2000"},{"Electricity from renewables (TWh)":113.79,"Entity":"Spain","Year":"2020"},{"Electricity from renewables (TWh)":6.38,"Entity":"Thailand","Year":"2000"},{"Electricity from renewables (TWh)":24.73,"Entity":"Thailand","Year":"2020"},{"Electricity from renewables (TWh)":11.28,"Entity":"Ukraine","Year":"2000"},{"Electricity from renewables (TWh)":17.56,"Entity":"Ukraine","Year":"2020"},{"Electricity from renewables (TWh)":9.98,"Entity":"United Kingdom","Year":"2000"},{"Electricity from renewables (TWh)":131.74,"Entity":"United Kingdom","Year":"2020"},{"Electricity from renewables (TWh)":350.93,"Entity":"United States","Year":"2000"},{"Electricity from renewables (TWh)":821.4,"Entity":"United States","Year":"2020"}],"metadata":{"Electricity from renewables (TWh)":{"type":"number","semanticType":"Number"},"Entity":{"type":"string","semanticType":"Location"},"Year":{"type":"number","semanticType":"Year"}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    transformed_df = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Select only the required columns\n    transformed_df = transformed_df[['Entity', 'Year', 'Electricity from renewables (TWh)']]\n    \n    # Convert Year to string for better visualization as a categorical variable\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year for better readability\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 5736319.824, 5738290.039, nan, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 61.99, 62.21, 63.02, 63.71\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"compare each countries renewable between 2000 and 2020\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Energy\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Compare renewable energy (Electricity from renewables) for each country between the years 2000 and 2020. Filter the data to include only years 2000 and 2020, and prepare the output with country names, year, and renewable energy values for visualization as a grouped bar chart.\",\n    \"display_instruction\": \"Compare **renewable energy** by **country** between **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Electricity from renewables (TWh)\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to compare renewable energy across countries between 2000 and 2020. The output field 'Renewable Energy' mentioned in the original chart_encodings maps to 'Electricity from renewables (TWh)' in the dataset. To create a grouped bar chart comparing these two years, we need to filter the data to only include years 2000 and 2020, and output the Entity (country), Year, and the renewable energy values. The chart_encodings are updated to use the actual column name from the dataset.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    transformed_df = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Select only the required columns\n    transformed_df = transformed_df[['Entity', 'Year', 'Electricity from renewables (TWh)']]\n    \n    # Convert Year to string for better visualization as a categorical variable\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year for better readability\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"global-energy-20-small.csv","sourceTableIds":["global-energy-20-small.csv"],"instruction":"compare each countries renewable between 2000 and 2020","displayInstruction":"Compare **renewable energy** by **country** between **2000** and **2020**","chart":{"id":"chart-1760738769634","chartType":"Grouped Bar Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Entity"},"y":{"fieldID":"concept-1760738743125"},"color":{"channel":"color","bin":false,"fieldID":"original--global-energy-20-small.csv--Year"},"column":{"channel":"column","bin":false},"row":{"channel":"row","bin":false}},"tableRef":"global-energy-20-small.csv","saved":false,"source":"trigger","unread":false},"resultTableId":"table-97"},"explanation":{"agent":"CodeExplanationAgent","code":"The code performs a straightforward comparison analysis of renewable energy generation across countries:\n\n- **Filters** the dataset to include only data from years **2000** and **2020**, creating a 20-year comparison window\n- **Selects** three key columns: `Entity` (country name), `Year`, and `Electricity from renewables (TWh)` (renewable energy generation)\n- **Converts** the `Year` field to string format to treat it as a categorical variable for visualization purposes\n- **Sorts** the results by `Entity` and `Year` to organize countries alphabetically with their respective year data grouped together\n- **Returns** a cleaned dataset showing how renewable electricity generation has changed for each country between 2000 and 2020","concepts":[],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 10006669.92, 10502929.69, 10707219.73, nan\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 56.18, 61.99, 63.02, 63.71\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    transformed_df = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Select only the required columns\n    transformed_df = transformed_df[['Entity', 'Year', 'Electricity from renewables (TWh)']]\n    \n    # Convert Year to string for better visualization as a categorical variable\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year for better readability\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\nThe code performs a straightforward comparison analysis of renewable energy generation across countries:\n\n- **Filters** the dataset to include only data from years **2000** and **2020**, creating a 20-year comparison window\n- **Selects** three key columns: `Entity` (country name), `Year`, and `Electricity from renewables (TWh)` (renewable energy generation)\n- **Converts** the `Year` field to string format to treat it as a categorical variable for visualization purposes\n- **Sorts** the results by `Entity` and `Year` to organize countries alphabetically with their respective year data grouped together\n- **Returns** a cleaned dataset showing how renewable electricity generation has changed for each country between 2000 and 2020\n\n[CONCEPTS EXPLANATION]\n\n```json\n[]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""},{"id":"table-27","displayId":"renewable-energy1","names":["Entity","Renewable Percentage","Year"],"rows":[{"Entity":"Australia","Renewable Percentage":8.6344368187,"Year":"2000"},{"Entity":"Australia","Renewable Percentage":25.5031684668,"Year":"2020"},{"Entity":"Brazil","Renewable Percentage":90.1307723743,"Year":"2000"},{"Entity":"Brazil","Renewable Percentage":84.6411771408,"Year":"2020"},{"Entity":"Canada","Renewable Percentage":61.8095917882,"Year":"2000"},{"Entity":"Canada","Renewable Percentage":68.7796436354,"Year":"2020"},{"Entity":"China","Renewable Percentage":16.639126586,"Year":"2000"},{"Entity":"China","Renewable Percentage":28.2464606924,"Year":"2020"},{"Entity":"France","Renewable Percentage":12.7117691154,"Year":"2000"},{"Entity":"France","Renewable Percentage":23.7610241821,"Year":"2020"},{"Entity":"Germany","Renewable Percentage":6.1977983575,"Year":"2000"},{"Entity":"Germany","Renewable Percentage":44.3324048937,"Year":"2020"},{"Entity":"Global Average","Renewable Percentage":16.4213212559,"Year":"2000"},{"Entity":"Global Average","Renewable Percentage":29.2955247263,"Year":"2020"},{"Entity":"India","Renewable Percentage":14.0481982534,"Year":"2000"},{"Entity":"India","Renewable Percentage":20.2059243238,"Year":"2020"},{"Entity":"Indonesia","Renewable Percentage":null,"Year":"2000"},{"Entity":"Indonesia","Renewable Percentage":null,"Year":"2020"},{"Entity":"Italy","Renewable Percentage":18.900241501,"Year":"2000"},{"Entity":"Italy","Renewable Percentage":42.0397741576,"Year":"2020"},{"Entity":"Japan","Renewable Percentage":10.5382436261,"Year":"2000"},{"Entity":"Japan","Renewable Percentage":21.324925062,"Year":"2020"},{"Entity":"Kazakhstan","Renewable Percentage":null,"Year":"2000"},{"Entity":"Kazakhstan","Renewable Percentage":null,"Year":"2020"},{"Entity":"Mexico","Renewable Percentage":22.9291160107,"Year":"2000"},{"Entity":"Mexico","Renewable Percentage":21.2552224134,"Year":"2020"},{"Entity":"Poland","Renewable Percentage":1.6273222517,"Year":"2000"},{"Entity":"Poland","Renewable Percentage":17.9648720886,"Year":"2020"},{"Entity":"Saudi Arabia","Renewable Percentage":null,"Year":"2000"},{"Entity":"Saudi Arabia","Renewable Percentage":null,"Year":"2020"},{"Entity":"South Africa","Renewable Percentage":0.9110805721,"Year":"2000"},{"Entity":"South Africa","Renewable Percentage":5.780581212,"Year":"2020"},{"Entity":"Spain","Renewable Percentage":15.6119862394,"Year":"2000"},{"Entity":"Spain","Renewable Percentage":43.8108805298,"Year":"2020"},{"Entity":"Thailand","Renewable Percentage":7.1261029822,"Year":"2000"},{"Entity":"Thailand","Renewable Percentage":13.7963737796,"Year":"2020"},{"Entity":"Ukraine","Renewable Percentage":6.5860921352,"Year":"2000"},{"Entity":"Ukraine","Renewable Percentage":11.8440577364,"Year":"2020"},{"Entity":"United Kingdom","Renewable Percentage":2.6657406913,"Year":"2000"},{"Entity":"United Kingdom","Renewable Percentage":42.8603962651,"Year":"2020"},{"Entity":"United States","Renewable Percentage":9.2298992662,"Year":"2000"},{"Entity":"United States","Renewable Percentage":20.3156921037,"Year":"2020"}],"metadata":{"Entity":{"type":"string","semanticType":"Name"},"Renewable Percentage":{"type":"number","semanticType":"Percentage"},"Year":{"type":"number","semanticType":"Year"}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    df_filtered = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Calculate total electricity generation\n    df_filtered['Total Electricity'] = (\n        df_filtered['Electricity from fossil fuels (TWh)'] + \n        df_filtered['Electricity from nuclear (TWh)'] + \n        df_filtered['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_filtered['Renewable Percentage'] = (\n        df_filtered['Electricity from renewables (TWh)'] / df_filtered['Total Electricity'] * 100\n    )\n    \n    # Select required columns for individual countries\n    country_data = df_filtered[['Entity', 'Year', 'Renewable Percentage']].copy()\n    \n    # Calculate global average for each year\n    global_avg = df_filtered.groupby('Year').apply(\n        lambda x: pd.Series({\n            'Entity': 'Global Average',\n            'Year': x['Year'].iloc[0],\n            'Renewable Percentage': (\n                x['Electricity from renewables (TWh)'].sum() / x['Total Electricity'].sum() * 100\n            )\n        })\n    ).reset_index(drop=True)\n    \n    # Combine country data with global average\n    transformed_df = pd.concat([country_data, global_avg], ignore_index=True)\n    \n    # Convert Year to string for better visualization\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 5736319.824, 5738290.039, nan, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 61.99, 62.21, 63.02, 63.71\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"compare each countries renewable between 2000 and 2020\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Energy\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Compare renewable energy (Electricity from renewables) for each country between the years 2000 and 2020. Filter the data to include only years 2000 and 2020, and prepare the output with country names, year, and renewable energy values for visualization as a grouped bar chart.\",\n    \"display_instruction\": \"Compare **renewable energy** by **country** between **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Electricity from renewables (TWh)\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to compare renewable energy across countries between 2000 and 2020. The output field 'Renewable Energy' mentioned in the original chart_encodings maps to 'Electricity from renewables (TWh)' in the dataset. To create a grouped bar chart comparing these two years, we need to filter the data to only include years 2000 and 2020, and output the Entity (country), Year, and the renewable energy values. The chart_encodings are updated to use the actual column name from the dataset.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    transformed_df = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Select only the required columns\n    transformed_df = transformed_df[['Entity', 'Year', 'Electricity from renewables (TWh)']]\n    \n    # Convert Year to string for better visualization as a categorical variable\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year for better readability\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n   Electricity from renewables (TWh)     Entity  Year\n0                              17.11  Australia  2000\n1                              63.99  Australia  2020\n2                             308.77     Brazil  2000\n3                             520.01     Brazil  2020\n4                             363.70     Canada  2000\n5                             429.24     Canada  2020\n6                             225.56      China  2000\n7                            2184.94      China  2020\n8                              67.83     France  2000\n9                             125.28     France  2020\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show their renewable percentage instead, and add an entity to show global average\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Calculate the renewable energy percentage (proportion of renewables to total electricity generation from all sources) for each country between 2000 and 2020. Add a 'Global Average' entity that represents the worldwide average renewable percentage for each year. The output should include Entity (with 'Global Average' added), Year, and the renewable percentage.\",\n    \"display_instruction\": \"Show **renewable energy percentage** by **country** with **global average** for **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Renewable Percentage\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Percentage\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to see renewable percentage instead of absolute values, and wants to add a global average entity for comparison. Renewable percentage is calculated as the ratio of renewable energy to total electricity generation (fossil fuels + nuclear + renewables). A 'Global Average' entity needs to be computed by aggregating all countries' data for each year. The y-axis encoding is updated to reflect the new metric 'Renewable Percentage'.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    df_filtered = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Calculate total electricity generation\n    df_filtered['Total Electricity'] = (\n        df_filtered['Electricity from fossil fuels (TWh)'] + \n        df_filtered['Electricity from nuclear (TWh)'] + \n        df_filtered['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_filtered['Renewable Percentage'] = (\n        df_filtered['Electricity from renewables (TWh)'] / df_filtered['Total Electricity'] * 100\n    )\n    \n    # Select required columns for individual countries\n    country_data = df_filtered[['Entity', 'Year', 'Renewable Percentage']].copy()\n    \n    # Calculate global average for each year\n    global_avg = df_filtered.groupby('Year').apply(\n        lambda x: pd.Series({\n            'Entity': 'Global Average',\n            'Year': x['Year'].iloc[0],\n            'Renewable Percentage': (\n                x['Electricity from renewables (TWh)'].sum() / x['Total Electricity'].sum() * 100\n            )\n        })\n    ).reset_index(drop=True)\n    \n    # Combine country data with global average\n    transformed_df = pd.concat([country_data, global_avg], ignore_index=True)\n    \n    # Convert Year to string for better visualization\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"table-97","sourceTableIds":["global-energy-20-small.csv"],"instruction":"show their renewable percentage instead, and add an entity to show global average","displayInstruction":"Show **renewable energy percentage** by **country** with **global average** for **2000** and **2020**","chart":{"id":"chart-1760738813383","chartType":"Grouped Bar Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Entity"},"y":{"fieldID":"original--global-energy-20-small.csv--Electricity from renewables (TWh)"},"color":{"fieldID":"original--global-energy-20-small.csv--Year"},"column":{"channel":"column","bin":false},"row":{"channel":"row","bin":false}},"tableRef":"table-97","saved":false,"source":"trigger","unread":false},"resultTableId":"table-27"},"explanation":{"agent":"CodeExplanationAgent","code":"The code performs the following transformation steps:\n\n1. **Filter data** to include only records from **2000** and **2020**\n2. Calculate **Total Electricity** generation by summing three sources: **fossil fuels**, **nuclear**, and **renewables** (all measured in TWh)\n3. Compute **Renewable Percentage** for each country and year by dividing **Electricity from renewables** by **Total Electricity** and multiplying by 100\n4. Extract relevant columns: **Entity** (country name), **Year**, and **Renewable Percentage**\n5. Calculate **Global Average** renewable percentage for each year by:\n   - Summing all countries' **renewable electricity** generation\n   - Dividing by the sum of all countries' **total electricity** generation\n   - Multiplying by 100 to get percentage\n6. Combine individual country data with the **Global Average** statistics\n7. Convert **Year** values to string format\n8. Sort results by **Entity** name and **Year**","concepts":[{"explanation":"The sum of electricity generated from all three sources (fossil fuels, nuclear, and renewables) measured in terawatt-hours (TWh). This represents the total electricity production capacity for each country.","field":"Total Electricity"},{"explanation":"The proportion of electricity generated from renewable sources relative to total electricity production, expressed as a percentage: \\( \\text{Renewable Percentage} = \\frac{\\text{Electricity from renewables}}{\\text{Total Electricity}} \\times 100 \\). This metric indicates the extent of renewable energy adoption in a country's electricity mix.","field":"Renewable Percentage"}],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 10096009.77, 10502929.69, 10707219.73, nan\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., nan, nan, nan, nan\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    df_filtered = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Calculate total electricity generation\n    df_filtered['Total Electricity'] = (\n        df_filtered['Electricity from fossil fuels (TWh)'] + \n        df_filtered['Electricity from nuclear (TWh)'] + \n        df_filtered['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_filtered['Renewable Percentage'] = (\n        df_filtered['Electricity from renewables (TWh)'] / df_filtered['Total Electricity'] * 100\n    )\n    \n    # Select required columns for individual countries\n    country_data = df_filtered[['Entity', 'Year', 'Renewable Percentage']].copy()\n    \n    # Calculate global average for each year\n    global_avg = df_filtered.groupby('Year').apply(\n        lambda x: pd.Series({\n            'Entity': 'Global Average',\n            'Year': x['Year'].iloc[0],\n            'Renewable Percentage': (\n                x['Electricity from renewables (TWh)'].sum() / x['Total Electricity'].sum() * 100\n            )\n        })\n    ).reset_index(drop=True)\n    \n    # Combine country data with global average\n    transformed_df = pd.concat([country_data, global_avg], ignore_index=True)\n    \n    # Convert Year to string for better visualization\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\nThe code performs the following transformation steps:\n\n1. **Filter data** to include only records from **2000** and **2020**\n2. Calculate **Total Electricity** generation by summing three sources: **fossil fuels**, **nuclear**, and **renewables** (all measured in TWh)\n3. Compute **Renewable Percentage** for each country and year by dividing **Electricity from renewables** by **Total Electricity** and multiplying by 100\n4. Extract relevant columns: **Entity** (country name), **Year**, and **Renewable Percentage**\n5. Calculate **Global Average** renewable percentage for each year by:\n   - Summing all countries' **renewable electricity** generation\n   - Dividing by the sum of all countries' **total electricity** generation\n   - Multiplying by 100 to get percentage\n6. Combine individual country data with the **Global Average** statistics\n7. Convert **Year** values to string format\n8. Sort results by **Entity** name and **Year**\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"Total Electricity\",\n        \"explanation\": \"The sum of electricity generated from all three sources (fossil fuels, nuclear, and renewables) measured in terawatt-hours (TWh). This represents the total electricity production capacity for each country.\"\n    },\n    {\n        \"field\": \"Renewable Percentage\",\n        \"explanation\": \"The proportion of electricity generated from renewable sources relative to total electricity production, expressed as a percentage: \\\\( \\\\text{Renewable Percentage} = \\\\frac{\\\\text{Electricity from renewables}}{\\\\text{Total Electricity}} \\\\times 100 \\\\). This metric indicates the extent of renewable energy adoption in a country's electricity mix.\"\n    }\n]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""},{"id":"table-81","displayId":"energy-source1","names":["Energy","Energy Source","Year"],"rows":[{"Energy":7160.71,"Energy Source":"Fossil Fuels","Year":2000},{"Energy":1996.65,"Energy Source":"Nuclear","Year":2000},{"Energy":1742.56,"Energy Source":"Renewables","Year":2000},{"Energy":7273.89,"Energy Source":"Fossil Fuels","Year":2001},{"Energy":2037.54,"Energy Source":"Nuclear","Year":2001},{"Energy":1690.11,"Energy Source":"Renewables","Year":2001},{"Energy":7621.07,"Energy Source":"Fossil Fuels","Year":2002},{"Energy":2042.18,"Energy Source":"Nuclear","Year":2002},{"Energy":1757.63,"Energy Source":"Renewables","Year":2002},{"Energy":8043.86,"Energy Source":"Fossil Fuels","Year":2003},{"Energy":1998.52,"Energy Source":"Nuclear","Year":2003},{"Energy":1804.52,"Energy Source":"Renewables","Year":2003},{"Energy":8399.72,"Energy Source":"Fossil Fuels","Year":2004},{"Energy":2095,"Energy Source":"Nuclear","Year":2004},{"Energy":1952.72,"Energy Source":"Renewables","Year":2004},{"Energy":8828.43,"Energy Source":"Fossil Fuels","Year":2005},{"Energy":2094.4,"Energy Source":"Nuclear","Year":2005},{"Energy":2025.26,"Energy Source":"Renewables","Year":2005},{"Energy":9183.05,"Energy Source":"Fossil Fuels","Year":2006},{"Energy":2120.38,"Energy Source":"Nuclear","Year":2006},{"Energy":2165.94,"Energy Source":"Renewables","Year":2006},{"Energy":9853.09,"Energy Source":"Fossil Fuels","Year":2007},{"Energy":2067.04,"Energy Source":"Nuclear","Year":2007},{"Energy":2256.79,"Energy Source":"Renewables","Year":2007},{"Energy":9817.15,"Energy Source":"Fossil Fuels","Year":2008},{"Energy":2043.94,"Energy Source":"Nuclear","Year":2008},{"Energy":2496.03,"Energy Source":"Renewables","Year":2008},{"Energy":9686.86,"Energy Source":"Fossil Fuels","Year":2009},{"Energy":2017.25,"Energy Source":"Nuclear","Year":2009},{"Energy":2563.95,"Energy Source":"Renewables","Year":2009},{"Energy":10427.03,"Energy Source":"Fossil Fuels","Year":2010},{"Energy":2083.37,"Energy Source":"Nuclear","Year":2010},{"Energy":2802.89,"Energy Source":"Renewables","Year":2010},{"Energy":10974.83,"Energy Source":"Fossil Fuels","Year":2011},{"Energy":1956,"Energy Source":"Nuclear","Year":2011},{"Energy":2997.29,"Energy Source":"Renewables","Year":2011},{"Energy":11277.49,"Energy Source":"Fossil Fuels","Year":2012},{"Energy":1788.26,"Energy Source":"Nuclear","Year":2012},{"Energy":3226.1,"Energy Source":"Renewables","Year":2012},{"Energy":11561.86,"Energy Source":"Fossil Fuels","Year":2013},{"Energy":1813,"Energy Source":"Nuclear","Year":2013},{"Energy":3473.9,"Energy Source":"Renewables","Year":2013},{"Energy":11761.51,"Energy Source":"Fossil Fuels","Year":2014},{"Energy":1847.87,"Energy Source":"Nuclear","Year":2014},{"Energy":3753.03,"Energy Source":"Renewables","Year":2014},{"Energy":11653.61,"Energy Source":"Fossil Fuels","Year":2015},{"Energy":1886.61,"Energy Source":"Nuclear","Year":2015},{"Energy":3903.7,"Energy Source":"Renewables","Year":2015},{"Energy":11785.35,"Energy Source":"Fossil Fuels","Year":2016},{"Energy":1906.92,"Energy Source":"Nuclear","Year":2016},{"Energy":4186.83,"Energy Source":"Renewables","Year":2016},{"Energy":12003.24,"Energy Source":"Fossil Fuels","Year":2017},{"Energy":1942.94,"Energy Source":"Nuclear","Year":2017},{"Energy":4500.22,"Energy Source":"Renewables","Year":2017},{"Energy":12445.24,"Energy Source":"Fossil Fuels","Year":2018},{"Energy":2016.82,"Energy Source":"Nuclear","Year":2018},{"Energy":4834.65,"Energy Source":"Renewables","Year":2018},{"Energy":12355.91,"Energy Source":"Fossil Fuels","Year":2019},{"Energy":2073.87,"Energy Source":"Nuclear","Year":2019},{"Energy":5146.11,"Energy Source":"Renewables","Year":2019},{"Energy":12032.75,"Energy Source":"Fossil Fuels","Year":2020},{"Energy":1974.46,"Energy Source":"Nuclear","Year":2020},{"Energy":5497.73,"Energy Source":"Renewables","Year":2020}],"metadata":{"Energy":{"type":"number","semanticType":"Number"},"Energy Source":{"type":"string","semanticType":"String","levels":["Fossil Fuels","Nuclear","Renewables"]},"Year":{"type":"number","semanticType":"Year"}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Group by Year and sum electricity generation from all countries\n    global_energy = df_energy.groupby('Year').agg({\n        'Electricity from fossil fuels (TWh)': 'sum',\n        'Electricity from nuclear (TWh)': 'sum',\n        'Electricity from renewables (TWh)': 'sum'\n    }).reset_index()\n    \n    # Rename columns for clarity\n    global_energy.columns = ['Year', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        global_energy,\n        id_vars=['Year'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Year and Energy Source\n    transformed_df = transformed_df.sort_values(['Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 5736319.824, 5738290.039, nan, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 61.99, 62.21, 63.02, 63.71\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"compare each countries renewable between 2000 and 2020\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Energy\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Compare renewable energy (Electricity from renewables) for each country between the years 2000 and 2020. Filter the data to include only years 2000 and 2020, and prepare the output with country names, year, and renewable energy values for visualization as a grouped bar chart.\",\n    \"display_instruction\": \"Compare **renewable energy** by **country** between **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Electricity from renewables (TWh)\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to compare renewable energy across countries between 2000 and 2020. The output field 'Renewable Energy' mentioned in the original chart_encodings maps to 'Electricity from renewables (TWh)' in the dataset. To create a grouped bar chart comparing these two years, we need to filter the data to only include years 2000 and 2020, and output the Entity (country), Year, and the renewable energy values. The chart_encodings are updated to use the actual column name from the dataset.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    transformed_df = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Select only the required columns\n    transformed_df = transformed_df[['Entity', 'Year', 'Electricity from renewables (TWh)']]\n    \n    # Convert Year to string for better visualization as a categorical variable\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year for better readability\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n   Electricity from renewables (TWh)     Entity  Year\n0                              17.11  Australia  2000\n1                              63.99  Australia  2020\n2                             308.77     Brazil  2000\n3                             520.01     Brazil  2020\n4                             363.70     Canada  2000\n5                             429.24     Canada  2020\n6                             225.56      China  2000\n7                            2184.94      China  2020\n8                              67.83     France  2000\n9                             125.28     France  2020\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show their renewable percentage instead, and add an entity to show global average\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Calculate the renewable energy percentage (proportion of renewables to total electricity generation from all sources) for each country between 2000 and 2020. Add a 'Global Average' entity that represents the worldwide average renewable percentage for each year. The output should include Entity (with 'Global Average' added), Year, and the renewable percentage.\",\n    \"display_instruction\": \"Show **renewable energy percentage** by **country** with **global average** for **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Renewable Percentage\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Percentage\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to see renewable percentage instead of absolute values, and wants to add a global average entity for comparison. Renewable percentage is calculated as the ratio of renewable energy to total electricity generation (fossil fuels + nuclear + renewables). A 'Global Average' entity needs to be computed by aggregating all countries' data for each year. The y-axis encoding is updated to reflect the new metric 'Renewable Percentage'.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    df_filtered = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Calculate total electricity generation\n    df_filtered['Total Electricity'] = (\n        df_filtered['Electricity from fossil fuels (TWh)'] + \n        df_filtered['Electricity from nuclear (TWh)'] + \n        df_filtered['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_filtered['Renewable Percentage'] = (\n        df_filtered['Electricity from renewables (TWh)'] / df_filtered['Total Electricity'] * 100\n    )\n    \n    # Select required columns for individual countries\n    country_data = df_filtered[['Entity', 'Year', 'Renewable Percentage']].copy()\n    \n    # Calculate global average for each year\n    global_avg = df_filtered.groupby('Year').apply(\n        lambda x: pd.Series({\n            'Entity': 'Global Average',\n            'Year': x['Year'].iloc[0],\n            'Renewable Percentage': (\n                x['Electricity from renewables (TWh)'].sum() / x['Total Electricity'].sum() * 100\n            )\n        })\n    ).reset_index(drop=True)\n    \n    # Combine country data with global average\n    transformed_df = pd.concat([country_data, global_avg], ignore_index=True)\n    \n    # Convert Year to string for better visualization\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n      Entity  Renewable Percentage  Year\n0  Australia              8.634437  2000\n1  Australia             25.503168  2020\n2     Brazil             90.130772  2000\n3     Brazil             84.641177  2020\n4     Canada             61.809592  2000\n5     Canada             68.779644  2020\n6      China             16.639127  2000\n7      China             28.246461  2020\n8     France             12.711769  2000\n9     France             23.761024  2020\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show global energy composition over time\",\n    \"chart_type\": \"Custom Area\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"Energy\",\n        \"color\": \"Energy Source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Show the global energy composition over time by aggregating electricity generation from all countries for each year, broken down by energy source (fossil fuels, nuclear, and renewables). The output should be in long format with Year, Energy Source, and Energy values to support a stacked area chart visualization.\",\n    \"display_instruction\": \"Show global **energy composition** by **energy source** over time\",\n    \"output_fields\": [\"Year\", \"Energy Source\", \"Energy\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"Energy\",\n        \"color\": \"Energy Source\"\n    },\n    \"reason\": \"The user wants to visualize global energy composition over time, which requires aggregating electricity generation data across all countries for each year and breaking it down by energy source type. The data needs to be transformed into long format where each row represents a year-energy source combination, with the total energy value for that source globally. This follows up from the previous renewable percentage analysis by showing the overall energy mix trends rather than focusing on specific countries or percentages.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Group by Year and sum electricity generation from all countries\n    global_energy = df_energy.groupby('Year').agg({\n        'Electricity from fossil fuels (TWh)': 'sum',\n        'Electricity from nuclear (TWh)': 'sum',\n        'Electricity from renewables (TWh)': 'sum'\n    }).reset_index()\n    \n    # Rename columns for clarity\n    global_energy.columns = ['Year', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        global_energy,\n        id_vars=['Year'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Year and Energy Source\n    transformed_df = transformed_df.sort_values(['Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"table-27","sourceTableIds":["global-energy-20-small.csv"],"instruction":"show global energy composition over time","displayInstruction":"Show global **energy composition** by **energy source** over time","chart":{"id":"chart-1760738942326","chartType":"Custom Area","encodingMap":{"x":{"channel":"x","bin":false,"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"channel":"y","bin":false,"fieldID":"concept-1760738917347"},"x2":{"channel":"x2","bin":false},"y2":{"channel":"y2","bin":false},"color":{"channel":"color","bin":false,"fieldID":"concept-1760738921927"},"column":{"channel":"column","bin":false},"row":{"channel":"row","bin":false}},"tableRef":"table-27","saved":false,"source":"trigger","unread":false},"resultTableId":"table-81"},"explanation":{"agent":"CodeExplanationAgent","code":"- Group the energy data by **Year** and aggregate electricity generation values across all countries by summing **Electricity from fossil fuels (TWh)**, **Electricity from nuclear (TWh)**, and **Electricity from renewables (TWh)**\n- Rename the aggregated columns to simplified labels: **Fossil Fuels**, **Nuclear**, and **Renewables**\n- Transform the data from wide format to long format by unpivoting the three energy source columns into two columns: **Energy Source** (containing the type of energy) and **Energy** (containing the generation value in TWh)\n- Sort the resulting dataset by **Year** and **Energy Source** for consistent ordering","concepts":[],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 158029.9988, 190729.9957, 209229.9957, ..., nan, 4956060.059, nan, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., nan, nan, nan, nan\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Group by Year and sum electricity generation from all countries\n    global_energy = df_energy.groupby('Year').agg({\n        'Electricity from fossil fuels (TWh)': 'sum',\n        'Electricity from nuclear (TWh)': 'sum',\n        'Electricity from renewables (TWh)': 'sum'\n    }).reset_index()\n    \n    # Rename columns for clarity\n    global_energy.columns = ['Year', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        global_energy,\n        id_vars=['Year'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Year and Energy Source\n    transformed_df = transformed_df.sort_values(['Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\n- Group the energy data by **Year** and aggregate electricity generation values across all countries by summing **Electricity from fossil fuels (TWh)**, **Electricity from nuclear (TWh)**, and **Electricity from renewables (TWh)**\n- Rename the aggregated columns to simplified labels: **Fossil Fuels**, **Nuclear**, and **Renewables**\n- Transform the data from wide format to long format by unpivoting the three energy source columns into two columns: **Energy Source** (containing the type of energy) and **Energy** (containing the generation value in TWh)\n- Sort the resulting dataset by **Year** and **Energy Source** for consistent ordering\n\n[CONCEPTS EXPLANATION]\n\n```json\n[]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""},{"id":"table-10","displayId":"energy-source2","names":["Energy","Energy Source","Entity","Year"],"rows":[{"Energy":1113.3,"Energy Source":"Fossil Fuels","Entity":"China","Year":2000},{"Energy":16.74,"Energy Source":"Nuclear","Entity":"China","Year":2000},{"Energy":225.56,"Energy Source":"Renewables","Entity":"China","Year":2000},{"Energy":1182.59,"Energy Source":"Fossil Fuels","Entity":"China","Year":2001},{"Energy":17.47,"Energy Source":"Nuclear","Entity":"China","Year":2001},{"Energy":280.73,"Energy Source":"Renewables","Entity":"China","Year":2001},{"Energy":1337.46,"Energy Source":"Fossil Fuels","Entity":"China","Year":2002},{"Energy":25.13,"Energy Source":"Nuclear","Entity":"China","Year":2002},{"Energy":291.41,"Energy Source":"Renewables","Entity":"China","Year":2002},{"Energy":1579.96,"Energy Source":"Fossil Fuels","Entity":"China","Year":2003},{"Energy":43.34,"Energy Source":"Nuclear","Entity":"China","Year":2003},{"Energy":287.28,"Energy Source":"Renewables","Entity":"China","Year":2003},{"Energy":1795.41,"Energy Source":"Fossil Fuels","Entity":"China","Year":2004},{"Energy":50.47,"Energy Source":"Nuclear","Entity":"China","Year":2004},{"Energy":357.43,"Energy Source":"Renewables","Entity":"China","Year":2004},{"Energy":2042.8,"Energy Source":"Fossil Fuels","Entity":"China","Year":2005},{"Energy":53.09,"Energy Source":"Nuclear","Entity":"China","Year":2005},{"Energy":404.37,"Energy Source":"Renewables","Entity":"China","Year":2005},{"Energy":2364.16,"Energy Source":"Fossil Fuels","Entity":"China","Year":2006},{"Energy":54.84,"Energy Source":"Nuclear","Entity":"China","Year":2006},{"Energy":446.72,"Energy Source":"Renewables","Entity":"China","Year":2006},{"Energy":2718.7,"Energy Source":"Fossil Fuels","Entity":"China","Year":2007},{"Energy":62.13,"Energy Source":"Nuclear","Entity":"China","Year":2007},{"Energy":500.71,"Energy Source":"Renewables","Entity":"China","Year":2007},{"Energy":2762.29,"Energy Source":"Fossil Fuels","Entity":"China","Year":2008},{"Energy":68.39,"Energy Source":"Nuclear","Entity":"China","Year":2008},{"Energy":665.08,"Energy Source":"Renewables","Entity":"China","Year":2008},{"Energy":2980.2,"Energy Source":"Fossil Fuels","Entity":"China","Year":2009},{"Energy":70.05,"Energy Source":"Nuclear","Entity":"China","Year":2009},{"Energy":664.39,"Energy Source":"Renewables","Entity":"China","Year":2009},{"Energy":3326.19,"Energy Source":"Fossil Fuels","Entity":"China","Year":2010},{"Energy":74.74,"Energy Source":"Nuclear","Entity":"China","Year":2010},{"Energy":786.38,"Energy Source":"Renewables","Entity":"China","Year":2010},{"Energy":3811.77,"Energy Source":"Fossil Fuels","Entity":"China","Year":2011},{"Energy":87.2,"Energy Source":"Nuclear","Entity":"China","Year":2011},{"Energy":792.38,"Energy Source":"Renewables","Entity":"China","Year":2011},{"Energy":3869.38,"Energy Source":"Fossil Fuels","Entity":"China","Year":2012},{"Energy":98.32,"Energy Source":"Nuclear","Entity":"China","Year":2012},{"Energy":999.56,"Energy Source":"Renewables","Entity":"China","Year":2012},{"Energy":4203.77,"Energy Source":"Fossil Fuels","Entity":"China","Year":2013},{"Energy":111.5,"Energy Source":"Nuclear","Entity":"China","Year":2013},{"Energy":1093.37,"Energy Source":"Renewables","Entity":"China","Year":2013},{"Energy":4345.86,"Energy Source":"Fossil Fuels","Entity":"China","Year":2014},{"Energy":133.22,"Energy Source":"Nuclear","Entity":"China","Year":2014},{"Energy":1289.23,"Energy Source":"Renewables","Entity":"China","Year":2014},{"Energy":4222.76,"Energy Source":"Fossil Fuels","Entity":"China","Year":2015},{"Energy":171.38,"Energy Source":"Nuclear","Entity":"China","Year":2015},{"Energy":1393.66,"Energy Source":"Renewables","Entity":"China","Year":2015},{"Energy":4355,"Energy Source":"Fossil Fuels","Entity":"China","Year":2016},{"Energy":213.18,"Energy Source":"Nuclear","Entity":"China","Year":2016},{"Energy":1522.79,"Energy Source":"Renewables","Entity":"China","Year":2016},{"Energy":4643.1,"Energy Source":"Fossil Fuels","Entity":"China","Year":2017},{"Energy":248.1,"Energy Source":"Nuclear","Entity":"China","Year":2017},{"Energy":1667.06,"Energy Source":"Renewables","Entity":"China","Year":2017},{"Energy":4990.28,"Energy Source":"Fossil Fuels","Entity":"China","Year":2018},{"Energy":295,"Energy Source":"Nuclear","Entity":"China","Year":2018},{"Energy":1835.32,"Energy Source":"Renewables","Entity":"China","Year":2018},{"Energy":5098.22,"Energy Source":"Fossil Fuels","Entity":"China","Year":2019},{"Energy":348.7,"Energy Source":"Nuclear","Entity":"China","Year":2019},{"Energy":2014.57,"Energy Source":"Renewables","Entity":"China","Year":2019},{"Energy":5184.13,"Energy Source":"Fossil Fuels","Entity":"China","Year":2020},{"Energy":366.2,"Energy Source":"Nuclear","Entity":"China","Year":2020},{"Energy":2184.94,"Energy Source":"Renewables","Entity":"China","Year":2020},{"Energy":475.35,"Energy Source":"Fossil Fuels","Entity":"India","Year":2000},{"Energy":15.77,"Energy Source":"Nuclear","Entity":"India","Year":2000},{"Energy":80.27,"Energy Source":"Renewables","Entity":"India","Year":2000},{"Energy":491.01,"Energy Source":"Fossil Fuels","Entity":"India","Year":2001},{"Energy":18.89,"Energy Source":"Nuclear","Entity":"India","Year":2001},{"Energy":76.19,"Energy Source":"Renewables","Entity":"India","Year":2001},{"Energy":517.51,"Energy Source":"Fossil Fuels","Entity":"India","Year":2002},{"Energy":19.35,"Energy Source":"Nuclear","Entity":"India","Year":2002},{"Energy":72.78,"Energy Source":"Renewables","Entity":"India","Year":2002},{"Energy":545.36,"Energy Source":"Fossil Fuels","Entity":"India","Year":2003},{"Energy":18.14,"Energy Source":"Nuclear","Entity":"India","Year":2003},{"Energy":74.63,"Energy Source":"Renewables","Entity":"India","Year":2003},{"Energy":567.86,"Energy Source":"Fossil Fuels","Entity":"India","Year":2004},{"Energy":21.26,"Energy Source":"Nuclear","Entity":"India","Year":2004},{"Energy":109.2,"Energy Source":"Renewables","Entity":"India","Year":2004},{"Energy":579.32,"Energy Source":"Fossil Fuels","Entity":"India","Year":2005},{"Energy":17.73,"Energy Source":"Nuclear","Entity":"India","Year":2005},{"Energy":107.47,"Energy Source":"Renewables","Entity":"India","Year":2005},{"Energy":599.24,"Energy Source":"Fossil Fuels","Entity":"India","Year":2006},{"Energy":17.63,"Energy Source":"Nuclear","Entity":"India","Year":2006},{"Energy":127.56,"Energy Source":"Renewables","Entity":"India","Year":2006},{"Energy":636.68,"Energy Source":"Fossil Fuels","Entity":"India","Year":2007},{"Energy":17.83,"Energy Source":"Nuclear","Entity":"India","Year":2007},{"Energy":141.75,"Energy Source":"Renewables","Entity":"India","Year":2007},{"Energy":674.27,"Energy Source":"Fossil Fuels","Entity":"India","Year":2008},{"Energy":15.23,"Energy Source":"Nuclear","Entity":"India","Year":2008},{"Energy":138.91,"Energy Source":"Renewables","Entity":"India","Year":2008},{"Energy":728.56,"Energy Source":"Fossil Fuels","Entity":"India","Year":2009},{"Energy":16.82,"Energy Source":"Nuclear","Entity":"India","Year":2009},{"Energy":134.33,"Energy Source":"Renewables","Entity":"India","Year":2009},{"Energy":771.78,"Energy Source":"Fossil Fuels","Entity":"India","Year":2010},{"Energy":23.08,"Energy Source":"Nuclear","Entity":"India","Year":2010},{"Energy":142.61,"Energy Source":"Renewables","Entity":"India","Year":2010},{"Energy":828.16,"Energy Source":"Fossil Fuels","Entity":"India","Year":2011},{"Energy":32.22,"Energy Source":"Nuclear","Entity":"India","Year":2011},{"Energy":173.62,"Energy Source":"Renewables","Entity":"India","Year":2011},{"Energy":893.45,"Energy Source":"Fossil Fuels","Entity":"India","Year":2012},{"Energy":33.14,"Energy Source":"Nuclear","Entity":"India","Year":2012},{"Energy":165.25,"Energy Source":"Renewables","Entity":"India","Year":2012},{"Energy":924.93,"Energy Source":"Fossil Fuels","Entity":"India","Year":2013},{"Energy":33.31,"Energy Source":"Nuclear","Entity":"India","Year":2013},{"Energy":187.9,"Energy Source":"Renewables","Entity":"India","Year":2013},{"Energy":1025.29,"Energy Source":"Fossil Fuels","Entity":"India","Year":2014},{"Energy":34.69,"Energy Source":"Nuclear","Entity":"India","Year":2014},{"Energy":202.04,"Energy Source":"Renewables","Entity":"India","Year":2014},{"Energy":1080.44,"Energy Source":"Fossil Fuels","Entity":"India","Year":2015},{"Energy":38.31,"Energy Source":"Nuclear","Entity":"India","Year":2015},{"Energy":203.21,"Energy Source":"Renewables","Entity":"India","Year":2015},{"Energy":1155.52,"Energy Source":"Fossil Fuels","Entity":"India","Year":2016},{"Energy":37.9,"Energy Source":"Nuclear","Entity":"India","Year":2016},{"Energy":208.21,"Energy Source":"Renewables","Entity":"India","Year":2016},{"Energy":1198.85,"Energy Source":"Fossil Fuels","Entity":"India","Year":2017},{"Energy":37.41,"Energy Source":"Nuclear","Entity":"India","Year":2017},{"Energy":234.9,"Energy Source":"Renewables","Entity":"India","Year":2017},{"Energy":1276.32,"Energy Source":"Fossil Fuels","Entity":"India","Year":2018},{"Energy":39.05,"Energy Source":"Nuclear","Entity":"India","Year":2018},{"Energy":263.61,"Energy Source":"Renewables","Entity":"India","Year":2018},{"Energy":1273.59,"Energy Source":"Fossil Fuels","Entity":"India","Year":2019},{"Energy":45.16,"Energy Source":"Nuclear","Entity":"India","Year":2019},{"Energy":303.16,"Energy Source":"Renewables","Entity":"India","Year":2019},{"Energy":1202.34,"Energy Source":"Fossil Fuels","Entity":"India","Year":2020},{"Energy":44.61,"Energy Source":"Nuclear","Entity":"India","Year":2020},{"Energy":315.76,"Energy Source":"Renewables","Entity":"India","Year":2020},{"Energy":2697.28,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2000},{"Energy":753.89,"Energy Source":"Nuclear","Entity":"United States","Year":2000},{"Energy":350.93,"Energy Source":"Renewables","Entity":"United States","Year":2000},{"Energy":2678.68,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2001},{"Energy":768.83,"Energy Source":"Nuclear","Entity":"United States","Year":2001},{"Energy":280.06,"Energy Source":"Renewables","Entity":"United States","Year":2001},{"Energy":2727.83,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2002},{"Energy":780.06,"Energy Source":"Nuclear","Entity":"United States","Year":2002},{"Energy":336.34,"Energy Source":"Renewables","Entity":"United States","Year":2002},{"Energy":2756.03,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2003},{"Energy":763.73,"Energy Source":"Nuclear","Entity":"United States","Year":2003},{"Energy":349.18,"Energy Source":"Renewables","Entity":"United States","Year":2003},{"Energy":2818.28,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2004},{"Energy":788.53,"Energy Source":"Nuclear","Entity":"United States","Year":2004},{"Energy":345.14,"Energy Source":"Renewables","Entity":"United States","Year":2004},{"Energy":2899.96,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2005},{"Energy":781.99,"Energy Source":"Nuclear","Entity":"United States","Year":2005},{"Energy":353.04,"Energy Source":"Renewables","Entity":"United States","Year":2005},{"Energy":2878.56,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2006},{"Energy":787.22,"Energy Source":"Nuclear","Entity":"United States","Year":2006},{"Energy":381.16,"Energy Source":"Renewables","Entity":"United States","Year":2006},{"Energy":2988.24,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2007},{"Energy":806.42,"Energy Source":"Nuclear","Entity":"United States","Year":2007},{"Energy":347.91,"Energy Source":"Renewables","Entity":"United States","Year":2007},{"Energy":2924.21,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2008},{"Energy":806.21,"Energy Source":"Nuclear","Entity":"United States","Year":2008},{"Energy":377.11,"Energy Source":"Renewables","Entity":"United States","Year":2008},{"Energy":2725.41,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2009},{"Energy":798.85,"Energy Source":"Nuclear","Entity":"United States","Year":2009},{"Energy":415.56,"Energy Source":"Renewables","Entity":"United States","Year":2009},{"Energy":2882.49,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2010},{"Energy":806.97,"Energy Source":"Nuclear","Entity":"United States","Year":2010},{"Energy":424.48,"Energy Source":"Renewables","Entity":"United States","Year":2010},{"Energy":2788.93,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2011},{"Energy":790.2,"Energy Source":"Nuclear","Entity":"United States","Year":2011},{"Energy":509.74,"Energy Source":"Renewables","Entity":"United States","Year":2011},{"Energy":2779.02,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2012},{"Energy":769.33,"Energy Source":"Nuclear","Entity":"United States","Year":2012},{"Energy":492.32,"Energy Source":"Renewables","Entity":"United States","Year":2012},{"Energy":2746.21,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2013},{"Energy":789.02,"Energy Source":"Nuclear","Entity":"United States","Year":2013},{"Energy":520.38,"Energy Source":"Renewables","Entity":"United States","Year":2013},{"Energy":2752.01,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2014},{"Energy":797.17,"Energy Source":"Nuclear","Entity":"United States","Year":2014},{"Energy":546.83,"Energy Source":"Renewables","Entity":"United States","Year":2014},{"Energy":2730.32,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2015},{"Energy":797.18,"Energy Source":"Nuclear","Entity":"United States","Year":2015},{"Energy":556.49,"Energy Source":"Renewables","Entity":"United States","Year":2015},{"Energy":2656.96,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2016},{"Energy":805.69,"Energy Source":"Nuclear","Entity":"United States","Year":2016},{"Energy":624.91,"Energy Source":"Renewables","Entity":"United States","Year":2016},{"Energy":2540.17,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2017},{"Energy":804.95,"Energy Source":"Nuclear","Entity":"United States","Year":2017},{"Energy":707.19,"Energy Source":"Renewables","Entity":"United States","Year":2017},{"Energy":2661.3,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2018},{"Energy":807.08,"Energy Source":"Nuclear","Entity":"United States","Year":2018},{"Energy":733.17,"Energy Source":"Renewables","Entity":"United States","Year":2018},{"Energy":2588.21,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2019},{"Energy":809.41,"Energy Source":"Nuclear","Entity":"United States","Year":2019},{"Energy":760.76,"Energy Source":"Renewables","Entity":"United States","Year":2019},{"Energy":2431.9,"Energy Source":"Fossil Fuels","Entity":"United States","Year":2020},{"Energy":789.88,"Energy Source":"Nuclear","Entity":"United States","Year":2020},{"Energy":821.4,"Energy Source":"Renewables","Entity":"United States","Year":2020}],"metadata":{"Energy":{"type":"number","semanticType":"Number"},"Energy Source":{"type":"string","semanticType":"String","levels":["Fossil Fuels","Nuclear","Renewables"]},"Entity":{"type":"string","semanticType":"Location"},"Year":{"type":"number","semanticType":"Year"}},"derive":{"code":"\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total CO2 emissions by country across all years\n    total_co2_by_country = df_energy.groupby('Entity')['Value_co2_emissions_kt_by_country'].sum().reset_index()\n    \n    # Get top 3 CO2 emitting countries\n    top3_countries = total_co2_by_country.nlargest(3, 'Value_co2_emissions_kt_by_country')['Entity'].tolist()\n    \n    # Filter data for top 3 countries\n    df_top3 = df_energy[df_energy['Entity'].isin(top3_countries)].copy()\n    \n    # Select relevant columns and rename for clarity\n    df_top3 = df_top3[['Year', 'Entity', 'Electricity from fossil fuels (TWh)', \n                        'Electricity from nuclear (TWh)', 'Electricity from renewables (TWh)']].copy()\n    \n    df_top3.columns = ['Year', 'Entity', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        df_top3,\n        id_vars=['Year', 'Entity'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Entity, Year, and Energy Source\n    transformed_df = transformed_df.sort_values(['Entity', 'Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n","source":["global-energy-20-small.csv"],"dialog":[{"content":"You are a data scientist to help user to transform data that will be used for visualization.\nThe user will provide you information about what data would be needed, and your job is to create a python function based on the input data summary, transformation instruction and expected fields.\nThe users' instruction includes \"chart_type\" and \"chart_encodings\" that describe the visualization they want, and natural language instructions \"goal\" that describe what data is needed.\n\n**Important:**\n- NEVER make assumptions or judgments about a person's gender, biological sex, sexuality, religion, race, nationality, ethnicity, political stance, socioeconomic status, mental health, invisible disabilities, medical conditions, personality type, social impressions, emotional state, and cognitive state.\n- NEVER create formulas that could be used to discriminate based on age. Ageism of any form (explicit and implicit) is strictly prohibited.\n- If above issue occurs, generate columns with np.nan.\n\nConcretely, you should first refine users' goal and then create a python function in the output section based off the [CONTEXT] and [GOAL]:\n\n    1. First, refine users' [GOAL]. The main objective in this step is to check if \"chart_type\" and \"chart_encodings\" provided by the user are sufficient to achieve their \"goal\". Concretely:\n        - based on the user's \"goal\" and \"chart_type\" and \"chart_encodings\", elaborate the goal into a \"detailed_instruction\".\n        - \"display_instruction\" is a short verb phrase describing the users' goal. \n            - it would be a short verbal description of user intent as a verb phrase (<12 words).\n            - generate it based on detailed_instruction and the suggested chart_type and chart_encodings, but don't need to mention the chart details.\n            - should capture key computation ideas: by reading the display, the user can understand the purpose and what's derived from the data.\n            - if the user specification follows up the previous instruction, the 'display_instruction' should only describe how it builds up the previous instruction without repeating information from previous steps.\n            - the phrase can be presented in different styles, e.g., question (what's xxx), instruction (show xxx), description, etc.\n            - if you mention column names from the input or the output data, highlight the text in **bold**.\n                * the column can either be a column in the input data, or a new column that will be computed in the output data.\n                * the mention don't have to be exact match, it can be semantically matching, e.g., if you mentioned \"average score\" in the text while the column to be computed is \"Avg_Score\", you should still highlight \"**average score**\" in the text.\n        - determine \"output_fields\", the desired fields that the output data should have to achieve the user's goal, it's a good idea to include intermediate fields here.\n        - then decide \"chart_encodings\", which maps visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized, \n            - the \"chart_encodings\" should be created to support the user's \"chart_type\".\n            - first, determine whether the user has provided sufficient fields in \"chart_encodings\" that are needed to achieve their goal:\n                - if the user's \"chart_encodings\" are sufficient, simply copy it.\n                - if the user didn't provide sufficient fields in \"chart_encodings\", add missing fields in \"chart_encodings\" (ordered them based on whether the field will be used in x,y axes or legends);\n                    - \"chart_encodings\" should only include fields that will be visualized (do not include other intermediate fields from \"output_fields\")  \n                    - when adding new fields to \"chart_encodings\", be efficient and add only a minimal number of fields that are needed to achive the user's goal. \n                    - generally, the total number of fields in \"chart_encodings\" should be no more than 3 for x,y,legend.\n                - if the user's \"chart_encodings\" is sufficient but can be optimized, you can reorder encodings to visualize the data more effectively.\n            - sometimes, user may provide instruction to update visualizations fields they provided. You should leverage the user's goal to resolve the conflict and decide the final \"chart_encodings\"\n                - e.g., they may mention \"use B metric instead\" while A metric is in provided fields, in this case, you should update \"chart_encodings\" to update A metric with B metric.\n        - guide on statistical analysis:\n            - when the user asks for forecasting or regression analysis, you should consider the following:\n                - the output should be a long format table where actual x, y pairs and predicted x, y pairs are included in the X, Y columns, they are differentiated with a third column \"is_predicted\" that is a boolean field.\n                - i.e., if the user ask for forecasting based on two columns T and Y, the output should be three columns: T, Y, is_predicted, where\n                    - T, Y columns contain BOTH original values from the data and predicted values from the data.\n                    - is_predicted is a boolean field to indicate whether the x, y pairs are original values from the data or predicted / regression values from the data.\n                - the recommended chart should be line chart (time series) or scatter plot (quantitative x, y)\n                - if the user asks for forecasting, it's good to include predicted x, y pairs for both x in the original data and future x values (i.e., combine regression and forecasting results)\n                    - in this case, is_predicted should be of three values 'original', 'regression', 'forecasting'\n        - when the user asks for clustering:\n            - the output should be a long format table where actual x, y pairs with a third column \"cluster_id\" that indicates the cluster id of the data point.\n            - the recommended chart should be scatter plot (quantitative x, y)\n    \n    Prepare the result in the following json format:\n\n```\n{\n    \"detailed_instruction\": \"...\" // string, elaborate user instruction with details if the user\n    \"display_instruction\": \"...\" // string, the short verb phrase describing the users' goal.\n    \"output_fields\": [...] // string[], describe the desired output fields that the output data should have based on the user's goal, it's a good idea to preserve intermediate fields here (i.e., the goal of transformed data)\n    \"chart_encodings\": {\n        \"x\": \"\",\n        \"y\": \"\",\n        \"color\": \"\",\n        \"size\": \"\",\n        \"opacity\": \"\",\n        \"facet\": \"\",\n        ... // other visualization channels user used\n    } // object: map visualization channels (x, y, color, size, opacity, facet, etc.) to a subset of \"output_fields\" that will be visualized.\n    \"reason\": \"...\" // string, explain why this refinement is made\n}\n```\n\n    2. Then, write a python function based on the refined goal, the function input is a dataframe \"df\" (or multiple dataframes based on tables presented in the [CONTEXT] section) and the output is the transformed dataframe \"transformed_df\". \"transformed_df\" should contain all \"output_fields\" from the refined goal.\nThe python function must follow the template provided in [TEMPLATE], do not import any other libraries or modify function name. The function should be as simple as possible and easily readable.\nIf there is no data transformation needed based on \"output_fields\", the transformation function can simply \"return df\".\n\n[TEMPLATE]\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\nfrom sklearn import ... # import necessary libraries from sklearn if needed\n\ndef transform_data(df1, df2, ...): \n    # complete the template here\n    return transformed_df\n```\n\nnote: \n- if the user provided one table, then it should be `def transform_data(df1)`, if the user provided multiple tables, then it should be `def transform_data(df1, df2, ...)` and you should consider the join between tables to derive the output.\n- **VERY IMPORTANT** the number of arguments in the function must match the number of tables provided, and the order of arguments must match the order of tables provided.\n- try to use intuitive table names to refer to the input dataframes, for example, if the user provided two tables city and weather, you can use `transform_data(df_city, df_weather)` to refer to the two dataframes, as long as the number and order of the arguments match the number and order of the tables provided.\n- datetime objects handling:\n    - if the output field is year, convert it to number, if it is year-month / year-month-day, convert it to string object (e.g., \"2020-01\" / \"2020-01-01\").\n    - if the output is time only: convert hour to number if it's just the hour (e.g., 10), but convert hour:min or h:m:s to string object (e.g., \"10:30\", \"10:30:45\")\n    - never return datetime object directly, convert it to either number (if it only contains year) or string so it's readable.\n\n    3. The output must only contain a json object representing the refined goal and a python code block representing the transformation code, do not add any extra text explanation.\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 5736319.824, 5738290.039, nan, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 61.99, 62.21, 63.02, 63.71\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[GOAL]\n\n{\n    \"instruction\": \"compare each countries renewable between 2000 and 2020\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Energy\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Compare renewable energy (Electricity from renewables) for each country between the years 2000 and 2020. Filter the data to include only years 2000 and 2020, and prepare the output with country names, year, and renewable energy values for visualization as a grouped bar chart.\",\n    \"display_instruction\": \"Compare **renewable energy** by **country** between **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Electricity from renewables (TWh)\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to compare renewable energy across countries between 2000 and 2020. The output field 'Renewable Energy' mentioned in the original chart_encodings maps to 'Electricity from renewables (TWh)' in the dataset. To create a grouped bar chart comparing these two years, we need to filter the data to only include years 2000 and 2020, and output the Entity (country), Year, and the renewable energy values. The chart_encodings are updated to use the actual column name from the dataset.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    transformed_df = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Select only the required columns\n    transformed_df = transformed_df[['Entity', 'Year', 'Electricity from renewables (TWh)']]\n    \n    # Convert Year to string for better visualization as a categorical variable\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year for better readability\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n   Electricity from renewables (TWh)     Entity  Year\n0                              17.11  Australia  2000\n1                              63.99  Australia  2020\n2                             308.77     Brazil  2000\n3                             520.01     Brazil  2020\n4                             363.70     Canada  2000\n5                             429.24     Canada  2020\n6                             225.56      China  2000\n7                            2184.94      China  2020\n8                              67.83     France  2000\n9                             125.28     France  2020\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show their renewable percentage instead, and add an entity to show global average\",\n    \"chart_type\": \"Grouped Bar Chart\",\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Electricity from renewables (TWh)\",\n        \"color\": \"Year\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Calculate the renewable energy percentage (proportion of renewables to total electricity generation from all sources) for each country between 2000 and 2020. Add a 'Global Average' entity that represents the worldwide average renewable percentage for each year. The output should include Entity (with 'Global Average' added), Year, and the renewable percentage.\",\n    \"display_instruction\": \"Show **renewable energy percentage** by **country** with **global average** for **2000** and **2020**\",\n    \"output_fields\": [\"Entity\", \"Year\", \"Renewable Percentage\"],\n    \"chart_encodings\": {\n        \"x\": \"Entity\",\n        \"y\": \"Renewable Percentage\",\n        \"color\": \"Year\"\n    },\n    \"reason\": \"The user wants to see renewable percentage instead of absolute values, and wants to add a global average entity for comparison. Renewable percentage is calculated as the ratio of renewable energy to total electricity generation (fossil fuels + nuclear + renewables). A 'Global Average' entity needs to be computed by aggregating all countries' data for each year. The y-axis encoding is updated to reflect the new metric 'Renewable Percentage'.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Filter data for years 2000 and 2020\n    df_filtered = df_energy[df_energy['Year'].isin([2000, 2020])].copy()\n    \n    # Calculate total electricity generation\n    df_filtered['Total Electricity'] = (\n        df_filtered['Electricity from fossil fuels (TWh)'] + \n        df_filtered['Electricity from nuclear (TWh)'] + \n        df_filtered['Electricity from renewables (TWh)']\n    )\n    \n    # Calculate renewable percentage\n    df_filtered['Renewable Percentage'] = (\n        df_filtered['Electricity from renewables (TWh)'] / df_filtered['Total Electricity'] * 100\n    )\n    \n    # Select required columns for individual countries\n    country_data = df_filtered[['Entity', 'Year', 'Renewable Percentage']].copy()\n    \n    # Calculate global average for each year\n    global_avg = df_filtered.groupby('Year').apply(\n        lambda x: pd.Series({\n            'Entity': 'Global Average',\n            'Year': x['Year'].iloc[0],\n            'Renewable Percentage': (\n                x['Electricity from renewables (TWh)'].sum() / x['Total Electricity'].sum() * 100\n            )\n        })\n    ).reset_index(drop=True)\n    \n    # Combine country data with global average\n    transformed_df = pd.concat([country_data, global_avg], ignore_index=True)\n    \n    # Convert Year to string for better visualization\n    transformed_df['Year'] = transformed_df['Year'].astype(str)\n    \n    # Sort by Entity and Year\n    transformed_df = transformed_df.sort_values(['Entity', 'Year']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n      Entity  Renewable Percentage  Year\n0  Australia              8.634437  2000\n1  Australia             25.503168  2020\n2     Brazil             90.130772  2000\n3     Brazil             84.641177  2020\n4     Canada             61.809592  2000\n5     Canada             68.779644  2020\n6      China             16.639127  2000\n7      China             28.246461  2020\n8     France             12.711769  2000\n9     France             23.761024  2020\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show global energy composition over time\",\n    \"chart_type\": \"Custom Area\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"Energy\",\n        \"color\": \"Energy Source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Show the global energy composition over time by aggregating electricity generation from all countries for each year, broken down by energy source (fossil fuels, nuclear, and renewables). The output should be in long format with Year, Energy Source, and Energy values to support a stacked area chart visualization.\",\n    \"display_instruction\": \"Show global **energy composition** by **energy source** over time\",\n    \"output_fields\": [\"Year\", \"Energy Source\", \"Energy\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"Energy\",\n        \"color\": \"Energy Source\"\n    },\n    \"reason\": \"The user wants to visualize global energy composition over time, which requires aggregating electricity generation data across all countries for each year and breaking it down by energy source type. The data needs to be transformed into long format where each row represents a year-energy source combination, with the total energy value for that source globally. This follows up from the previous renewable percentage analysis by showing the overall energy mix trends rather than focusing on specific countries or percentages.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Group by Year and sum electricity generation from all countries\n    global_energy = df_energy.groupby('Year').agg({\n        'Electricity from fossil fuels (TWh)': 'sum',\n        'Electricity from nuclear (TWh)': 'sum',\n        'Electricity from renewables (TWh)': 'sum'\n    }).reset_index()\n    \n    # Rename columns for clarity\n    global_energy.columns = ['Year', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        global_energy,\n        id_vars=['Year'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Year and Energy Source\n    transformed_df = transformed_df.sort_values(['Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"},{"content":"This is the result from the latest python code:\n\n    Energy Energy Source  Year\n0  7160.71  Fossil Fuels  2000\n1  1996.65       Nuclear  2000\n2  1742.56    Renewables  2000\n3  7273.89  Fossil Fuels  2001\n4  2037.54       Nuclear  2001\n5  1690.11    Renewables  2001\n6  7621.07  Fossil Fuels  2002\n7  2042.18       Nuclear  2002\n8  1757.63    Renewables  2002\n9  8043.86  Fossil Fuels  2003\n......\n\nUpdate the code above based on the following instruction:\n\n{\n    \"followup_instruction\": \"show the composition of top 3 CO2 emitting countries\",\n    \"chart_type\": \"Custom Area\",\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"Energy\",\n        \"color\": \"Energy Source\"\n    }\n}","role":"user"},{"content":"```json\n{\n    \"detailed_instruction\": \"Identify the top 3 CO2 emitting countries based on total CO2 emissions across all years, then show the energy composition (fossil fuels, nuclear, and renewables) for each of these countries over time. The output should be in long format with Year, Entity (country), Energy Source, and Energy values to support faceted area charts.\",\n    \"display_instruction\": \"Show **energy composition** of **top 3 CO2 emitting countries** over time\",\n    \"output_fields\": [\"Year\", \"Entity\", \"Energy Source\", \"Energy\"],\n    \"chart_encodings\": {\n        \"x\": \"Year\",\n        \"y\": \"Energy\",\n        \"color\": \"Energy Source\",\n        \"facet\": \"Entity\"\n    },\n    \"reason\": \"The user wants to see the energy composition specifically for the top 3 CO2 emitting countries over time, following up from the global energy composition view. We need to identify which countries have the highest total CO2 emissions, filter the data for those countries, and transform it into long format by energy source. A facet encoding is added to show separate area charts for each of the top 3 countries, allowing comparison of their individual energy compositions over time.\"\n}\n```\n\n```python\nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total CO2 emissions by country across all years\n    total_co2_by_country = df_energy.groupby('Entity')['Value_co2_emissions_kt_by_country'].sum().reset_index()\n    \n    # Get top 3 CO2 emitting countries\n    top3_countries = total_co2_by_country.nlargest(3, 'Value_co2_emissions_kt_by_country')['Entity'].tolist()\n    \n    # Filter data for top 3 countries\n    df_top3 = df_energy[df_energy['Entity'].isin(top3_countries)].copy()\n    \n    # Select relevant columns and rename for clarity\n    df_top3 = df_top3[['Year', 'Entity', 'Electricity from fossil fuels (TWh)', \n                        'Electricity from nuclear (TWh)', 'Electricity from renewables (TWh)']].copy()\n    \n    df_top3.columns = ['Year', 'Entity', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        df_top3,\n        id_vars=['Year', 'Entity'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Entity, Year, and Energy Source\n    transformed_df = transformed_df.sort_values(['Entity', 'Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n```","role":"assistant"}],"trigger":{"tableId":"table-81","sourceTableIds":["global-energy-20-small.csv"],"instruction":"show the composition of top 3 CO2 emitting countries","displayInstruction":"Show **energy composition** of **top 3 CO2 emitting countries** over time","chart":{"id":"chart-1760739075465","chartType":"Custom Area","encodingMap":{"x":{"channel":"x","bin":false,"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"channel":"y","bin":false,"fieldID":"concept-1760738917347"},"x2":{},"y2":{"channel":"y2","bin":false},"color":{"fieldID":"concept-1760738921927","sortBy":"[\"Fossil Fuels\",\"Nuclear\",\"Renewables\"]"},"column":{},"row":{"channel":"row","bin":false}},"tableRef":"table-81","saved":false,"source":"trigger","unread":false},"resultTableId":"table-10"},"explanation":{"agent":"CodeExplanationAgent","code":"The code performs the following high-level transformations:\n\n1. **Identifies top polluters**: Calculates the total `Value_co2_emissions_kt_by_country` across all years for each `Entity` (country), then selects the **top 3** countries with the highest cumulative CO2 emissions.\n\n2. **Filters the dataset**: Retains only records for the **top 3 CO2-emitting countries** from the original energy data.\n\n3. **Simplifies column structure**: Extracts the relevant energy production columns (`Electricity from fossil fuels (TWh)`, `Electricity from nuclear (TWh)`, `Electricity from renewables (TWh)`) and renames them to **Fossil Fuels**, **Nuclear**, and **Renewables** for clarity.\n\n4. **Reshapes data to long format**: Transforms the data from wide format (separate columns for each energy source) to long format, where each row represents a specific `Year`, `Entity`, and `Energy Source` combination with its corresponding `Energy` production value.\n\n5. **Sorts the output**: Orders the final dataset by `Entity`, `Year`, and `Energy Source` for systematic presentation.","concepts":[],"dialog":[{"content":"You are a data scientist to help user explain code, \nso that a non-code can clearly understand what the code is doing, you are provided with a summary of the input data, and the transformation code.\n\nYour goal:\n1. You should generate a good itemized explanation of the code so that the reader can understand high-level steps of what the data transformation is doing.\n    - Be very concise, and stay at a high-level. The reader doesn't understand code and does not want to learn exactly what the code is doing. They just want to learn what have been done from a logical level.\n    - The explanation should be a markdown string that is a list of bullet points (with new lines), highlight constants, data fields, and important verbs.\n2. Generate a list of explanations for new fields (fields not from the input data) that introduce metrics/concepts that are not obvious from the code.\n    - provide a declarative definition that explains the new field, use a mathematical notation if applicable.\n    - only include new fields explanation of new metrics that are involved in computation (e.g., ROI, commerical_success_score)\n    - *DO NOT* explain trivial new fields like \"Decade\" or \"Avg_Rating\", \"US_Sales\" that are self-explanatory.\n        - Avoid explaining fields that are simple aggregate of fields in the original data (min_score, avg_value, count, etc.)\n    - When a field involves mathematical computation, you can use LaTeX math notation in the explanation. Format mathematical expressions using:\n        - Inline math: `\\( ... \\)` for formulas within text\n        - Block math: `\\[ ... \\]` for standalone formulas\n        - Examples: `\\( \\frac{\\text{Revenue}}{\\text{Cost}} \\)` for ratios, `\\[ \\text{Score} = \\text{Rating} \\times \\text{Worldwide\\_Gross} \\]` for formulas\n        - note: when using underscores as part of the text, you need to escape them with a backslash, e.g., `\\_`\n    - Note: don't use math notation for fields whose computation is trivial (use plain english), it will likely be confusing to the reader. \n      Only use math notation for fields that can not be easilyexplained in plain english. Use it sparingly.\n3. If there are multiple fields that have the similar computation, you can explain them together in one explanation.\n    - in \"field\", you can provide a list of fields in format of \"field1, field2, ...\"\n    - in \"explanation\", you can provide a single explanation for the computation of the fields.\n    - for example, if you have fields like \"Norm_Rating\", \"Norm_Gross\", \"Critical_Commercial_Score\", you can explain Norm_Rating, Norm_Gross together in one explanation and explain Critical_Commercial_Score in another explanation.\n4. If the code is about statistical analysis, you should explain the statistical analysis in the explanation as a concept named \"Statistical Analysis\" in the [CONCEPTS EXPLANATION] section.\n    - explain how you model the data, which fields are used, how data processing is done, and what models are used.\n    - suggest some other modeling approaches that can be used to analyze the data in the explanation as well.\n    \nThe focus is to explain how new fields are computed, don't generate explanation for low-level actions like \"return\", \"load data\" etc. \n\nProvide the result in the following two sections:\n    - first section is the code explanation that should be a markdown block explaining the code, in the [CODE EXPLANATION] section.\n        - remember to highlight constants, data fields, and important verbs in the code explanation.\n    - second section is the concepts explanation that should be a json block (start with ```json) in the [CONCEPTS EXPLANATION] section.\n\n[CODE EXPLANATION]\n\n...(explanation of the code)\n\n[CONCEPTS EXPLANATION]\n\n```json\n[\n    {\n        \"field\": \"...\",\n        \"explanation\": \"...\"\n    }\n]\n\n```\n","role":"system"},{"content":"[CONTEXT]\n\nHere are our datasets, here are their summaries and samples:\n\n# table1 (global_energy_20_small_csv)\n\n## fields\n\t*Year -- type: int64, values: 2000, 2001, 2002, ..., 2017, 2018, 2019, 2020\n\t*Entity -- type: object, values: Australia, Brazil, Canada, ..., Thailand, Ukraine, United Kingdom, United States\n\t*Value_co2_emissions_kt_by_country -- type: float64, values: 117440.0, 146139.9994, 158029.9988, ..., 5593029.785, 5736319.824, 5738290.039, 9861099.609\n\t*Electricity from fossil fuels (TWh) -- type: float64, values: 28.87, 31.62, 33.5, ..., 4643.1, 4990.28, 5098.22, 5184.13\n\t*Electricity from nuclear (TWh) -- type: float64, values: 0.0, 3.24, 4.94, ..., 62.21, 63.02, 63.71, 439.73\n\t*Electricity from renewables (TWh) -- type: float64, values: 0.0, 0.01, 0.03, ..., 1667.06, 1835.32, 2014.57, 2184.94\n\n## sample\n   Year     Entity  Value_co2_emissions_kt_by_country  Electricity from fossil fuels (TWh)  Electricity from nuclear (TWh)  Electricity from renewables (TWh)\n0  2000  Australia                        339450.0000                               181.05                               0                              17.11\n1  2001  Australia                        345640.0000                               194.33                               0                              17.40\n2  2002  Australia                        353369.9951                               197.29                               0                              17.35\n3  2003  Australia                        352579.9866                               195.13                               0                              18.50\n4  2004  Australia                        365809.9976                               203.66                               0                              19.41\n......\n\n\n\n\n[CODE]\n\nhere is the transformation code: \nimport pandas as pd\nimport collections\nimport numpy as np\n\ndef transform_data(df_energy):\n    # Calculate total CO2 emissions by country across all years\n    total_co2_by_country = df_energy.groupby('Entity')['Value_co2_emissions_kt_by_country'].sum().reset_index()\n    \n    # Get top 3 CO2 emitting countries\n    top3_countries = total_co2_by_country.nlargest(3, 'Value_co2_emissions_kt_by_country')['Entity'].tolist()\n    \n    # Filter data for top 3 countries\n    df_top3 = df_energy[df_energy['Entity'].isin(top3_countries)].copy()\n    \n    # Select relevant columns and rename for clarity\n    df_top3 = df_top3[['Year', 'Entity', 'Electricity from fossil fuels (TWh)', \n                        'Electricity from nuclear (TWh)', 'Electricity from renewables (TWh)']].copy()\n    \n    df_top3.columns = ['Year', 'Entity', 'Fossil Fuels', 'Nuclear', 'Renewables']\n    \n    # Transform to long format\n    transformed_df = pd.melt(\n        df_top3,\n        id_vars=['Year', 'Entity'],\n        value_vars=['Fossil Fuels', 'Nuclear', 'Renewables'],\n        var_name='Energy Source',\n        value_name='Energy'\n    )\n    \n    # Sort by Entity, Year, and Energy Source\n    transformed_df = transformed_df.sort_values(['Entity', 'Year', 'Energy Source']).reset_index(drop=True)\n    \n    return transformed_df\n\n\n[EXPLANATION]\n","role":"user"},{"content":"[CODE EXPLANATION]\n\nThe code performs the following high-level transformations:\n\n1. **Identifies top polluters**: Calculates the total `Value_co2_emissions_kt_by_country` across all years for each `Entity` (country), then selects the **top 3** countries with the highest cumulative CO2 emissions.\n\n2. **Filters the dataset**: Retains only records for the **top 3 CO2-emitting countries** from the original energy data.\n\n3. **Simplifies column structure**: Extracts the relevant energy production columns (`Electricity from fossil fuels (TWh)`, `Electricity from nuclear (TWh)`, `Electricity from renewables (TWh)`) and renames them to **Fossil Fuels**, **Nuclear**, and **Renewables** for clarity.\n\n4. **Reshapes data to long format**: Transforms the data from wide format (separate columns for each energy source) to long format, where each row represents a specific `Year`, `Entity`, and `Energy Source` combination with its corresponding `Energy` production value.\n\n5. **Sorts the output**: Orders the final dataset by `Entity`, `Year`, and `Energy Source` for systematic presentation.\n\n[CONCEPTS EXPLANATION]\n\n```json\n[]\n```","role":"assistant"}],"status":"ok"}},"anchored":false,"createdBy":"user","attachedMetadata":""}],"charts":[{"id":"chart-1760739084455","chartType":"Custom Area","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"fieldID":"concept-1760738917347"},"x2":{},"y2":{"channel":"y2","bin":false},"color":{"fieldID":"concept-1760738921927"},"column":{"fieldID":"original--global-energy-20-small.csv--Entity"},"row":{"channel":"row","bin":false}},"tableRef":"table-10","saved":false,"source":"user","unread":false},{"id":"chart-1760739021201","chartType":"Custom Area","encodingMap":{"x":{"channel":"x","bin":false,"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"channel":"y","bin":false,"fieldID":"concept-1760738917347"},"x2":{},"y2":{"channel":"y2","bin":false},"color":{"fieldID":"concept-1760738921927","sortBy":"[\"Fossil Fuels\",\"Nuclear\",\"Renewables\"]"},"column":{},"row":{"channel":"row","bin":false}},"tableRef":"table-81","saved":false,"source":"user","unread":false},{"id":"chart-1760738819387","chartType":"Grouped Bar Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Entity"},"y":{"fieldID":"concept-Renewable Percentage-1760738820889"},"color":{"fieldID":"original--global-energy-20-small.csv--Year"},"column":{"channel":"column","bin":false},"row":{"channel":"row","bin":false}},"tableRef":"table-27","saved":false,"source":"user","unread":false},{"id":"chart-1760738770100","chartType":"Grouped Bar Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Entity"},"y":{"fieldID":"original--global-energy-20-small.csv--Electricity from renewables (TWh)"},"color":{"fieldID":"original--global-energy-20-small.csv--Year"},"column":{"channel":"column","bin":false},"row":{"channel":"row","bin":false}},"tableRef":"table-97","saved":false,"source":"user","unread":false},{"id":"chart-1760738436615","chartType":"Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year","sortOrder":"ascending"},"y":{"fieldID":"concept-rank-1760738444550","sortOrder":"descending"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"opacity":{"channel":"opacity","bin":false},"column":{},"row":{"channel":"row","bin":false}},"tableRef":"table-78","saved":false,"source":"user","unread":false},{"id":"chart-1760738423852","chartType":"Dotted Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"fieldID":"concept-renewable_percentage-1760738424337"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"column":{},"row":{"channel":"row","bin":false}},"tableRef":"table-45","saved":false,"source":"user","unread":false},{"id":"chart-1760738400970","chartType":"Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"fieldID":"concept-1760738385163"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"opacity":{"channel":"opacity","bin":false},"column":{"fieldID":"concept-1760738389404","sortBy":"[\"fossil fuels\",\"nuclear\",\"renewables\"]"},"row":{"channel":"row","bin":false}},"tableRef":"table-82","saved":false,"source":"user","unread":false},{"id":"chart-1760738355655","chartType":"Line Chart","encodingMap":{"x":{"fieldID":"original--global-energy-20-small.csv--Year"},"y":{"fieldID":"original--global-energy-20-small.csv--Value_co2_emissions_kt_by_country"},"color":{"fieldID":"original--global-energy-20-small.csv--Entity"},"opacity":{"channel":"opacity","bin":false},"column":{"channel":"column","bin":false},"row":{"channel":"row","bin":false}},"tableRef":"global-energy-20-small.csv","saved":false,"source":"user","unread":false}],"conceptShelfItems":[{"id":"concept-1760738921927","name":"Energy Source","type":"auto","description":"","source":"custom","tableRef":"custom"},{"id":"concept-1760738917347","name":"Energy","type":"auto","description":"","source":"custom","tableRef":"custom"},{"id":"concept-Renewable Percentage-1760738820889","name":"Renewable Percentage","type":"auto","description":"","source":"custom","tableRef":"custom","temporary":true},{"id":"concept-1760738743125","name":"Renewable Energy","type":"auto","description":"","source":"custom","tableRef":"custom"},{"id":"concept-rank-1760738444550","name":"rank","type":"auto","description":"","source":"custom","tableRef":"custom","temporary":true},{"id":"concept-renewable_percentage-1760738424337","name":"renewable_percentage","type":"auto","description":"","source":"custom","tableRef":"custom","temporary":true},{"id":"concept-1760738389404","name":"source","type":"auto","description":"","source":"custom","tableRef":"custom"},{"id":"concept-1760738385163","name":"energy","type":"auto","description":"","source":"custom","tableRef":"custom"},{"id":"original--global-energy-20-small.csv--Year","name":"Year","type":"integer","source":"original","description":"","tableRef":"global-energy-20-small.csv"},{"id":"original--global-energy-20-small.csv--Entity","name":"Entity","type":"string","source":"original","description":"","tableRef":"global-energy-20-small.csv"},{"id":"original--global-energy-20-small.csv--Value_co2_emissions_kt_by_country","name":"Value_co2_emissions_kt_by_country","type":"number","source":"original","description":"","tableRef":"global-energy-20-small.csv"},{"id":"original--global-energy-20-small.csv--Electricity from fossil fuels (TWh)","name":"Electricity from fossil fuels (TWh)","type":"number","source":"original","description":"","tableRef":"global-energy-20-small.csv"},{"id":"original--global-energy-20-small.csv--Electricity from nuclear (TWh)","name":"Electricity from nuclear (TWh)","type":"number","source":"original","description":"","tableRef":"global-energy-20-small.csv"},{"id":"original--global-energy-20-small.csv--Electricity from renewables (TWh)","name":"Electricity from renewables (TWh)","type":"number","source":"original","description":"","tableRef":"global-energy-20-small.csv"}],"messages":[{"timestamp":1760831081885,"type":"success","component":"data formulator","value":"Successfully loaded Global Energy"}],"displayedMessageIdx":0,"focusedTableId":"global-energy-20-small.csv","focusedChartId":"chart-1760738355655","viewMode":"report","chartSynthesisInProgress":[],"config":{"formulateTimeoutSeconds":60,"maxRepairAttempts":1,"defaultChartWidth":300,"defaultChartHeight":300},"agentActions":[],"dataCleanBlocks":[],"cleanInProgress":false,"generatedReports":[{"id":"report-1760831156182-8277","content":"# Global Renewable Energy Shift: 2000 to 2020\n\nBetween 2000 and 2020, the world witnessed a notable transformation in renewable energy adoption. Global renewable electricity nearly doubled from 16% to 29% of total generation, signaling meaningful progress in the energy transition.\n\n[IMAGE(chart-1760738819387)]\n\nThe data reveals striking regional variations. Brazil maintained renewable leadership above 84%, while countries like Australia, Germany, and Italy dramatically expanded their renewable capacityAustralia tripling from 9% to 26%. However, some nations like Mexico experienced declining renewable shares, highlighting uneven progress across different energy systems.\n\n**In summary**, while the 20-year period shows encouraging momentum toward cleaner energy, the pace and direction vary significantly by country, suggesting that achieving global renewable energy goals will require sustained, coordinated efforts tailored to each nation's unique energy landscape and policy environment.","style":"short note","selectedChartIds":["chart-1760738819387"],"createdAt":1760831163718},{"id":"report-1760831130105-4063","content":"# The Global Renewable Energy Revolution: Two Decades of Transformation\n\nThe world's energy landscape has undergone a remarkable transformation between 2000 and 2020, with renewable electricity generation emerging as a critical component of the global energy mix. This shift reflects both technological advancement and growing commitment to sustainable energy solutions.\n\n[IMAGE(chart-1760738770100)]\n\nLooking at renewable energy adoption across major economies, the growth has been nothing short of extraordinary. China leads the pack with a staggering increase from 225.56 TWh in 2000 to 2,184.94 TWh in 2020nearly a tenfold expansion. The United States more than doubled its renewable output from 335.45 TWh to 821.40 TWh, while Brazil grew from 308.77 TWh to 520.01 TWh. Notably, countries like Australia, India, and Germany also demonstrated significant gains, with Australia jumping from just 17.11 TWh to 63.99 TWh during this period.\n\n[IMAGE(chart-1760739084455)]\n\nWhen examining the energy portfolios of the three largest CO2 emittersChina, India, and the United Statesa complex picture emerges. While China's total energy consumption has grown exponentially, with fossil fuels still dominating, the renewable sector (shown in red) has expanded substantially. The United States shows a more stable total energy consumption, with renewables gradually claiming a larger share. India's energy growth, though significant, remains heavily reliant on fossil fuels, though renewable adoption is accelerating.\n\n**In summary**, the past two decades reveal a global energy transition in progress. While renewable energy has achieved impressive growth worldwide, fossil fuels continue to dominate electricity generation in major economies. Key questions remain: Can this momentum accelerate sufficiently to meet climate goals? What policies will drive faster renewable adoption in emerging economies?","style":"blog post","selectedChartIds":["chart-1760739084455","chart-1760738770100"],"createdAt":1760831142289},{"id":"report-1760831094231-2424","content":"# Global Renewable Energy: A Tale of Leaders and Laggards\n\nThe global energy landscape has undergone significant transformation over the past two decades, with renewable energy emerging as a critical player in the electricity mix. Analyzing data from 21 major economies between 2000 and 2020 reveals striking disparities in how nations have embraced clean energy alternatives.\n\n[IMAGE(chart-1760738423852)]\n\nThe first visualization reveals a fascinating divergence in renewable energy adoption. **Brazil** stands out as a consistent leader, maintaining renewable electricity percentages between 75-90% throughout the entire period, thanks largely to its robust hydroelectric infrastructure. **Canada** follows a similar trajectory, steadily increasing from about 60% to nearly 70% by 2020. Meanwhile, **Germany, Spain, Italy, and the United Kingdom** show remarkable growth trajectories, climbing from under 20% in the early 2000s to over 40% by 2020demonstrating that nations can dramatically reshape their energy portfolios within two decades.\n\nOn the opposite end of the spectrum, **South Africa** remains nearly flat at the bottom, showing minimal renewable adoption despite global trends. **Saudi Arabia** and **Poland** also lag significantly, though both show modest upticks in recent years.\n\n[IMAGE(chart-1760738436615)]\n\nThe ranking chart illustrates the competitive dynamics of renewable energy leadership. **Brazil and Canada** maintain their dominance at ranks 1-2 throughout most years, while European nations like **Germany, Spain, and the UK** engage in a dynamic competition for the 3rd-5th positions, particularly after 2010. The volatility in middle rankings reflects the rapid changes in energy policy and investment across different nations, with countries like **China** climbing from lower ranks to break into the top 7 by 2020.\n\n**In summary**, the data reveals a bifurcated global energy transition: a group of progressive nations have successfully scaled renewable electricity to 40-90% of their mix, while others remain heavily dependent on fossil fuels. These patterns suggest that political will, natural resource endowment, and infrastructure investment are key determinants of renewable energy success. Important follow-up questions include: What policy mechanisms enabled top performers to achieve such high renewable percentages? Can lagging nations replicate these successes, or do geographic and economic constraints create insurmountable barriers?","style":"blog post","selectedChartIds":["chart-1760738423852","chart-1760738436615"],"createdAt":1760831110064}],"currentReport":{"id":"report-1760750575650-2619","content":"# Hollywood's Billion-Dollar Hitmakers\n\n*Avatar* stands aloneearning over $2.5B in profit, dwarfing all competition. Action and Adventure films dominate the most profitable titles, with franchises like *Jurassic Park*, *The Dark Knight*, and *Lord of the Rings* proving blockbuster formulas work.\n\n<img src=\"blob:http://localhost:5173/de49db0f-5fad-4c15-b1b9-cda87ef53107\" alt=\"Chart\" width=\"3384\" height=\"1728\" />\n\nSteven Spielberg leads all directors with $7.2B in total profit across his career, showcasing remarkable consistency with hits spanning decadesfrom *Jurassic Park* to *E.T.* His nearest competitors trail by billions, underlining his unmatched commercial impact.\n\n<img src=\"blob:http://localhost:5173/d7a91ff7-1d87-4299-bcd7-f9b69558cac7\" alt=\"Chart\" width=\"2764\" height=\"1712\" />\n\n**In summary**, mega-budget Action and Adventure films generate extraordinary returns when they succeed, and a handful of elite directorsled by Spielberghave mastered the formula for sustained box office dominance.","style":"short note","selectedChartIds":["chart-1760743347871","chart-1760743768741"],"chartImages":{},"createdAt":1760750584189,"title":"Report - 10/17/2025"},"activeChallenges":[],"agentWorkInProgress":[],"_persist":{"version":-1,"rehydrated":true}}